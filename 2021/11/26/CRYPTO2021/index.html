<!DOCTYPE html>
<html>
<head>
  <meta name="msvalidate.01" content="061FF5EC44CE36C1CF8EF9C59F0C9154" />
  <meta name="google-site-verification" content="kY4wnQzv8o_ooESNgmQrq_NJF2LX4_vTCTCE5Bb0UfE" />
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="code-Zq7yjVRo5A" />
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="https://tl2cents.github.io">
  <title>CRYPTO2021 | tl2cents blog</title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="description" content="最近打的CTF比赛有一点多，需要好好复盘，记录一下crypto方面的题解。这篇博客简要复盘一下2021 ByteCTF初赛，2021 KQCTF，2021 L3HCTF，2021 陇原杯， 2021 西湖论剑以及2021 N1CTF密码学方向的题解。原题存档于github仓库。">
<meta property="og:type" content="article">
<meta property="og:title" content="CRYPTO2021">
<meta property="og:url" content="https://tl2cents.github.io/2021/11/26/CRYPTO2021/index.html">
<meta property="og:site_name" content="tl2cents blog">
<meta property="og:description" content="最近打的CTF比赛有一点多，需要好好复盘，记录一下crypto方面的题解。这篇博客简要复盘一下2021 ByteCTF初赛，2021 KQCTF，2021 L3HCTF，2021 陇原杯， 2021 西湖论剑以及2021 N1CTF密码学方向的题解。原题存档于github仓库。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tl2cents.github.io/2021/11/26/CRYPTO2021/image-20211122164619577.png">
<meta property="og:image" content="https://tl2cents.github.io/2021/11/26/CRYPTO2021/image-20211123130504880.png">
<meta property="og:image" content="https://tl2cents.github.io/2021/11/26/CRYPTO2021/image-20211123135300930.png">
<meta property="og:image" content="https://tl2cents.github.io/2021/11/26/CRYPTO2021/image-20211123135427602.png">
<meta property="og:image" content="https://tl2cents.github.io/2021/11/26/CRYPTO2021/image-20211123135523311.png">
<meta property="article:published_time" content="2021-11-26T04:10:04.000Z">
<meta property="article:modified_time" content="2022-03-23T02:17:40.000Z">
<meta property="article:author" content="tl2cents">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tl2cents.github.io/2021/11/26/CRYPTO2021/image-20211122164619577.png">
  
    <link rel="alternative" href="/atom.xml" title="tl2cents blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/1.jpg">
  
  
    <link rel="apple-touch-icon" href="/apple-touch-icon-180x180.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.a5fda8.css">
  <style type="text/css">
    
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

  
  

<script>
  (function () {
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    } else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();

</script>



  
    <script src="/lib/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">
  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      


<!-- 恢复gif图片请恢复下面的语句 -->
<div class="overlay" style="background: rgba(255, 255, 255, 0.0);"></div>
<!-- 左侧边栏（上半部分）不设置背景颜色 -->
<!-- <div class="overlay"  style="background: rgba(255, 255, 255, 0.0);> -->
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/head.png" class="js-avatar">
		</a>
		<hgroup>
			<h1 class="header-author"><a href="/">tl2cents</a></h1>
		</hgroup>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/" >Home</a></li>
			
				<li><a href="/archives" >Archives</a></li>
			
				<li><a href="/categories" >Categories</a></li>
			
			</ul>
		</nav>
		<nav class="header-smart-menu">
			
				
					<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">Toc</a>
				
			
				
					<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">Friends</a>
				
			
				
					<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">About me</a>
				
			
		</nav>

		<!-- add text here -->
		
			
				
					<!--  colorful text here -->
					<div class="text">
						
							<p style="font-size: 15px; color: #69e;">Blockchain and AI are destined to revolutionize the future.<p></p>
						
					</div>
				
			
		
		
		<nav class="header-nav">
			<div class="social">
				
					
						<a class="github" target="_blank" rel="noopener" href="https://github.com/tl2cents" 
												title="GitHub" ><i class="icon-github"></i></a>
					
				
					
						<a class="zhihu" target="_blank" rel="noopener" href="https://www.zhihu.com/people/tl2cents" 
												title="知乎" ><i class="icon-zhihu"></i></a>
					
				
					
						<a class="twitter" target="_blank" rel="noopener" href="https://twitter.com/tl2cent" 
												title="Twitter" ><i class="icon-twitter"></i></a>
					
				
			</div>
		
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse" style="background: /img/img-dc48606e38d660aab836ad1cd12438d9.jpg no-repeat 100%;background-size:cover;opacity:0.5;filter:alpha(opacity=70);">
      
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: rgba(255, 255, 255, 0.0)"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<a href="/">
					<img src="/img/head.png" class="js-avatar">
				</a>
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">tl2cents</h1>
			</hgroup>
			
			
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						
						<a class="github" target="_blank" 
							href="https://github.com/tl2cents" title="GitHub"><i class="icon-github"></i></a>
						
					
						
						<a class="zhihu" target="_blank" 
							href="https://www.zhihu.com/people/tl2cents" title="知乎"><i class="icon-zhihu"></i></a>
						
					
						
						<a class="twitter" target="_blank" 
							href="https://twitter.com/tl2cent" title="Twitter"><i class="icon-twitter"></i></a>
						
					
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 33.333333333333336%"><a href="/">Home</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/archives">Archives</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/categories">Categories</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1"
              class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="bllog-CRYPTO2021" class="article article-type-bllog " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
  
  
    <h1 class="article-title" itemprop="name">
      CRYPTO2021
    </h1>
  


  
  
        
        <span id="busuanzi_container_page_pv" style='display:none' class="archive-article-date">
              <i class="icon-smile icon"></i> Read: <span id="busuanzi_value_page_pv"></span> times
        </span>

<a href="/2021/11/26/CRYPTO2021/" class="archive-article-date">
        <time datetime="2021-11-26T04:10:04.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2021-11-26</time>
</a>

  
  
    
<div style="margin-top:10px;">
  <span class="post-time">
    <span class="post-meta-item-icon">
      <!-- fonts.scss -->
      <!-- 百度字体平台:http://fontstore.baidu.com/static/editor/index.html -->
      <i class="icon-statistics"></i>
      <span class="post-meta-item-text"> 字数统计:</span>
      <span class="post-count">13k字</span>
    </span>
  </span>

  <span class="post-time">
    &nbsp; | &nbsp;
    <span class="post-meta-item-icon">
      <i class="icon-book icon"></i>
      <span class="post-meta-item-text"> 阅读时长≈</span>
      <span class="post-count">68分</span>
    </span>
  </span>
</div>


  
  </header>
  
  <div class="article-entry" itemprop="articleBody">
    <!-- newly added -->
    
    <!-- newly added -->
    
    <p>最近打的CTF比赛有一点多，需要好好复盘，记录一下crypto方面的题解。这篇博客简要复盘一下2021 ByteCTF初赛，2021 KQCTF，2021 L3HCTF，2021 陇原杯， 2021 西湖论剑以及2021 N1CTF密码学方向的题解。原题存档于<a target="_blank" rel="noopener" href="https://github.com/tl2cents/CTF-Archive">github仓库</a>。</p>
<span id="more"></span>
<p>&nbsp;</p>
<h2 id="2021-Byte-CTF-crypto题解"><a href="#2021-Byte-CTF-crypto题解" class="headerlink" title="2021 Byte CTF crypto题解"></a>2021 Byte CTF crypto题解</h2><p>字节的比赛赛题质量还是很高的。<a target="_blank" rel="noopener" href="https://bytectf.feishu.cn/docs/doccnq7Z5hqRBMvrmpRQMAGEK4e#5hniNr">官方writeup</a>。</p>
<p>&nbsp;</p>
<h3 id="JustDecrypt"><a href="#JustDecrypt" class="headerlink" title="JustDecrypt"></a>JustDecrypt</h3><p>第一次接触到CFB模式的一个oracle，一般来说CFB和移位寄存器的长度有关。详情可以参考wiki：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F">分组加密的模式</a>或者<a target="_blank" rel="noopener" href="https://jayxv.github.io/2020/03/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%BC%8F/">这篇博客</a>。</p>
<p><img src="image-20211122164619577.png" alt="image-20211122164619577"></p>
<p>本质上就是反复加密前一次的密文，生成用来异或的比特流，选取s位作为密钥流加密明文。那么b和s就是CFB最重要的两个参数。</p>
<p>这题中使用了python的Crypto库默认的CFB模式，所以我直接去找了Crypto库的C语言源码，确定了python中的CFB模式的加密移位寄存器的参数b和s是16和1byte，相当于字节流密钥。这意味着它的加密模式是这样的：（这是我用python经过ecb和cfb模式加密简单试出来的）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">iv=<span class="string">b&quot;0&quot;</span>*<span class="number">16</span> </span><br><span class="line">plaintext=<span class="string">b&quot;0&quot;</span>*<span class="number">16</span>+<span class="string">b&quot;1&quot;</span></span><br><span class="line">xor_key =aes.encrypt(iv)</span><br><span class="line"><span class="comment"># 第一个字节异或的比特流是：xor_key[0]</span></span><br><span class="line">iv=iv[<span class="number">1</span>:]+ xor_key[<span class="number">0</span>]^plaintext[<span class="number">0</span>]</span><br><span class="line">xor_key =aes.encrypt(iv)</span><br><span class="line"><span class="comment"># 第一个字节异或的比特流是：xor_key[0]</span></span><br><span class="line"><span class="comment"># 后面类推</span></span><br></pre></td></tr></table></figure>
<p>每进行一个byte加密之后iv都会更新。所以这个oracle每进行一次解密的返回，我们只可以设置对应位置1byte的值。</p>
<p>利用如下：</p>
<p>我们先把寄存器里面的iv设置为已知的，直接通过填充16个字节“0”即可，为了防止padding解出来出错，所以将padding设置到320个byte，这样可以正确回显。</p>
<p>那么padding_res[-1]^ord(‘0’)结果就是iv加密后的密钥流，再异或一个b”H”就能使得我们解密出来的该位置的byte为“H”，其实更简便的一种方法是我们将padding改为“H”*320，直接将得到明文返回，第一个字节就会变成”H“。下面是第设置第一个字节的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">target_msg=<span class="string">b&quot;Hello, I&#x27;m a Bytedancer. Please give me the flag!&quot;</span>+<span class="string">b&#x27;0&#x27;</span>*<span class="number">15</span></span><br><span class="line">padding=<span class="string">b&#x27;0&#x27;</span>*<span class="number">320</span></span><br><span class="line">padding_res=one_exchange(io,padding)</span><br><span class="line">print(padding_res)</span><br><span class="line">payload=<span class="built_in">bytes</span>([padding_res[-<span class="number">1</span>]^<span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;H&#x27;</span>)])+target_msg[<span class="number">1</span>:]+padding</span><br></pre></td></tr></table></figure>
<p>我在本地测试CFB模式的代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"></span><br><span class="line">BLOCK_SIZE=<span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AES_CFB</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.key = <span class="string">b&quot;qwertyuiop123456&quot;</span></span><br><span class="line">        self.iv = <span class="string">b&#x27;0&#x27;</span>*<span class="number">16</span></span><br><span class="line">        self.aes_encrypt = AES.new(self.key, AES.MODE_CFB, self.iv)</span><br><span class="line">        self.aes_decrypt = AES.new(self.key, AES.MODE_CFB, self.iv)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, plain</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.aes_encrypt.encrypt(self.pad(plain))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, cipher</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.aes_decrypt.decrypt(cipher)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">s</span>):</span></span><br><span class="line">        num = BLOCK_SIZE - (<span class="built_in">len</span>(s) % BLOCK_SIZE)</span><br><span class="line">        <span class="keyword">return</span> s + <span class="built_in">bytes</span>([num] * num)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unpad</span>(<span class="params">s</span>):</span></span><br><span class="line">        <span class="keyword">return</span> s[:-s[-<span class="number">1</span>]]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">s</span>):</span></span><br><span class="line">    num = BLOCK_SIZE - (<span class="built_in">len</span>(s) % BLOCK_SIZE)</span><br><span class="line">    <span class="keyword">return</span> s + <span class="built_in">bytes</span>([num] * num)  </span><br><span class="line">key = <span class="string">b&quot;qwertyuiop123456&quot;</span></span><br><span class="line">iv = <span class="string">b&#x27;0&#x27;</span>*<span class="number">16</span></span><br><span class="line">aes_ecb=AES.new(key,AES.MODE_ECB)</span><br><span class="line">aes_cfb=AES_CFB()</span><br><span class="line"></span><br><span class="line">target_msg=<span class="string">b&quot;Hello, I&#x27;m a Bytedancer. Please give me the flag!&quot;</span></span><br><span class="line">print(aes_cfb.decrypt(<span class="string">b&#x27;0&#x27;</span>*<span class="number">16</span>+target_msg))</span><br><span class="line">paddings=<span class="built_in">bytearray</span>(<span class="string">b&#x27;0&#x27;</span>*<span class="number">16</span>+target_msg+<span class="string">b&#x27;0&#x27;</span>*<span class="number">16</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target_msg)):</span><br><span class="line">    res=aes_cfb.decrypt(paddings)</span><br><span class="line">    print(res)</span><br><span class="line">    paddings[<span class="number">16</span>+i]=res[<span class="number">16</span>+i]</span><br></pre></td></tr></table></figure>
<p>实际交互我们还有考虑最后的unpadding的时候正确，最终的exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_connect_proof</span>():</span></span><br><span class="line">    io=remote(<span class="string">&#x27;39.105.115.244&#x27;</span>, <span class="number">30001</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;sha256(XXXX+&#x27;</span>)</span><br><span class="line">    alphabet = string.ascii_letters + string.digits</span><br><span class="line">    lattar_part=io.recv(<span class="number">32</span>-<span class="number">4</span>).decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;== &#x27;</span>)</span><br><span class="line">    h=io.recvline().strip().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    <span class="comment"># print(h)</span></span><br><span class="line">    bruteforce=[<span class="string">&#x27;&#x27;</span>.join(prefix) + lattar_part <span class="keyword">for</span> prefix <span class="keyword">in</span> product(alphabet,repeat=<span class="number">4</span>)]</span><br><span class="line">    <span class="keyword">for</span> proof <span class="keyword">in</span> bruteforce:</span><br><span class="line">        <span class="keyword">if</span> sha256(proof.encode()).hexdigest()==h:</span><br><span class="line">            io.sendline(proof[:<span class="number">4</span>].encode())</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    print(<span class="string">&quot;proof done&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> io</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_exchange</span>(<span class="params">io,msg</span>):</span></span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;cipher in hex &gt; &#x27;</span>)</span><br><span class="line">    print(<span class="string">&quot;send&quot;</span>,<span class="built_in">bytes</span>(msg.<span class="built_in">hex</span>(),encoding=<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line">    io.sendline(<span class="built_in">bytes</span>(msg.<span class="built_in">hex</span>(),encoding=<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;Your plaintext in hex:&#x27;</span>)</span><br><span class="line">    io.recvline()</span><br><span class="line">    plaintext=io.recvline().decode(<span class="string">&#x27;utf8&#x27;</span>).strip()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(plaintext)</span><br><span class="line">    </span><br><span class="line">io=set_connect_proof()</span><br><span class="line"></span><br><span class="line">target_msg=<span class="string">b&quot;Hello, I&#x27;m a Bytedancer. Please give me the flag!&quot;</span>+<span class="string">b&#x27;0&#x27;</span>*<span class="number">15</span></span><br><span class="line">padding=<span class="string">b&#x27;0&#x27;</span>*<span class="number">320</span></span><br><span class="line">padding_res=one_exchange(io,padding)</span><br><span class="line">print(padding_res)</span><br><span class="line">payload=<span class="built_in">bytes</span>([padding_res[-<span class="number">1</span>]^<span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;H&#x27;</span>)])+target_msg[<span class="number">1</span>:]+padding</span><br><span class="line">payload=<span class="built_in">bytearray</span>(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target_msg)-<span class="number">15</span>):</span><br><span class="line">    res=one_exchange(io,payload)</span><br><span class="line">    print(res)</span><br><span class="line">    <span class="keyword">if</span>(i!=<span class="built_in">len</span>(target_msg)-<span class="number">16</span>):</span><br><span class="line">        payload[i+<span class="number">1</span>]=res[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># correct padding</span></span><br><span class="line"><span class="comment"># last=b&#x27;g!&#x27;+b&#x27;0&#x27;*14</span></span><br><span class="line">payload[<span class="number">63</span>]=res[<span class="number">63</span>]^<span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)^<span class="number">15</span></span><br><span class="line">res=one_exchange(io,payload[:<span class="number">64</span>])</span><br><span class="line">print(res)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="easyxor"><a href="#easyxor" class="headerlink" title="easyxor"></a>easyxor</h3><p>经典的移位异或加掩码，这种加密我最先接触是在MT19937伪随机数生成器里面，我们每次可以恢复出固定的比特，<a target="_blank" rel="noopener" href="https://badmonkey.site/archives/mt19937.html">这里</a>有讲具体怎么逆。</p>
<p>我们观察到key的空间很小，只有2^20，我们可以直接通过爆破得到key，但是我们不知道明文和IV怎么确定哪个是正确的key呢？注意到CBC模式，每次异或的密钥流就是前面一个分组的密文，而且我们已知最后一个分组的padding的模式和flag以}结尾。这样我们就可以用这个特征进行爆破了。</p>
<p>另外一个IV的获取方式是通过已知明文攻击，在获取key之后，再通过提示flag以ByteCTF{开头，我们就可以得到iv，之后就只剩下解密了：</p>
<p>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, getrandbits</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">cipher=<span class="string">&#x27;89b8aca257ee2748f030e7f6599cbe0cbb5db25db6d3990d3b752eda9689e30fa2b03ee748e0da3c989da2bba657b912&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inverse_left_values</span>(<span class="params">res,shift,mask,bits=<span class="number">64</span></span>):</span></span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits//shift):</span><br><span class="line">        tmp = res ^ tmp &lt;&lt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># right shift with mask inverse</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inverse_right_values</span>(<span class="params">res,shift,mask,bits=<span class="number">64</span></span>):</span></span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits//shift):</span><br><span class="line">        tmp = res ^ tmp&gt;&gt;shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert</span>(<span class="params">m, key</span>):</span></span><br><span class="line">    c_list = [<span class="number">0x37386180af9ae39e</span>, <span class="number">0xaf754e29895ee11a</span>, <span class="number">0x85e1a429a2b7030c</span>, <span class="number">0x964c5a89f6d3ae8c</span>]</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        m = shift(m, key[t], c_list[t])</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shift</span>(<span class="params">m, k, c</span>):</span></span><br><span class="line">    <span class="keyword">if</span> k &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> m ^ m &gt;&gt; (-k) &amp; c</span><br><span class="line">    <span class="keyword">return</span> m ^ m &lt;&lt; k &amp; c</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_shift</span>(<span class="params">m,k,c</span>):</span></span><br><span class="line">    <span class="keyword">if</span> k&lt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> inverse_right_values(m,-k,c)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> inverse_left_values(m,k,c)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_convert</span>(<span class="params">c,key</span>):</span></span><br><span class="line">    c_list = [<span class="number">0x37386180af9ae39e</span>, <span class="number">0xaf754e29895ee11a</span>, <span class="number">0x85e1a429a2b7030c</span>, <span class="number">0x964c5a89f6d3ae8c</span>]</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        c = reverse_shift(c, key[<span class="number">3</span>-t], c_list[<span class="number">3</span>-t])</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">cipher1=cipher[:<span class="built_in">len</span>(cipher)//<span class="number">2</span>]</span><br><span class="line">cipher2=cipher[<span class="built_in">len</span>(cipher)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">k = [randint(-<span class="number">32</span>, <span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">iv = getrandbits(<span class="number">64</span>)</span><br><span class="line">mask=getrandbits(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">m, k, iv, mode=<span class="string">&#x27;CBC&#x27;</span></span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(m) % <span class="number">8</span> == <span class="number">0</span></span><br><span class="line">    num = <span class="built_in">len</span>(m) // <span class="number">8</span></span><br><span class="line">    groups = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        groups.append(bytes_to_long(m[i * <span class="number">8</span>: (i + <span class="number">1</span>) * <span class="number">8</span>]))</span><br><span class="line">    last = iv</span><br><span class="line">    cipher = []</span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">&#x27;CBC&#x27;</span>:</span><br><span class="line">        <span class="keyword">for</span> eve <span class="keyword">in</span> groups:</span><br><span class="line">            cur = eve ^ last</span><br><span class="line">            cur_c = convert(cur, k)</span><br><span class="line">            cipher.append(cur_c)</span><br><span class="line">            last = cur_c</span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">&#x27;OFB&#x27;</span>:</span><br><span class="line">        <span class="keyword">for</span> eve <span class="keyword">in</span> groups:</span><br><span class="line">            cur_c = convert(last, k)</span><br><span class="line">            cipher.append(cur_c ^ eve)</span><br><span class="line">            last = cur_c</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;Not supported now!&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(eve)[<span class="number">2</span>:].strip(<span class="string">&#x27;L&#x27;</span>).rjust(<span class="number">16</span>, <span class="string">&#x27;0&#x27;</span>) <span class="keyword">for</span> eve <span class="keyword">in</span> cipher])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_CBC_block</span>(<span class="params">key,iv,cipher</span>):</span></span><br><span class="line">    num = <span class="built_in">len</span>(cipher) // <span class="number">16</span></span><br><span class="line">    groups = []</span><br><span class="line">    msg=[<span class="number">0</span>]*num</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        groups.append(<span class="built_in">int</span>(cipher[<span class="number">16</span>*i:<span class="number">16</span>*(i+<span class="number">1</span>)],<span class="number">16</span>))</span><br><span class="line">    print(groups)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        cur_c=reverse_convert(groups[i],key)</span><br><span class="line">        <span class="keyword">if</span> i !=<span class="number">0</span>:</span><br><span class="line">            cur_c=cur_c^groups[i-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cur_c=cur_c^iv</span><br><span class="line">        msg[i]=cur_c</span><br><span class="line">    res=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> msg:</span><br><span class="line">        res+=long_to_bytes(i,<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_OFB_block</span>(<span class="params">key,iv,cipher</span>):</span></span><br><span class="line">    num = <span class="built_in">len</span>(cipher) // <span class="number">16</span></span><br><span class="line">    groups = []</span><br><span class="line">    msg=[<span class="number">0</span>]*num</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        groups.append(<span class="built_in">int</span>(cipher[<span class="number">16</span>*i:<span class="number">16</span>*(i+<span class="number">1</span>)],<span class="number">16</span>))</span><br><span class="line">    print(groups)</span><br><span class="line">    last= iv</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        cur_c = convert(last, key)</span><br><span class="line">        msg[i]=cur_c ^groups[i]</span><br><span class="line">        last = cur_c</span><br><span class="line">    res=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> msg:</span><br><span class="line">        res+=long_to_bytes(i,<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brute_forcekey</span>(<span class="params">cipher_of_CBC</span>):</span></span><br><span class="line">    brute_list=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">32</span>,<span class="number">33</span>):</span><br><span class="line">        <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">32</span>,<span class="number">33</span>):</span><br><span class="line">            <span class="keyword">if</span> j == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">32</span>,<span class="number">33</span>):</span><br><span class="line">                <span class="keyword">if</span> k==<span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">32</span>,<span class="number">33</span>):</span><br><span class="line">                    <span class="keyword">if</span> l==<span class="number">0</span>:</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    brute_list.append([i,j,k,l])</span><br><span class="line">    pre_last=<span class="built_in">int</span>(cipher_of_CBC[-<span class="number">32</span>:-<span class="number">16</span>],<span class="number">16</span>)</span><br><span class="line">    last=<span class="built_in">int</span>(cipher_of_CBC[-<span class="number">16</span>:],<span class="number">16</span>)</span><br><span class="line">    keys=[]</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> tqdm(brute_list):</span><br><span class="line">        <span class="comment"># print(key)</span></span><br><span class="line">        cur_c=reverse_convert(last,key)</span><br><span class="line">        cur_c=cur_c^pre_last</span><br><span class="line">        m=long_to_bytes(cur_c)</span><br><span class="line">        <span class="comment"># print(type(m[0]))</span></span><br><span class="line">        <span class="keyword">if</span>  (m[-<span class="number">1</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>) <span class="keyword">or</span> m[-<span class="number">1</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;$&#x27;</span>)) <span class="keyword">and</span> <span class="built_in">all</span>(i&gt;=<span class="number">32</span> <span class="keyword">and</span> i&lt;=<span class="number">126</span> <span class="keyword">for</span> i <span class="keyword">in</span> m):</span><br><span class="line">            print(<span class="string">&quot;FIND&quot;</span>)</span><br><span class="line">            print(<span class="string">&quot;msg is &quot;</span>, m)</span><br><span class="line">            print(<span class="string">&quot;key is &quot;</span>, key)</span><br><span class="line">            keys.append((m,key))</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keys:</span><br><span class="line">        m=key[<span class="number">0</span>]</span><br><span class="line">        i=<span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> m[-i]==m[-i-<span class="number">1</span>]:</span><br><span class="line">            i=i+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> m[-i-<span class="number">1</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>):</span><br><span class="line">            print(key)</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_iv</span>(<span class="params">key</span>):</span></span><br><span class="line">    begin=bytes_to_long(<span class="string">b&#x27;ByteCTF&#123;&#x27;</span>)</span><br><span class="line">    c=<span class="built_in">int</span>(cipher1[:<span class="number">16</span>],<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> reverse_convert(c^begin,key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># brute_forcekey(cipher2)</span></span><br><span class="line">msg=<span class="string">b&#x27;5u2t&#125;$$$&#x27;</span></span><br><span class="line">key=[-<span class="number">12</span>, <span class="number">26</span>, -<span class="number">3</span>, -<span class="number">31</span>]</span><br><span class="line">iv= get_iv(key)</span><br><span class="line">flag=decrypt_OFB_block(key,iv,cipher1)+decrypt_CBC_block(key,iv,cipher2)</span><br><span class="line"><span class="comment"># &#x27;ByteCTF&#123;5831a241s-f30980q535af-2156547475u2t&#125;$$$</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="overhead"><a href="#overhead" class="headerlink" title="overhead"></a>overhead</h3><p>典型的DH密钥交换，我们可以得到Alice，Bob的公钥，并且我们有一个oracle，可以用Bob的私钥加密消息，并且泄露加密后的高p.bitlength() - 64位（MSB）。不妨记为 k = p.bitlength() - 64位 （注意不是精确的位数）</p>
<p>注意到下面的等式，r是我们任意生成的随机数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pow</span>((<span class="built_in">pow</span>(g, r, p) * Alice) % p, b, p) == (<span class="built_in">pow</span>(Bob, r, p) * secret) % p</span><br></pre></td></tr></table></figure>
<p>这样我们可以提交<code>pow(g, r, p) * Alice) % p</code>，oracle会计算上面的式子，并且返回给我们右边的高p.bitlength() - 64位，只有secret是未知的，这是一个典型的<strong>Hidden Number Problem</strong> （HNP）问题。关于HNP问题，一般可以构造格，进行格基规约，再使用Babai算法求解CVP问题。</p>
<p>关于HNP问题的详细解法，这里给几篇不错的参考和论文：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.iacr.org/archive/crypto2009/56770333/56770333.pdf">https://www.iacr.org/archive/crypto2009/56770333/56770333.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://kel.bz/post/hnp/">https://kel.bz/post/hnp/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/204846">https://www.anquanke.com/post/id/204846</a></li>
</ul>
<p>HNP的解法简单来说就是构造下面(d+1)*(d+1)的矩阵：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HNP问题 alpha* t = u mod p， 给定t，oracle输出u的MSB，求alpha</span></span><br><span class="line">[  p,  <span class="number">0</span>, ... ,  <span class="number">0</span>,   <span class="number">0</span> ]</span><br><span class="line">[  <span class="number">0</span>,  p, ... ,  <span class="number">0</span>,   <span class="number">0</span> ]</span><br><span class="line">[         ...           ]</span><br><span class="line">[  <span class="number">0</span>,  <span class="number">0</span>, ... ,  p,   <span class="number">0</span> ]</span><br><span class="line">[ t1, t2, ... , td, <span class="number">1</span>/p ]</span><br></pre></td></tr></table></figure>
<p>其中t就是每次随机生成的输入，那么在上述矩阵的列向量张成的格内，求解Closest Vector Problem （CVP）问题，对于oracle返回的d组MSB的值U=（u1，u2，… ，ud），我们求解U离上面的格的最短向量，有极大概率使得这个最短向量就是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">closest_vector=(aplha*t1,alpha*t2,...,alpha*td,alpha/p)</span><br></pre></td></tr></table></figure>
<p>那么<strong>closest_vector[-1]*p就是我们需要求解的alpha</strong>。</p>
<p>参考上面第二个<a target="_blank" rel="noopener" href="https://kel.bz/post/hnp/">链接</a>的解法，这里给出一个本地的跑的脚本，验证解法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">c = <span class="number">21572244511100216966799370397791432119463715616349800194229377843045443048821</span></span><br><span class="line">p = <span class="number">62606792596600834911820789765744078048692259104005438531455193685836606544743</span></span><br><span class="line">g = <span class="number">5</span></span><br><span class="line">bits=<span class="number">64</span></span><br><span class="line"></span><br><span class="line">a = randint(<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">Alice = <span class="built_in">pow</span>(g, a, p)</span><br><span class="line">b = randint(<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">Bob = <span class="built_in">pow</span>(g, b, p)</span><br><span class="line">secret = <span class="built_in">pow</span>(Alice, b, p)</span><br><span class="line">print(a,b)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_bob</span>(<span class="params">msg</span>):</span></span><br><span class="line">    tmp_s = <span class="built_in">pow</span>(msg, b, p)</span><br><span class="line">    leak = tmp_s &gt;&gt; bits</span><br><span class="line">    leak = leak &lt;&lt; bits</span><br><span class="line">    <span class="keyword">return</span> leak</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_basis</span>(<span class="params">oracle_inputs,d=<span class="number">30</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns a basis using the HNP game parameters and inputs to our oracle</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    basis_vectors = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">        p_vector = [<span class="number">0</span>] * (d+<span class="number">1</span>)</span><br><span class="line">        p_vector[i] = p</span><br><span class="line">        basis_vectors.append(p_vector)</span><br><span class="line">    basis_vectors.append(<span class="built_in">list</span>(oracle_inputs) + [QQ(<span class="number">1</span>)/QQ(p)])</span><br><span class="line">    <span class="keyword">return</span> Matrix(QQ, basis_vectors)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">approximate_closest_vector</span>(<span class="params">basis, v</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns an approximate CVP solution using Babai&#x27;s nearest plane algorithm.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    BL = basis.LLL()</span><br><span class="line">    G, _ = BL.gram_schmidt()</span><br><span class="line">    _, n = BL.dimensions()</span><br><span class="line">    small = vector(ZZ, v)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(n)):</span><br><span class="line">        c = QQ(small * G[i]) / QQ(G[i] * G[i])</span><br><span class="line">        c = c.<span class="built_in">round</span>()</span><br><span class="line">        small -= BL[i] * c</span><br><span class="line">    <span class="keyword">return</span> (v - small).coefficients()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">oracle</span>(<span class="params">d=<span class="number">30</span></span>):</span></span><br><span class="line">    t_list=[]</span><br><span class="line">    u_list=[]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">        r= randint(<span class="number">1</span>,p-<span class="number">1</span>)</span><br><span class="line">        for_bob=(<span class="built_in">pow</span>(g, r, p) * Alice) % p</span><br><span class="line">        u=to_bob(for_bob)</span><br><span class="line">        t=<span class="built_in">pow</span>(Bob, r, p)</span><br><span class="line">        t_list.append(t)</span><br><span class="line">        u_list.append(u)</span><br><span class="line">    <span class="keyword">return</span> t_list,u_list</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hidden alpha scalar</span></span><br><span class="line">alpha = secret</span><br><span class="line"></span><br><span class="line"><span class="comment"># Using terminology from the paper: inputs = `t` values, answers = `a` values</span></span><br><span class="line">inputs, answers = oracle(<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Build a basis using our oracle inputs</span></span><br><span class="line">lattice = build_basis(inputs)</span><br><span class="line">print(<span class="string">&quot;Solving CVP using lattice with basis:\n%s\n&quot;</span> % <span class="built_in">str</span>(lattice))</span><br><span class="line"></span><br><span class="line"><span class="comment"># The non-lattice vector based on the oracle&#x27;s answers</span></span><br><span class="line">u = vector(ZZ, <span class="built_in">list</span>(answers) + [<span class="number">0</span>])</span><br><span class="line">print(<span class="string">&quot;Vector of MSB oracle answers:\n%s\n&quot;</span> % <span class="built_in">str</span>(u))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Solve an approximate CVP to find a vector v which is likely to reveal alpha.</span></span><br><span class="line">v = approximate_closest_vector(lattice, u)</span><br><span class="line">print(<span class="string">&quot;Closest lattice vector:\n%s\n&quot;</span> % <span class="built_in">str</span>(v))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Confirm the recovered value of alpha matches the expected value of alpha.</span></span><br><span class="line">recovered_alpha = (v[-<span class="number">1</span>] * p) % p</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;Recovered alpha! Alpha is %d&quot;</span> % recovered_alpha)</span><br><span class="line">print(<span class="string">&quot;Secret is &quot;</span>,alpha)</span><br><span class="line"><span class="keyword">assert</span> recovered_alpha == alpha</span><br></pre></td></tr></table></figure>
<p>最后提一嘴，这是今年<strong>USENIX上面的一篇论文</strong>提到的攻击：</p>
<p><a target="_blank" rel="noopener" href="https://www.usenix.org/system/files/sec21summer_merget.pdf">https://www.usenix.org/system/files/sec21summer_merget.pdf</a></p>
<p>另外一种解法是参考Nu1l战队的writeup，居然还可以用coppersmith来解，这是原writeup：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> remote</span><br><span class="line"><span class="keyword">from</span> pwnlib.tubes.tube <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">r = remote(<span class="string">&#x27;39.105.38.192&#x27;</span>, <span class="string">&#x27;30000&#x27;</span>)</span><br><span class="line">load(<span class="string">&quot;coppersmith.sage&quot;</span>)</span><br><span class="line">p = <span class="number">62606792596600834911820789765744078048692259104005438531455193685836606544743</span></span><br><span class="line">g = <span class="number">5</span></span><br><span class="line">P.&lt;x, y&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;$ &#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">Alice = <span class="built_in">int</span>(r.recvline().decode())</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;$ &#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">Bob = <span class="built_in">int</span>(r.recvline().decode())</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;$ &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;To Bob: &#x27;</span>, <span class="built_in">str</span>(Alice**<span class="number">2</span>))</span><br><span class="line">s2 = <span class="built_in">int</span>(r.recvline().decode())</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;$ &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;To Bob: &#x27;</span>, <span class="built_in">str</span>(Alice))</span><br><span class="line">s1 = <span class="built_in">int</span>(r.recvline().decode())</span><br><span class="line">f = (s1+x)^<span class="number">2</span> - s2 - y</span><br><span class="line">res = small_roots(f, bounds=(<span class="number">2</span>**<span class="number">64</span>, <span class="number">2</span>**<span class="number">64</span>), m=<span class="number">4</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;$ &#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;secret: &#x27;</span>, <span class="built_in">str</span>(s1+res[<span class="number">0</span>][<span class="number">0</span>]))</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p>其中coppersmith.sage可以在这个<a target="_blank" rel="noopener" href="https://github.com/defund/coppersmith/blob/master/coppersmith.sage">repo</a>找到，不直接使用sage自带的small_roots方法是因为sage目前还不支持多元多项式。</p>
<p>上面脚本的思想就是：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">发送 Alice 公钥 ---&gt; 返回 pow(Alice,b,p)=secret 的高k位MSB s1</span><br><span class="line">发送 Alice**2 ---&gt; 返回 pow(Alice**2,b,p)=secret**2 的高k位MSB s2</span><br></pre></td></tr></table></figure>
<p>有如下等式成立，其中x和y分别是secret和secret^2的低六十四位：</p>
<p><code>(s1+x)^2 - s2 - y == 0</code> </p>
<p>那么我们可以考虑coppersmith算法：</p>
<p>对于一个有限域n上面 e 阶的多项式 f,：</p>
<ul>
<li>在模 n 意义下，快速求出 $n^{1/e}$ 以内的根</li>
<li>给定 β，快速求出模某个 b 意义下较小的根，其中 b≥nβ，是 n 的因数。</li>
</ul>
<p>这里我们的指数e=2，p有512比特，而根的范围在2**64以内，显然这题满足coppersmith的条件。</p>
<p>当然这题还有第三种解法，这里就不写了，恰好byte决赛也出现了，可以看看。</p>
<p>&nbsp;</p>
<h3 id="abusedkey"><a href="#abusedkey" class="headerlink" title="abusedkey"></a>abusedkey</h3><p>协议分析题，我ECC基础太差了，没写出来。（主要是对sage的库不太清楚）</p>
<p>这里放个MoMoMo的writeup：</p>
<ul>
<li>首先按照协议2流程执行协议2，拿到hint。</li>
<li>接下来在协议2下爆破ds，爆破方式为先劫持msg23传输过程，把Qc | |Qs替换为Qc | | Rc，此时服务器端计算Yc= rt <em> hcN(-1)^ hc </em> Rc = rt <em>Rc, Ys = rt </em> hs(-1)<em> Rc = hs(-1)</em>Yc，在msg24中我们收到了Yc和Ys，因此可以穷举r(s)来计算ds，然后根据Ys和hsN(-1)*Yc是否相同来判断爆破出的ds是否正确。</li>
<li>最后回到协议1，可以直接进行流氓密钥攻击，我们劫持msg13传输过程，将sid1 || Tc替换为sid1 || Pc，此时服务器端计算Kcs =(-ds - ts)<em> Pc + ts </em> Pc =-ds * Pc，其中ds和Pc此时均已知，我们可以直接在本地计算出Kcs，按照协议1流程生成共享密钥，解密msg14过程中收到的FLAG的密文即可。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers.aead <span class="keyword">import</span> AESGCM</span><br><span class="line">p = <span class="number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">7</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">G = E(<span class="number">0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798</span>,</span><br><span class="line"><span class="number">0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8</span>)</span><br><span class="line">Pc = E(<span class="number">0xb5b1b07d251b299844d968be56284ef32dffd0baa6a0353baf10c90298dfd117</span>,</span><br><span class="line"><span class="number">0xea62978d102a76c3d6747e283091ac5f2b4c3ba5fc7a906fe023ee3bc61b50fe</span>)</span><br><span class="line">URL = <span class="string">&quot;http://39.105.181.182:30000/&quot;</span></span><br><span class="line">call_msg11 = <span class="string">&quot;/abusedkey/server/msg11&quot;</span></span><br><span class="line">call_msg13 = <span class="string">&quot;/abusedkey/server/msg13&quot;</span></span><br><span class="line">call_msg21 = <span class="string">&quot;/abusedkey/server/msg21&quot;</span></span><br><span class="line">call_msg23 = <span class="string">&quot;/abusedkey/ttp/msg23&quot;</span></span><br><span class="line">call_msg25 = <span class="string">&quot;/abusedkey/server/msg25&quot;</span></span><br><span class="line">msg21 = sid2 = os.urandom(<span class="number">32</span>).<span class="built_in">hex</span>()</span><br><span class="line">msg22 = Qs_hex = requests.get(URL + call_msg21, data = msg21).text</span><br><span class="line">Qs = E(bytes_to_long(<span class="built_in">bytes</span>.fromhex(Qs_hex)[:<span class="number">32</span>]),</span><br><span class="line">bytes_to_long(<span class="built_in">bytes</span>.fromhex(Qs_hex)[<span class="number">32</span>:]))</span><br><span class="line">rc = randint(<span class="number">1</span>, p)</span><br><span class="line">Rc = rc * G</span><br><span class="line">hc = <span class="built_in">int</span>(sha256(<span class="built_in">bytes</span>.fromhex(<span class="string">&quot;ffff&quot;</span>)).hexdigest(), <span class="number">16</span>)</span><br><span class="line">Qc = hc * Rc</span><br><span class="line">Qc_hex = <span class="built_in">hex</span>(Qc[<span class="number">0</span>])[<span class="number">2</span>:].zfill(<span class="number">64</span>) + <span class="built_in">hex</span>(Qc[<span class="number">1</span>])[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">msg23 = Qc_hex + Qs_hex</span><br><span class="line">msg24 = requests.get(URL + call_msg23, data = msg23).text</span><br><span class="line">Yc_hex = msg24[:<span class="number">128</span>]</span><br><span class="line">Ys_hex = msg24[<span class="number">128</span>:]</span><br><span class="line">Yc = E(bytes_to_long(<span class="built_in">bytes</span>.fromhex(Yc_hex)[:<span class="number">32</span>]),</span><br><span class="line">bytes_to_long(<span class="built_in">bytes</span>.fromhex(Yc_hex)[<span class="number">32</span>:]))</span><br><span class="line">Ys = E(bytes_to_long(<span class="built_in">bytes</span>.fromhex(Ys_hex)[:<span class="number">32</span>]),</span><br><span class="line">bytes_to_long(<span class="built_in">bytes</span>.fromhex(Ys_hex)[<span class="number">32</span>:]))</span><br><span class="line">msg25 = sid2 + Yc_hex</span><br><span class="line">msg26 = Chint = requests.get(URL + call_msg25, data = msg25).text</span><br><span class="line">Zcs = rc * Ys</span><br><span class="line">sk2 = sha256(long_to_bytes(Zcs[<span class="number">0</span>])).digest()</span><br><span class="line">Chint_bytes = <span class="built_in">bytes</span>.fromhex(Chint)</span><br><span class="line">iv = Chint_bytes[:<span class="number">12</span>]</span><br><span class="line">ct_hint = Chint_bytes[<span class="number">12</span>:-<span class="number">16</span>]</span><br><span class="line">mac = Chint_bytes[-<span class="number">16</span>:]</span><br><span class="line">cipher = AES.new(key = sk2, mode = AES.MODE_GCM, nonce = iv)</span><br><span class="line">hint = cipher.decrypt_and_verify(ct_hint, mac)</span><br><span class="line">print(hint)</span><br><span class="line">Rc_hex = <span class="built_in">hex</span>(Rc[<span class="number">0</span>])[<span class="number">2</span>:].zfill(<span class="number">64</span>) + <span class="built_in">hex</span>(Rc[<span class="number">1</span>])[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">msg23 = Qc_hex + Rc_hex</span><br><span class="line">msg24 = requests.get(URL + call_msg23, data = msg23).text</span><br><span class="line">Yc_hex = msg24[:<span class="number">128</span>]</span><br><span class="line">Ys_hex = msg24[<span class="number">128</span>:]</span><br><span class="line">Yc = E(bytes_to_long(<span class="built_in">bytes</span>.fromhex(Yc_hex)[:<span class="number">32</span>]),</span><br><span class="line">bytes_to_long(<span class="built_in">bytes</span>.fromhex(Yc_hex)[<span class="number">32</span>:]))</span><br><span class="line">Ys = E(bytes_to_long(<span class="built_in">bytes</span>.fromhex(Ys_hex)[:<span class="number">32</span>]),</span><br><span class="line">bytes_to_long(<span class="built_in">bytes</span>.fromhex(Ys_hex)[<span class="number">32</span>:]))</span><br><span class="line">o = E.order()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65538</span>):</span><br><span class="line"> print(i)</span><br><span class="line"> hs = <span class="built_in">int</span>(sha256(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(i)[<span class="number">2</span>:].zfill(<span class="number">4</span>))).hexdigest(), <span class="number">16</span>)</span><br><span class="line"> hs_inverse = inverse_mod(hs, o)</span><br><span class="line"> <span class="keyword">if</span> Ys == Yc * hs_inverse:</span><br><span class="line"> print((i, hs))</span><br><span class="line"> <span class="keyword">break</span></span><br><span class="line">ds = hs</span><br><span class="line">sid1 = os.urandom(<span class="number">32</span>).<span class="built_in">hex</span>()</span><br><span class="line">_ = requests.get(URL + call_msg11, data = sid1).text</span><br><span class="line">Tc = -Pc</span><br><span class="line">Tc_hex = <span class="built_in">hex</span>(Tc[<span class="number">0</span>])[<span class="number">2</span>:].zfill(<span class="number">64</span>) + <span class="built_in">hex</span>(Tc[<span class="number">1</span>])[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">msg13 = sid1 + Tc_hex</span><br><span class="line">msg14 = Cflag = requests.get(URL + call_msg13, data = msg13).text</span><br><span class="line">Kcs = -ds * Pc</span><br><span class="line">sk1 = sha256(long_to_bytes(Kcs[<span class="number">0</span>])).digest()</span><br><span class="line">Cflag_bytes = <span class="built_in">bytes</span>.fromhex(Cflag)</span><br><span class="line">iv = Cflag_bytes[:<span class="number">12</span>]</span><br><span class="line">ct_flag = Cflag_bytes[<span class="number">12</span>:-<span class="number">16</span>]</span><br><span class="line">mac = Cflag_bytes[-<span class="number">16</span>:]</span><br><span class="line">cipher = AES.new(key = sk1, mode = AES.MODE_GCM, nonce = iv)</span><br><span class="line">FLAG = cipher.decrypt_and_verify(ct_flag, mac)</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h2 id="2021-L3HCTF-Crypto-题解"><a href="#2021-L3HCTF-Crypto-题解" class="headerlink" title="2021 L3HCTF Crypto 题解"></a>2021 L3HCTF Crypto 题解</h2><p>官方题解可以在这里找到：<a target="_blank" rel="noopener" href="https://hust-l3hsec.feishu.cn/docs/doccniAzQvQixcSUF5f4tXMLHdc#">L3HCTF2021官方题解</a>。题目存库于<a target="_blank" rel="noopener" href="https://github.com/tl2cents/CTF-Archive">repo</a>。</p>
<p>&nbsp;</p>
<h3 id="EzECDSA"><a href="#EzECDSA" class="headerlink" title="EzECDSA"></a>EzECDSA</h3><p>这是一个HNP问题，提供了oracle，在github上面能直接找到对应的仓库：<a target="_blank" rel="noopener" href="https://github.com/bitlogik/lattice-attack">lattice-attack</a></p>
<p>可以直接利用这个代码解，只需要写交互的脚本就行。wsl2本地跑的时候发现ecdsa_lib.py报错，在118行注释即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ret = False</span></span><br><span class="line">   <span class="comment"># try:</span></span><br><span class="line">   <span class="comment">#     publickey_obj.public_key()</span></span><br><span class="line">   <span class="comment">#     ret = True</span></span><br><span class="line">   <span class="comment"># except ValueError:</span></span><br><span class="line">   <span class="comment">#     pass</span></span><br><span class="line">   ret = <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">23333</span>)</span><br><span class="line">data = &#123;&#125;</span><br><span class="line">info = []</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&quot;+&quot;</span>)</span><br><span class="line">part = r.recvuntil(<span class="string">b&quot;)&quot;</span>)[:-<span class="number">1</span>].decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="comment"># print(part)</span></span><br><span class="line">r.recvuntil(<span class="string">b&quot;= &quot;</span>)</span><br><span class="line">suffix = r.recvline().strip().decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="comment"># print(suffix)</span></span><br><span class="line">r.recv()</span><br><span class="line">pts = itertools.product(string.printable, repeat=<span class="number">4</span>)</span><br><span class="line"><span class="keyword">for</span> pt <span class="keyword">in</span> pts:</span><br><span class="line">    p = <span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(pt)) + part</span><br><span class="line">    ct = sha256(p.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ct == suffix:</span><br><span class="line">        r.send(p[:<span class="number">4</span>].encode())</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">data[<span class="string">&quot;curve&quot;</span>] = <span class="string">&quot;SECP256K1&quot;</span></span><br><span class="line">publickey = r.recvline().decode().strip(<span class="string">&#x27;(&#x27;</span>).strip(<span class="string">&#x27;\n&#x27;</span>).strip(<span class="string">&#x27;)&#x27;</span>).split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">publickey = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">eval</span>, publickey))</span><br><span class="line">data[<span class="string">&quot;public_key&quot;</span>] = publickey</span><br><span class="line">data[<span class="string">&quot;known_type&quot;</span>] = <span class="string">&quot;LSB&quot;</span></span><br><span class="line">data[<span class="string">&quot;known_bits&quot;</span>] = <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.send(<span class="string">b&#x27;hello\n&#x27;</span>)</span><br><span class="line">    tmp = &#123;&#125;</span><br><span class="line">    r_sig = <span class="built_in">int</span>(r.recvline().decode().strip(<span class="string">&quot;r = &quot;</span>).strip(<span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">    s_sig = <span class="built_in">int</span>(r.recvline().decode().strip(<span class="string">&quot;s = &quot;</span>).strip(<span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">    kp = <span class="built_in">int</span>(r.recvline().decode().strip(<span class="string">&quot;kp = &quot;</span>).strip(<span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">    <span class="built_in">hash</span> = <span class="built_in">int</span>(r.recvline().decode().strip(<span class="string">&quot;hash = &quot;</span>).strip(<span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">    tmp[<span class="string">&quot;r&quot;</span>] = r_sig</span><br><span class="line">    tmp[<span class="string">&quot;s&quot;</span>] = s_sig</span><br><span class="line">    tmp[<span class="string">&quot;kp&quot;</span>] = kp</span><br><span class="line">    tmp[<span class="string">&quot;hash&quot;</span>] = <span class="built_in">hash</span></span><br><span class="line">    info.append(tmp)</span><br><span class="line">data[<span class="string">&quot;signatures&quot;</span>] = info</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.json&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    json.dump(data, f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># r.interactive()</span></span><br><span class="line">r.recvline()</span><br><span class="line">res = subprocess.Popen(<span class="string">&#x27;python3 exp/lattice_attack.py -f data.json&#x27;</span>, shell=<span class="literal">True</span>, stdout=subprocess.PIPE, stderr=subprocess.PIPE, close_fds=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># https://github.com/bitlogik/lattice-attack</span></span><br><span class="line">result = res.stdout.read().decode().split(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">2</span>]</span><br><span class="line">sKey = <span class="built_in">str</span>(<span class="built_in">int</span>(result[-<span class="number">1</span>], <span class="number">16</span>)).encode()</span><br><span class="line">r.sendline(sKey)</span><br><span class="line">print(r.recv())</span><br></pre></td></tr></table></figure>
<p><img src="./image-20211123130504880.png" alt="image-20211123130504880"></p>
<p>&nbsp;</p>
<h3 id="p0o0w"><a href="#p0o0w" class="headerlink" title="p0o0w"></a>p0o0w</h3><p>难的在于逆向，rust逆向出来之后的符号实在太多了。</p>
<p>当时逆向的时候主要看了这个函数，应该是生成伪随机数的种子</p>
<p><img src="./image-20211123135300930.png" alt="image-20211123135300930"></p>
<p>真正关于prng的函数在Magic函数中</p>
<p><img src="./image-20211123135427602.png" alt="image-20211123135427602"></p>
<p>进入magic函数中：</p>
<p><img src="./image-20211123135523311.png" alt="image-20211123135523311"></p>
<p>我们发现只有异或和移位运算，从这里就可以看出大概的PRNG算法了，是Xorshift类的算法，因为产生的是16字节的随机数，即Xorshift128，并且移位的参数是23,17,26。官方wp说可以分析算法，也可以直接用z3解，因为涉及的运算只有移位异或。具体来说，先用爆破的方式得到前面6个随机数，得到初始的state，之后就可以预测随机数了，一个可行的z3解法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># Hack for mbruteforce on macos</span></span><br><span class="line"><span class="comment"># import multiprocessing</span></span><br><span class="line"><span class="comment"># multiprocessing.set_start_method(&#x27;fork&#x27;)</span></span><br><span class="line"></span><br><span class="line">MASK = <span class="number">0xFFFFFFFFFFFFFFFF</span></span><br><span class="line"><span class="comment"># context.terminal = [&quot;tmux&quot;,&quot;split&quot;,&quot;-h&quot;]</span></span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"></span><br><span class="line">start = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">target_hash = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hhash</span>(<span class="params">end</span>):</span></span><br><span class="line">    end = end.encode()</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha256(start+end).hexdigest() == target_hash</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_init</span>(<span class="params">states</span>):</span></span><br><span class="line">    print(states)</span><br><span class="line">    init_s0, init_s1 = BitVecs(<span class="string">&#x27;init_s0 init_s1&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">    s0_ = init_s0</span><br><span class="line">    s1_ = init_s1</span><br><span class="line">    s = Solver()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> states:</span><br><span class="line">        s1 = s0_</span><br><span class="line">        s0 = s1_</span><br><span class="line">        s1 ^= (s1 &lt;&lt; <span class="number">23</span>)</span><br><span class="line">        s1 ^= LShR(s1, <span class="number">17</span>)</span><br><span class="line">        s1 ^= s0</span><br><span class="line">        s1 ^= LShR(s0, <span class="number">26</span>)</span><br><span class="line">        s.add(s0+s1 == i)</span><br><span class="line">        s0_ = s0</span><br><span class="line">        s1_ = s1</span><br><span class="line">    print(s.check())</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">return</span> m[init_s0].as_long(),m[init_s1].as_long()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XorShift128</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,s0,s1</span>) -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self.s0 = s0</span><br><span class="line">        self.s1 = s1</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self</span>):</span></span><br><span class="line">        s0_ = self.s1</span><br><span class="line">        s1_ = self.s0</span><br><span class="line">        s1_ ^= (s1_ &lt;&lt; <span class="number">23</span>) &amp; MASK</span><br><span class="line">        s1_ ^= (s1_ &gt;&gt; <span class="number">17</span>) &amp; MASK</span><br><span class="line">        s1_ ^= s0_</span><br><span class="line">        s1_ ^= ( s0_&gt;&gt;<span class="number">26</span> ) &amp; MASK</span><br><span class="line">        self.s0 = s0_</span><br><span class="line">        self.s1 = s1_</span><br><span class="line">        <span class="keyword">return</span> (self.s0 + self.s1) &amp; MASK </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_connect_proof</span>():</span></span><br><span class="line">    <span class="comment"># io=remote(&quot;121.36.201.164&quot;, 9999)</span></span><br><span class="line">    io = process(<span class="string">&quot;./pow/p0o0w&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;sha256(&#x27;</span>)</span><br><span class="line">    alphabet = string.ascii_letters + string.digits</span><br><span class="line">    lattar_part=io.recv(<span class="number">13</span>).decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;== &#x27;</span>)</span><br><span class="line">    h=io.recvline().strip().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    <span class="comment"># print(h)</span></span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;tell me the ? in sha256(?):&#x27;</span>)</span><br><span class="line">    bruteforce=[ lattar_part + <span class="string">&#x27;&#x27;</span>.join(prefix) <span class="keyword">for</span> prefix <span class="keyword">in</span> product(alphabet,repeat=<span class="number">3</span>)]</span><br><span class="line">    <span class="keyword">for</span> proof <span class="keyword">in</span> bruteforce:</span><br><span class="line">        <span class="keyword">if</span> sha256(proof.encode()).hexdigest()==h:</span><br><span class="line">            io.sendline(proof.encode())</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    print(<span class="string">&quot;proof done&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> io,<span class="built_in">int</span>(proof,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof</span>(<span class="params">io,i</span>):</span></span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;sha256(&#x27;</span>)</span><br><span class="line">    alphabet = <span class="string">&quot;abcdef&quot;</span> + string.digits</span><br><span class="line">    lattar_part=io.recv(<span class="number">16</span>-i).decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    print(<span class="string">&quot;[+] lattar part&quot;</span>,lattar_part)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;== &#x27;</span>)</span><br><span class="line">    h=io.recvline().strip().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    print(<span class="string">&quot;[+] hash&quot;</span>,h)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;tell me the ? in sha256(?):&#x27;</span>)</span><br><span class="line">    bruteforce=[ lattar_part + <span class="string">&#x27;&#x27;</span>.join(prefix) <span class="keyword">for</span> prefix <span class="keyword">in</span> product(alphabet,repeat=i)]</span><br><span class="line">    <span class="keyword">for</span> proof <span class="keyword">in</span> bruteforce:</span><br><span class="line">        <span class="keyword">if</span> sha256(proof.encode()).hexdigest()==h:</span><br><span class="line">            io.sendline(proof.encode())</span><br><span class="line">            print(<span class="string">&quot;proof %d done&quot;</span>%i)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(proof,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">outs=[]</span><br><span class="line">io,num=set_connect_proof()</span><br><span class="line">outs.append(num)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>,<span class="number">7</span>):</span><br><span class="line">    outs.append(proof(io,i))</span><br><span class="line">s0,s1 = solve_init(outs)</span><br><span class="line">print(s0,s1)</span><br><span class="line">prng = XorShift128(s0,s1)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> outs:</span><br><span class="line">    print(prng.get(),_)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span>  <span class="built_in">range</span>(<span class="number">7</span>,<span class="number">17</span>):</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;ell me the ? in sha256(?):&#x27;</span>).decode()</span><br><span class="line">    ret = <span class="string">f&#x27;<span class="subst">&#123;prng.get():016x&#125;</span>&#x27;</span></span><br><span class="line">    print(ret)</span><br><span class="line">    io.sendline(ret.encode())</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h2 id="2021-西湖论剑-Crypto题解"><a href="#2021-西湖论剑-Crypto题解" class="headerlink" title="2021 西湖论剑 Crypto题解"></a>2021 西湖论剑 Crypto题解</h2><p>题目存库于repo：<a target="_blank" rel="noopener" href="https://github.com/tl2cents/CTF-Archive">西湖论剑Crypto</a></p>
<p>&nbsp;</p>
<h3 id="unknownDSA"><a href="#unknownDSA" class="headerlink" title="unknownDSA"></a>unknownDSA</h3><p>一开始看到有很多的未知变量，其中ul和vl给了下面的关系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ul[i]**<span class="number">2</span> - wl[i]* vl[i]**<span class="number">2</span>==<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>这个方程仔细研究发现是有名的佩尔方程 $x^2-n*y^2=1$</p>
<p>pell方程的sagemath解法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_sat_pell</span>(<span class="params">x, y, n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x^<span class="number">2</span> - n * y ^ <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_pell_equation</span>(<span class="params">n, nums_of_solutions</span>):</span></span><br><span class="line">    <span class="comment"># x^2 - n * y ^ 2 = 1</span></span><br><span class="line">    nth_continue_fraction = continued_fraction(sqrt(n))</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; nums_of_solutions:</span><br><span class="line">        temp_numerator = nth_continue_fraction.numerator(i)</span><br><span class="line">        temp_denominator = nth_continue_fraction.denominator(i)</span><br><span class="line">        <span class="keyword">if</span> check_sat_pell(temp_numerator, temp_denominator, n):</span><br><span class="line">            print(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span> th solution is &quot;</span>, temp_numerator, temp_denominator)</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>以及一个<a target="_blank" rel="noopener" href="https://comnuan.com/cmnn02/cmnn0200c/cmnn0200c.php">online的最小解网站</a>，发现ul和vl就是给定的wl时的最小解。</p>
<p>解出来之后就是简单的DSA复用k的漏洞，可以直接通过同余方程解出。</p>
<p>如果在两次签名的过程中共享了 k，就可以进行攻击。假设签名的消息为 m1,m2，k相同，则两者的r值相同，此外</p>
<p>$s_1≡(H(m_1)+x_r)k^{−1}\ (mod\ q)$</p>
<p>$s_2≡(H(m_2)+x_r)k^{−1}\ (mod\ q)$</p>
<p>联立得到</p>
<p>$k(s_1−s_2)≡(H(m_1)−H(m_2))(modq)$</p>
<p>此时可解出 k，从而代入任意一个方程得到私钥x。</p>
<p>脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA</span><br><span class="line"></span><br><span class="line">wl,cl1,cl2=[<span class="number">3912956711</span>, <span class="number">4013184893</span>, <span class="number">3260747771</span>], [<span class="number">2852589223779928796266540600421678790889067284911682578924216186052590393595645322161563386615512475256726384365091711034449682791268994623758937752874750918200961888997082477100811025721898720783666868623498246219677221106227660895519058631965055790709130207760704</span>, <span class="number">21115849906180139656310664607458425637670520081983248258984166026222898753505008904136688820075720411004158264138659762101873588583686473388951744733936769732617279649797085152057880233721961</span>, <span class="number">301899179092185964785847705166950181255677272294377823045011205035318463496682788289651177635341894308537787449148199583490117059526971759804426977947952721266880757177055335088777693134693713345640206540670123872210178680306100865355059146219281124303460105424</span>], [<span class="number">148052450029409767056623510365366602228778431569288407577131980435074529632715014971133452626021226944632282479312378667353792117133452069972334169386837227285924011187035671874758901028719505163887789382835770664218045743465222788859258272826217869877607314144</span>, <span class="number">1643631850318055151946938381389671039738824953272816402371095118047179758846703070931850238668262625444826564833452294807110544441537830199752050040697440948146092723713661125309994275256</span>, <span class="number">10949587016016795940445976198460149258144635366996455598605244743540728764635947061037779912661207322820180541114179612916018317600403816027703391110922112311910900034442340387304006761589708943814396303183085858356961537279163175384848010568152485779372842</span>]</span><br><span class="line"></span><br><span class="line">x1 = <span class="number">10537190383977432819948602717449313819513015810464463348450662860435011008001132238851729268032889296600248226221086420035262540732157097949791756421026015741477785995033447663038515248071740991264311479066137102975721041822067496462240009190564238288281272874966280</span></span><br><span class="line">y1 = <span class="number">168450500310972930707208583777353845862723614274337696968629340838437927919365973736431467737825931894403582133125917579196621697175572833671789075169621831768398654909584273636143519940165648838850012943578686057625415421266321405275952938776845012046586285747</span></span><br><span class="line"></span><br><span class="line">x2 = <span class="number">121723653124334943327337351369224143389428692536182586690052931548156177466437320964701609590004825981378294358781446032392886186351422728173975231719924841105480990927174913175897972732532233</span></span><br><span class="line">y2 = <span class="number">1921455776649552079281304558665818887261070948261008212148121820969448652705855804423423681848341600084863078530401518931263150887409200101780191600802601105030806253998955929263882382004</span></span><br><span class="line"></span><br><span class="line">x3 = <span class="number">1440176324831562539183617425199117363244429114385437232965257039323873256269894716229817484088631407074328498896710966713912857642565350306252498754145253802734893404773499918668829576304890397994277568525506501428687843547083479356423917301477033624346211335450</span></span><br><span class="line">y3 = <span class="number">25220695816897075916217095856631009012504127590059436393692101250418226097323331193222730091563032067314889286051745468263446649323295355350101318199942950223572194027189199046045156046295274639977052585768365501640340023356756783359924935106074017605019787</span></span><br><span class="line"></span><br><span class="line">vl=[x1,x2,x3]</span><br><span class="line">ul=[y1,y2,y3]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_pell_solu</span>(<span class="params">min_solu,kthsolu,n</span>):</span></span><br><span class="line">    xnext=min_solu[<span class="number">0</span>]*kthsolu[<span class="number">0</span>]+n*min_solu[<span class="number">1</span>]*kthsolu[<span class="number">1</span>]</span><br><span class="line">    ynext=min_solu[<span class="number">0</span>]*kthsolu[<span class="number">1</span>]+min_solu[<span class="number">1</span>]*kthsolu[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> [xnext,ynext]</span><br><span class="line">    </span><br><span class="line"><span class="comment">#sage</span></span><br><span class="line">x=crt(cl1,vl)</span><br><span class="line">m1=x.nth_root(<span class="number">7</span>)</span><br><span class="line">y=crt(cl2,ul)</span><br><span class="line">m2=y.nth_root(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(m1))</span><br><span class="line">print(long_to_bytes(m2))</span><br><span class="line"></span><br><span class="line"><span class="comment"># h1 = bytes_to_long(SHA.new(m1).digest())</span></span><br><span class="line"><span class="comment"># h2 = bytes_to_long(SHA.new(m2).digest())</span></span><br><span class="line"></span><br><span class="line">h1=<span class="number">63998600246749767922010292163233985055258508821</span></span><br><span class="line">h2=<span class="number">1121013631791355094793010532678158450130791457285</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    <span class="keyword">while</span> a!=<span class="number">0</span>:</span><br><span class="line">        a,b = b%a,a</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findModReverse</span>(<span class="params">a,m</span>):</span></span><br><span class="line">    <span class="keyword">if</span> gcd(a,m)!=<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    u1,u2,u3 = <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">    v1,v2,v3 = <span class="number">0</span>,<span class="number">1</span>,m</span><br><span class="line">    <span class="keyword">while</span> v3!=<span class="number">0</span>:</span><br><span class="line">        q = u3//v3</span><br><span class="line">        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3</span><br><span class="line">    <span class="keyword">return</span> u1%m</span><br><span class="line"></span><br><span class="line">pq, p_1dq, t=<span class="number">85198615386075607567070020969981777827671873654631200472078241980737834438897900146248840279191139156416537108399682874370629888207334506237040017838313558911275073904148451540255705818477581182866269413018263079858680221647341680762989080418039972704759003343616652475438155806858735982352930771244880990190318526933267455248913782297991685041187565140859</span>, <span class="number">106239950213206316301683907545763916336055243955706210944736472425965200103461421781804731678430116333702099777855279469137219165293725500887590280355973107580745212368937514070059991848948031718253804694621821734957604838125210951711527151265000736896607029198</span>, <span class="number">60132176395922896902518845244051065417143507550519860211077965501783315971109433544482411208238485135554065241864956361676878220342500208011089383751225437417049893725546176799417188875972677293680033005399883113531193705353404892141811493415079755456185858889801456386910892239869732805273879281094613329645326287205736614546311143635580051444446576104548</span></span><br><span class="line">r1,s1,s2=<span class="number">498841194617327650445431051685964174399227739376</span>, <span class="number">376599166921876118994132185660203151983500670896</span>, <span class="number">187705159843973102963593151204361139335048329243</span></span><br><span class="line"><span class="comment"># r2,s3=620827881415493136309071302986914844220776856282, 674735360250004315267988424435741132047607535029</span></span><br><span class="line">m=pq//p_1dq</span><br><span class="line">q=m.nth_root(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># q=895513916279543445314258868563331268261201605181</span></span><br><span class="line">p=pq//q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=inverse(p*q-p-q,phi)</span><br><span class="line">g=<span class="built_in">pow</span>(t,d,pq)</span><br><span class="line"></span><br><span class="line">G=GF(p)</span><br><span class="line">g=G(g)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证g的阶性质</span></span><br><span class="line"><span class="keyword">assert</span> g^q == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">r1,s1=r1,s1</span><br><span class="line">r2,s2=r1,s2</span><br><span class="line">k=(h1-h2)*findModReverse(s1-s2,q)%q</span><br><span class="line"><span class="comment"># t = powmod(g, p*q-(p+q), p*q)</span></span><br><span class="line"></span><br><span class="line">x=findModReverse(r1,q)*(k*s1-h1)%q</span><br><span class="line">print(<span class="string">&quot;find x1 &quot;</span>,x)</span><br><span class="line">print(long_to_bytes(x))</span><br><span class="line"></span><br><span class="line">r2,s3=<span class="number">620827881415493136309071302986914844220776856282</span>, <span class="number">674735360250004315267988424435741132047607535029</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># s3 = (hm1 + x2*r2) * invert(k, q) % q</span></span><br><span class="line">x2=inverse(r2,q)*(k*s3-h1)%q</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;find x2 &quot;</span>,x2)</span><br><span class="line">print(long_to_bytes(x2))</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="FilterRandom"><a href="#FilterRandom" class="headerlink" title="FilterRandom"></a>FilterRandom</h3><p>这题的writeup参考：<a target="_blank" rel="noopener" href="https://team-su.github.io/passages/2021-11-20-XHLJ/">SU战队</a></p>
<p>当时做这个题的时候概率算错了，现在重新估算一遍：</p>
<p>线性移位寄存器输出的比特流，有90%的概率来自lfsr1,10%的概率来自lfsr2，任意给定64比特，全部来自lfsr1的概率是：$0.9^{64}=0.00118$，但是我们有2048比特，有2048-64=1984个连续64比特串，加入它们都不是全部来自lfsr1，概率是：$(1-0.00118)^{1984}=0.096$，当然，这个算的也有问题，因为每个概率不是独立的，但是我们同时也注意到即使选中lfsr2，输出也很有可能与lfsr1相同因，此有我们姑且认为有很大概率可以找到连续的64比特串使它们全部来自lfsr1, <strong>也有可能是出题人选择了一次符合条件的输出，降低了难度</strong>，通过爆破找到连续64个比特之后，只需要一直向前回溯，就能得到初始状态init1，这样我们就得到lfsr1的初始状态。</p>
<p>之后我们就考虑求解lfsr2的初始状态。可以用矩阵方程：$initA^{k-1}mask$ 得到第k个输出。已知100多比特的输出，完全可以求逆得到初始状态。那么就可列$xA=y$形式矩阵方程计算。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">64</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lfsr</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, init, mask, length</span>):</span></span><br><span class="line">        self.init = init</span><br><span class="line">        self.mask = mask</span><br><span class="line">        self.lengthmask = <span class="number">2</span>**length-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        nextdata = (self.init &lt;&lt; <span class="number">1</span>) &amp; self.lengthmask </span><br><span class="line">        i = self.init &amp; self.mask &amp; self.lengthmask </span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">            output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">            i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">        nextdata ^= output</span><br><span class="line">        self.init = nextdata</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backtrace</span>(<span class="params">state, mask</span>):</span></span><br><span class="line">    mask = ((mask &amp; <span class="number">0x7FFFFFFFFFFFFFFF</span>) &lt;&lt; <span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">    i = state &amp; mask</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">        output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">        i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">    state &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (output &lt;&lt; <span class="number">63</span>) + state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">output = <span class="string">&quot;10001011010100011000100101001011100010110111001100001110000111011011100101101101000111101100010111100011000011111111010101111100101010101100010100000111011010011110111000100000101100101010110100111100011000101010101011011111011011000001101001011000010000011110001111001111011100110011111111101000111101001010000110001110111101001001101011101101001010001101010010110000000000001001101100101011110011010110011010110110011001001111001010100011110111100100010110111100110010000000010010011110001100000011000001110001000000010000100100101100000011100000011110101001011010011010100001101000010100100000011001011001000110000000000111011101000110010110111110010101110010001010001111111000011010000011001110111001000010011000000111010111100000100010011001111101110110100100011111000111000011111101010010110011111100010000100101011000001010101111101111001000011101111000111000101011010111100110001011011100101001010110110110110011100100111100110001101110010100010111100000110000010110100010001100011011001100100110101110010100011101110110010000010011100000011100000101010011011111110000100000010001010111011011111110100111100011100011110110010001011101111001011101010110111001001000111001001111001111110111111100001111100100110011111110110101000011010111110010001100000111100010011100011010000101010111010101101000011001110011000000110110110001101100110101110010010111011100110101000110000011001010100000110000000001110010001010001001101111100001111111011010010011100110010000111010001001111111110000010101110011010100100101101100111000010110100110010001010110111110011000111011101110100010000110110110011001011111011111000000000000001110000001000011000110111000000110100110110001111011111100010010011100101010000111000011111010000001010010011101010010110011000000001111110000000010111011000010001111000100110101110001000011111001101111111100011111011001001110000101001101110100111010011011101000110010000001001000001100110001110101100001000110100100010111101100010100110011111010011100100001101111010000110110101111111001111011100001101100000001101111100100&quot;</span></span><br><span class="line">mask1=<span class="number">17638491756192425134</span></span><br><span class="line">mask2=<span class="number">14623996511862197922</span></span><br><span class="line">ans=[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里没有回溯的过程，减少穷举时间</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1984</span>):</span><br><span class="line">    gadget = <span class="built_in">int</span>(output[i:i+<span class="number">64</span>], <span class="number">2</span>)</span><br><span class="line">    l1=lfsr(gadget,mask1,<span class="number">64</span>)</span><br><span class="line">    cnt=<span class="number">0</span>    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">64</span>, <span class="number">2048</span>):</span><br><span class="line">        <span class="keyword">if</span> l1.<span class="built_in">next</span>()==<span class="built_in">int</span>(output[j]):</span><br><span class="line">            cnt+=<span class="number">1</span></span><br><span class="line">            </span><br><span class="line">    total=<span class="number">1984</span>-i</span><br><span class="line">    <span class="comment"># 输出为lfsr1概率</span></span><br><span class="line">    ans.append((i, cnt / total))</span><br><span class="line"></span><br><span class="line">ans.sort(key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">ans2=[]</span><br><span class="line"><span class="keyword">for</span> i, each <span class="keyword">in</span> ans:</span><br><span class="line">    <span class="keyword">if</span> each &gt; <span class="number">0.85</span>:</span><br><span class="line">        ans2.append((i,each))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># 比例高于0.85的</span></span><br><span class="line">ans2.sort(key=<span class="keyword">lambda</span> x:x[<span class="number">0</span>])</span><br><span class="line">print(ans2)</span><br><span class="line">idx = ans2[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从661到6669都是来自lfsr1的</span></span><br><span class="line"></span><br><span class="line">init1 = output[idx:idx+<span class="number">64</span>]</span><br><span class="line">init1 = <span class="built_in">int</span>(init1, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 回溯状态</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(idx):</span><br><span class="line">    init1 = backtrace(init1, mask1)</span><br><span class="line"><span class="comment"># 得到初始值</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    init1 = backtrace(init1, mask1)</span><br><span class="line"></span><br><span class="line">print(init1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 作者: Suers</span></span><br><span class="line"><span class="comment"># 链接: https://team-su.github.io/passages/2021-11-20-XHLJ/</span></span><br><span class="line"><span class="comment"># 来源: team-su.github.io</span></span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="HardRSA"><a href="#HardRSA" class="headerlink" title="HardRSA"></a>HardRSA</h3><p>整体是一个离散对数求解以及RSA变种，叫做 <a target="_blank" rel="noopener" href="https://link.springer.com/content/pdf/10.1007%2F3-540-36178-2_19.pdf"><strong>Hensel lifting for Takagi’s scheme</strong></a>。具体可以参考<a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/">Lazzzaro博客</a>。这题RSA部分脚本也是取自上面的博客。先用sage自带的discrete_log求出p，之后用上面的方法解密即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">y = <span class="number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span></span><br><span class="line">c1 = <span class="number">78100131461872285613426244322737502147219485108799130975202429638042859488136933783498210914335741940761656137516033926418975363734194661031678516857040723532055448695928820624094400481464950181126638456234669814982411270985650209245687765595483738876975572521276963149542659187680075917322308512163904423297381635532771690434016589132876171283596320435623376283425228536157726781524870348614983116408815088257609788517986810622505961538812889953185684256469540369809863103948326444090715161351198229163190130903661874631020304481842715086104243998808382859633753938512915886223513449238733721777977175430329717970940440862059204518224126792822912141479260791232312544748301412636222498841676742208390622353022668320809201312724936862167350709823581870722831329406359010293121019764160016316259432749291142448874259446854582307626758650151607770478334719317941727680935243820313144829826081955539778570565232935463201135110049861204432285060029237229518297291679114165265808862862827211193711159152992427133176177796045981572758903474465179346029811563765283254777813433339892058322013228964103304946743888213068397672540863260883314665492088793554775674610994639537263588276076992907735153702002001005383321442974097626786699895993544581572457476437853778794888945238622869401634353220344790419326516836146140706852577748364903349138246106379954647002557091131475669295997196484548199507335421499556985949139162639560622973283109342746186994609598854386966520638338999059</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># G=GF(y)</span></span><br><span class="line"><span class="comment"># g=G(2)</span></span><br><span class="line"><span class="comment"># c1=G(c1)</span></span><br><span class="line"><span class="comment"># x=discrete_log(c1,g)</span></span><br><span class="line"><span class="comment"># # var(&#x27;y&#x27;)</span></span><br><span class="line"><span class="comment"># # qe = (2019*y^2 + 2020*y^3 + 2021*y^4 - x==0)</span></span><br><span class="line"><span class="comment"># # p=solve(qe, y)</span></span><br><span class="line"><span class="comment"># n = p**4*q</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">dp = <span class="number">379476973158146550831004952747643994439940435656483772269013081580532539640189020020958796514224150837680366977747272291881285391919167077726836326564473</span></span><br><span class="line">c = <span class="number">57248258945927387673579467348106118747034381190703777861409527336272914559699490353325906672956273559867941402281438670652710909532261303394045079629146156340801932254839021574139943933451924062888426726353230757284582863993227592703323133265180414382062132580526658205716218046366247653881764658891315592607194355733209493239611216193118424602510964102026998674323685134796018596817393268106583737153516632969041693280725297929277751136040546830230533898514659714717213371619853137272515967067008805521051613107141555788516894223654851277785393355178114230929014037436770678131148140398384394716456450269539065009396311996040422853740049508500540281488171285233445744799680022307180452210793913614131646875949698079917313572873073033804639877699884489290120302696697425</span></span><br><span class="line">p=<span class="number">12131601165788024635030034921084070470053842112984866821070395281728468805072716002494427632757418621194662541766157553264889658892783635499016425528807741</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b = <span class="number">4</span></span><br><span class="line">mp1 = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, dp - <span class="number">1</span>, p)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b - <span class="number">2</span>):</span><br><span class="line">	x = <span class="built_in">pow</span>(c - <span class="built_in">pow</span>(mp1, e), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">	y = <span class="built_in">pow</span>(x * mp * (gmpy2.invert(e, p)), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">	mp1 = mp1 + y</span><br><span class="line">print(long_to_bytes(mp1))</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="SpecialCurve2"><a href="#SpecialCurve2" class="headerlink" title="SpecialCurve2"></a>SpecialCurve2</h3><p>这道题比赛的时候没有解出来，题目自己设计了一个乘法群，其实就是复数域上面的乘法，对于复数域上面的乘法，模p意义上的阶是<script type="math/tex">p^2-1</script>。对于题目中的<script type="math/tex">n=p*q*r</script>，它的阶就是<script type="math/tex">\phi(n)=(p^2-1)(q^2-1)(r^2-1)</script>，那么只要求出e，类似RSA加密，求解出e关于这个乘法群的逆d，就可以任意解密了。关键在于这个e怎么求。理论上面详细的证明可以参考<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/436496753">这篇知乎</a>（<strong>另外一种基于CRT来求e的解法也可以参考这篇</strong>）。</p>
<p>我们取模发现它的乘方保持模长上同态的关系，即：$|k*G|=|G|^k$，而给了我们一组已知明文，求e就可以直接转换为求离散对数。但是这个离散对数怎么求很头疼，sage上面的许多dlp实现都不太行，直到看到Nu1l战队的writeup，发现了一个高效求离散对数的实现，调用sage上面gp库的离散对数，这是一个专门的数论库，sagemath集成了gp/PARI的接口。<a target="_blank" rel="noopener" href="https://math.mit.edu/~brubaker/PARI/PARIusers.pdf">GP接口参考</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">92916331959725072239888159454032910975918656644816711315436128106147081837990823</span></span><br><span class="line"><span class="comment"># factor(n)</span></span><br><span class="line"><span class="comment"># 425886199617876462796191899 * 434321947632744071481092243 * 502327221194518528553936039</span></span><br><span class="line">p,q,r=<span class="number">425886199617876462796191899</span> , <span class="number">434321947632744071481092243</span> , <span class="number">502327221194518528553936039</span></span><br><span class="line"><span class="comment"># discrete log</span></span><br><span class="line">y =<span class="number">1225348982571480649501200428324593233958863708041772597837722864848672736148168</span>^<span class="number">2</span>*<span class="number">2</span>%n</span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">e = <span class="built_in">int</span>(pari(<span class="string">f&quot;znlog(<span class="subst">&#123;<span class="built_in">int</span>(y)&#125;</span>,Mod(<span class="subst">&#123;<span class="built_in">int</span>(g)&#125;</span>,<span class="subst">&#123;<span class="built_in">int</span>(n)&#125;</span>))&quot;</span>))</span><br><span class="line"><span class="comment"># 96564183954285580248216944343172776827819893296479821021220123492652817873253</span></span><br></pre></td></tr></table></figure>
<p>求解脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">92916331959725072239888159454032910975918656644816711315436128106147081837990823</span></span><br><span class="line"></span><br><span class="line">HINT=(<span class="number">1225348982571480649501200428324593233958863708041772597837722864848672736148168</span>, <span class="number">1225348982571480649501200428324593233958863708041772597837722864848672736148168</span>)</span><br><span class="line"></span><br><span class="line">C=(<span class="number">44449540438169324776115009805536158060439126505148790545560105884100348391877176</span>, <span class="number">73284708680726118305136396988078557189299357177640330968917927635171441710392723</span>)</span><br><span class="line"></span><br><span class="line">y=(HINT[<span class="number">0</span>]**<span class="number">2</span>+HINT[<span class="number">1</span>]**<span class="number">2</span>)%n</span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">e = <span class="built_in">int</span>(pari(<span class="string">f&quot;znlog(<span class="subst">&#123;<span class="built_in">int</span>(y)&#125;</span>,Mod(<span class="subst">&#123;<span class="built_in">int</span>(g)&#125;</span>,<span class="subst">&#123;<span class="built_in">int</span>(n)&#125;</span>))&quot;</span>))</span><br><span class="line"><span class="comment"># factor(n)</span></span><br><span class="line"><span class="comment"># 425886199617876462796191899 * 434321947632744071481092243 * 502327221194518528553936039</span></span><br><span class="line">p,q,r=<span class="number">425886199617876462796191899</span> , <span class="number">434321947632744071481092243</span> , <span class="number">502327221194518528553936039</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">P1,P2</span>):</span></span><br><span class="line">    x1,y1=P1</span><br><span class="line">    x2,y2=P2</span><br><span class="line">    x3=(x1*x2-y1*y2)%n</span><br><span class="line">    y3=(x1*y2+x2*y1)%n</span><br><span class="line">    <span class="keyword">return</span> (x3,y3)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mul</span>(<span class="params">P,k</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> k&gt;=<span class="number">0</span></span><br><span class="line">    Q=(<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">while</span> k&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> k%<span class="number">2</span>:</span><br><span class="line">            k-=<span class="number">1</span></span><br><span class="line">            Q=add(P,Q)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            k//=<span class="number">2</span></span><br><span class="line">            P=add(P,P)</span><br><span class="line">    <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line">phi = (p*p-<span class="number">1</span>)*(q*q-<span class="number">1</span>)*(r*r-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">M = mul(C,d)</span><br><span class="line"><span class="keyword">assert</span> mul(M,e)==C</span><br><span class="line">print(long_to_bytes(M[<span class="number">0</span>])+long_to_bytes(M[<span class="number">1</span>]))</span><br><span class="line"><span class="comment"># 47f4f203afe894ddbb1bcf6368d901cf93990354dadbc5b7794e199d4f0b59cb</span></span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h2 id="2021-N1CTF-Crypto题解"><a href="#2021-N1CTF-Crypto题解" class="headerlink" title="2021 N1CTF Crypto题解"></a>2021 N1CTF Crypto题解</h2><p>N1CTF的赛题质量还是很高，和西湖同时间打的比赛，我看自闭了，checkin都没写出来，想到了copperSmith算p，方程也列出来了，但是我没去跑，还以为差些条件。官方题解和题目存储都在Nu1l的Github上面有存档。以下writeup会参考韩国战队<a target="_blank" rel="noopener" href="https://rkm0959.tistory.com/243">SupperGuesser的题解</a>，也是本次比赛的第一名。</p>
<p>&nbsp;</p>
<h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h3><p>本题参考了这篇writeup：<a target="_blank" rel="noopener" href="https://project-euphoria.dev/blog/26-n1ctf-2021/。">https://project-euphoria.dev/blog/26-n1ctf-2021/。</a></p>
<p>设<script type="math/tex">x=2021*p+1120*q \ mod\ n ，我们已知，h=x+x^{-1}，容易得到x^2−h*x+1≡0\ (\ mod\ n)</script>。</p>
<p>这里我们为了减少运行时间，需要把q的leading bits也算出一部分，已知p的高22位和n，我们可以算出q的高21位，第22位不确定是因为可能有进位。简单的计算方法就是：$q1=n//(p0&lt;<490),q0=q1>&gt;491$ 。这样我们已知p的高22位和q的高21位。从而我们将x做如下分解：</p>
<script type="math/tex; mode=display">x=2021*(p0*2^{490}+p1)+1120*(q0*2^{491}+q1)=(2021*p0*2^{490}+1120*q0*2^{491})+(2021*p1+1120*q1)</script><p>前半部分记为x0，后半部分记为x1，其中x0已知，x1未知，x1的数量级大概在2**500左右，令$f(x)=x^2-hx+1$，最高次为2，根$x1&lt;N^{1/2}$，那么我们可以用Coppersmith定理进行求解，但是需要注意epsilon值的设置，可以参考sage的<a target="_blank" rel="noopener" href="https://doc.sagemath.org/html/en/reference/polynomial_rings/sage/rings/polynomial/polynomial_modn_dense_ntl.html#sage.rings.polynomial.polynomial_modn_dense_ntl.small_roots">文档</a>。具体的联系我没有看论文，但是epsilon越小，解LLL的矩阵越大，耗时越长，得到解的概率越大。由X的bound的公式：</p>
<p>$X=ceil(\frac{1}{2}N^{β^2/δ−ϵ})$，由于N是1024比特，X的严格上界是2^505 (计算得的的解为2^502)，得到的epsilon应该小于0,009。由于是估算，可以稍微设置大一些，也能在多项式时间内得到解。这里设置epsilon为1/80可以得到解，只需要10min。</p>
<p>求解x1的代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CopperSmith</span>():</span></span><br><span class="line">    R = Zmod(n)</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(R)</span><br><span class="line">    _x = <span class="number">2021</span>*p0*<span class="number">2</span>^<span class="number">490</span> + <span class="number">1120</span>*q0*<span class="number">2</span>^<span class="number">491</span> + x</span><br><span class="line">    f = (_x^<span class="number">2</span> - _x*h + <span class="number">1</span>).monic()</span><br><span class="line">    <span class="comment"># [7279473437564993427256268527891542563557232159626049883951364173102121134158423609775502464752174435483615142675582269470774951285125088232851515513237]</span></span><br><span class="line">    <span class="comment"># time cost 726 s</span></span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^<span class="number">505</span>,epsilon=<span class="number">1</span>/<span class="number">80</span>)</span><br><span class="line">    print(roots)</span><br><span class="line">CopperSmith()</span><br></pre></td></tr></table></figure>
<p>得到x1之后，我们就得到了<script type="math/tex">x=2021p+1120q</script>的值，并且已知<script type="math/tex">2021p*1120q=2021*1120*n</script>，直接联立解方程即可分解n，这里用z3解，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">124592923216765837982528839202733339713655242872717311800329884147642320435241014134533341888832955643881019336863843062120984698416851559736918389766033534214383285754683751490292848191235308958825702189602212123282858416891155764271492033289942894367802529296453904254165606918649570613530838932164490341793</span></span><br><span class="line">c = <span class="number">119279592136391518960778700178474826421062018379899342254406783670889432182616590099071219538938202395671695005539485982613862823970622126945808954842683496637377151180225469409261800869161467402364879561554585345399947589618235872378329510108345004513054262809629917083343715270605155751457391599728436117833</span></span><br><span class="line">h = <span class="number">115812446451372389307840774747986196103012628652193338630796109042038320397499948364970459686079508388755154855414919871257982157430015224489195284512204803276307238226421244647463550637321174259849701618681565567468929295822889537962306471780258801529979716298619553323655541002084406217484482271693997457806</span></span><br><span class="line">p0 = <span class="number">4055618</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="comment"># x^2 -hx + 1 = 0 mod n</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    q1=n//(p0&lt;&lt;<span class="number">490</span>)</span><br><span class="line">    q0=q1&gt;&gt;<span class="number">491</span></span><br><span class="line">    x=<span class="number">7279473437564993427256268527891542563557232159626049883951364173102121134158423609775502464752174435483615142675582269470774951285125088232851515513237</span></span><br><span class="line">    S=Solver()</span><br><span class="line">    _p=BitVec(<span class="string">&#x27;_p&#x27;</span>,<span class="number">1080</span>)</span><br><span class="line">    _q=BitVec(<span class="string">&#x27;_q&#x27;</span>,<span class="number">1080</span>)</span><br><span class="line">    S.add((_p*_q)==(n*<span class="number">2021</span>*<span class="number">1120</span>))</span><br><span class="line">    S.add((_p+_q)==(<span class="number">1120</span>*q0*<span class="number">2</span>**<span class="number">491</span>+<span class="number">2021</span>*p0*<span class="number">2</span>**<span class="number">490</span>+x))</span><br><span class="line">    ans=S.check()</span><br><span class="line">    print(S.model())</span><br><span class="line">    p=S.model()[_p].as_long()//<span class="number">2021</span></span><br><span class="line">    q=S.model()[_q].as_long()//<span class="number">1120</span></span><br><span class="line">    <span class="keyword">assert</span> p*q==n</span><br><span class="line">    phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d=inverse(e,phi)</span><br><span class="line">    flag=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    print(long_to_bytes(flag))</span><br><span class="line">    <span class="comment"># n1ctf&#123;093fd4c4-5cc9-427e-98ef-5a04914c8b4e&#125;</span></span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="n1token1"><a href="#n1token1" class="headerlink" title="n1token1"></a>n1token1</h3><p>题目源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gettoken</span>(<span class="params">c</span>):</span></span><br><span class="line">    X = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> ((<span class="built_in">pow</span>(X, (p-<span class="number">1</span>)//<span class="number">2</span>, p)!=<span class="number">1</span>) <span class="keyword">or</span> (<span class="built_in">pow</span>(X, (q-<span class="number">1</span>)//<span class="number">2</span>, q)!=<span class="number">1</span>)):</span><br><span class="line">        X = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> X.bit_length() &lt; <span class="number">920</span>:</span><br><span class="line">            X *= random.choice(primes)</span><br><span class="line">    xp = <span class="built_in">pow</span>(X, (p + <span class="number">1</span>)//<span class="number">4</span>, p)</span><br><span class="line">    xq = <span class="built_in">pow</span>(X, (q + <span class="number">1</span>)//<span class="number">4</span>, q)</span><br><span class="line">    <span class="comment"># print(xp,xq)</span></span><br><span class="line">    print(xp**<span class="number">2</span>%p,xq**<span class="number">2</span>%q)</span><br><span class="line">    xp = random.choice([xp,-xp%p])</span><br><span class="line">    xq = random.choice([xq,-xq%q])</span><br><span class="line">    print(X)</span><br><span class="line">    x = c * (xp*inverse(q,p)*q + xq*inverse(p,q)*p) % n</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getmyPrime</span>(<span class="params">nbits</span>):</span></span><br><span class="line">    p = getPrime(nbits)</span><br><span class="line">    <span class="keyword">while</span>(p%<span class="number">4</span>==<span class="number">1</span>):</span><br><span class="line">        p = getPrime(nbits)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">primes = random.sample(sieve_base, <span class="number">920</span>)</span><br><span class="line">p = getmyPrime(<span class="number">512</span>)</span><br><span class="line">q = getmyPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e, n)</span><br><span class="line">gettoken(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># with open(&quot;output.txt&quot;, &quot;w&quot;)as f:</span></span><br><span class="line"><span class="comment">#     f.write(&quot;n = &quot; + str(n) + &quot;\n&quot;)</span></span><br><span class="line"><span class="comment">#     for i in range(920):</span></span><br><span class="line"><span class="comment">#         f.write(&quot;Token #&quot;+str(i+1)+&#x27;: &#x27;+str(gettoken(c))+&#x27;\n&#x27;)</span></span><br></pre></td></tr></table></figure>
<p>首先注意到：p，q都是模4余3的，$p=4k_1+3,q=4k_2+3$，这是后面取sqrt的条件。token产生的过程是关键，弄清楚结果x的表达式即可。</p>
<p>token产生：选择920个素数，从这920个素数产生刚好大于920比特的模p和模q的二次剩余X，即也是模n的二次剩余。那么显然有</p>
<script type="math/tex; mode=display">x_p^2=pow(X,(p+1)//4*2,p)=pow(X,(p-1)//2+1,p)=X \ mod\ p</script><script type="math/tex; mode=display">x_q^2=pow(X,(q+1)//4*2,p)=pow(X,(q-1)//2+1,q)=X \ mod \ q</script><p>即$x_p和x_q是X模p的1/2次和X模q的1/2次$，再者，由：</p>
<script type="math/tex; mode=display">x = c * (x_p*inverse(q,p)*q + x_q*inverse(p,q)*p) \ mod \ n=\ c* \sqrt{X} \ mod \ n</script><p>这就是最后的token在数学上的表示形式。更严格地说上式是：$+\sqrt{X}或者-\sqrt{X}$，那么：<script type="math/tex">x^2=c^2*X \ mod \ n</script>，SupperGuesser战队的writeup提出一个巧妙解法：HNP。为什么可以当成HNP问题来解呢？注意到X的比特数是稍微比920大一点，而n是1024比特，<strong>这意味着我们知道在模n意义下X的前100比特都是0</strong>。把上式换写一下：<script type="math/tex">c^{-2}*x^2=X \ mod \ n</script>。</p>
<p>其中$c^{-2}$就是HNP中需要求的秘密参数，而X我们已知其大概100位的MSB。这样就可以解HNP问题了，并且我们已知的MSB都是0，因此不再需要Babai算法求CVP了。直接LLL算法得到最短向量即可求解，当然需要除去一个特殊的最短格点（0,0…，1）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;/home/sage/Desktop/Extra Learning/CTF/比赛/N1CTF2021/crypto-n1-token1/output.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">n = <span class="built_in">int</span>(f.readline()[<span class="number">4</span>:])</span><br><span class="line">tokens = [<span class="built_in">int</span>(f.readline().split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">920</span>)]</span><br><span class="line">x2 = [<span class="built_in">pow</span>(x, <span class="number">2</span>, n) <span class="keyword">for</span> x <span class="keyword">in</span> tokens]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_basis</span>(<span class="params">oracle_inputs,p,d=<span class="number">30</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Returns a basis using the HNP game parameters and inputs to our oracle</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    basis_vectors = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">        p_vector = [<span class="number">0</span>] * (d+<span class="number">1</span>)</span><br><span class="line">        p_vector[i] = p</span><br><span class="line">        basis_vectors.append(p_vector)</span><br><span class="line">    basis_vectors.append(<span class="built_in">list</span>(oracle_inputs) + [QQ(<span class="number">1</span>)/QQ(p)])</span><br><span class="line">    <span class="keyword">return</span> Matrix(QQ, basis_vectors)</span><br><span class="line"></span><br><span class="line">M = build_basis(x2[:<span class="number">50</span>],n,<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">T = M.LLL()</span><br><span class="line"> </span><br><span class="line">c2inv=T[<span class="number">1</span>][-<span class="number">1</span>]*n%n</span><br><span class="line">c2=inverse(c2inv, n)</span><br><span class="line">print(c2)</span><br><span class="line"><span class="comment"># 45826812852445545573935979277992443457076371872089648644915475778319093098825670699151487782654163657210516482531915639455166133358119343973980849423144111072114848219032243215219360482938562035117641611780636775341778802057146053472950017702818869239750207365020007621660815809140827723451995480125236607450</span></span><br></pre></td></tr></table></figure>
<p>现在的问题是如何求解c的RSA加密，貌似没有显示地给出其他信息，所以我们再研究一下x的产生过程，它用到了额外的p，q信息，因为任意X的二次剩余有四个（在模n=p*q意义下），不妨记为：x，y，n-x，n-y。如果我们恰好已知的是两个非加法逆的x，y，那么：$x^2-y^2=0 \ mod \ n$，即（x+y)(x-y)|n，此时 x+y 和 x-y 都不是 n 的倍数，而 (x+y)(x-y) 却是 n 的倍数，说明 x+y 和 x-y 中分别包含一个 n 的真因数。此时计算 gcd(n, x+y) 即可得到 n 的一个真因数。这样就分解了n。</p>
<p>但是我们不能直接求出c或者<script type="math/tex">\sqrt{X}</script>，已知条件是<script type="math/tex">x =\ c* \sqrt{X} \ mod \ n</script>、x、X和$c^2$。注意到X的产生，他们都是由sievebase中的920个素数产生的。</p>
<p>sievebase的长度是10000，所以我们可以直接遍历把这920个素因子求出来，同时我们知道每个X，可以求出对应素因子的次数<script type="math/tex">e_i</script>。我们就可以考虑用这920个token组合使得L个X相乘恰好是一个完全平方数，即<script type="math/tex">\prod_{i=1}^LX_i=\prod_{i=1}^{920}p_i^{2y}</script>。如此：</p>
<p><script type="math/tex">\prod_{i=1}^Lt^2=c^L*\sqrt{\prod_{i=1}^LX_i}*\sqrt{1}</script>，其中<script type="math/tex">\sqrt{\prod_{i=1}^LX_i}</script>可以直接由完全平方数开方得到，我们可以直接求nthroot，由于在生成的过程中还乘了模n意义下1的二次剩余$\sqrt1$，因此我们还有可能得到另外一个$x^2=1 \ mod \ n $的解，如果我们得到该解，就可以进行n的分解。</p>
<p>再考虑L的奇偶性：</p>
<ul>
<li>L是偶数：那么我们可以由$C^2$计算出$C^L$,这样就可以得到$x^2=1 \ mod \ n $的一个解sqrt1，如果恰好这个解不等于1或则-1，我们就可以分解N。分解N之后其实就可以全部解c，解一次Rabin，再解一次RSA，找出有意义的解即可。</li>
<li>L是奇数：我们可以得到：$C*\sqrt{1}$。如果恰好是1或者-1，我们就能得到C。</li>
</ul>
<p>那么如何选出合适的token使得<script type="math/tex">\prod_{i=1}^LX_i</script>是一个完全平方数？构造矩阵M,920*920。其中<script type="math/tex">M[i][j]</script>代表第i个token的primes[j]的次数。这样我们发现矩阵M的右核空间（right_kernel），即满足<script type="math/tex">MX=0 \ \ on \ \  ring \ \ GF(2)</script>。</p>
<p>取右核空间内的向量，取对应的token，就满足<script type="math/tex">\prod_{i=1}^LX_i</script>是完全平方数了，经过计算得到M的右核空间维数恰好是2，并且其中1的个数恰好一奇一偶，即L一奇一偶（实际经过上面的讨论只需要有偶数L就可以解）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;/home/sage/Desktop/Extra Learning/CTF/比赛/N1CTF2021/crypto-n1-token1/output.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="comment"># f=open(&quot;./output.txt&quot;,&quot;r&quot;)</span></span><br><span class="line">n = <span class="built_in">int</span>(f.readline()[<span class="number">4</span>:])</span><br><span class="line">tokens = [<span class="built_in">int</span>(f.readline().split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">920</span>)]</span><br><span class="line">x2 = [power_mod(x, <span class="number">2</span>, n) <span class="keyword">for</span> x <span class="keyword">in</span> tokens]</span><br><span class="line">c2=<span class="number">45826812852445545573935979277992443457076371872089648644915475778319093098825670699151487782654163657210516482531915639455166133358119343973980849423144111072114848219032243215219360482938562035117641611780636775341778802057146053472950017702818869239750207365020007621660815809140827723451995480125236607450</span></span><br><span class="line">c2inv = <span class="number">52983076548811446642078416561526103296256117483454486324354864860934507167817419284299797979785979560318778718382121118437029467788929084290109421055494194638653398930615132561955251638059730256502250470596999508030459148548384745026728889238876530368915312995370308785841757845456662731412090368303339076885</span></span><br><span class="line">X = [v * c2inv % n <span class="keyword">for</span> v <span class="keyword">in</span> x2]</span><br><span class="line"></span><br><span class="line">primes = []</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> sieve_base:</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> X:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(x) % p == <span class="number">0</span>:</span><br><span class="line">            primes.append(p)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(<span class="built_in">len</span>(primes))</span><br><span class="line"></span><br><span class="line">SZ = <span class="number">920</span></span><br><span class="line">mat = [[<span class="number">0</span>] * SZ <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(SZ)]</span><br><span class="line"><span class="comment"># mat[i][j] : number of factor primes[i] in X[j]</span></span><br><span class="line"><span class="comment"># token，prime矩阵构造</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">920</span>):</span><br><span class="line">    v = <span class="built_in">int</span>(X[i])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">920</span>):</span><br><span class="line">        <span class="keyword">while</span> v % primes[j] == <span class="number">0</span>:</span><br><span class="line">            v //= primes[j]</span><br><span class="line">            mat[j][i] += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">M = Matrix(GF(<span class="number">2</span>), mat)</span><br><span class="line">basis_ = M.right_kernel().basis()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Part 1 : find c</span></span><br><span class="line">xmult = Integer(<span class="number">1</span>)</span><br><span class="line">Xmult = Integer(<span class="number">1</span>)</span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">920</span>):</span><br><span class="line">    cc = basis_[<span class="number">0</span>][i]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(cc) == <span class="number">1</span>:</span><br><span class="line">        xmult = xmult * Integer(tokens[i])</span><br><span class="line">        Xmult = Xmult * Integer(X[i])</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># basis_[0]这个向量1的个数是奇数个，cnt即L</span></span><br><span class="line">print(cnt)</span><br><span class="line">v = Xmult.nth_root(<span class="number">2</span>, truncate_mode=<span class="literal">True</span>)[<span class="number">0</span>]</span><br><span class="line">xmult = xmult % n </span><br><span class="line">c_cnt = (xmult * inverse(<span class="built_in">int</span>(v % n), n)) % n </span><br><span class="line"><span class="comment"># c * sqrt(1) mod n</span></span><br><span class="line">c = (c_cnt * inverse(power_mod(c2, (cnt - <span class="number">1</span>) // <span class="number">2</span>, n), n)) % n </span><br><span class="line"></span><br><span class="line"><span class="comment"># Part 2 : find some sqrt of 1</span></span><br><span class="line">xmult = Integer(<span class="number">1</span>)</span><br><span class="line">Xmult = Integer(<span class="number">1</span>)</span><br><span class="line"> </span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">920</span>):</span><br><span class="line">    cc = basis_[<span class="number">1</span>][i]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(cc) == <span class="number">1</span>:</span><br><span class="line">        xmult = xmult * Integer(tokens[i])</span><br><span class="line">        Xmult = Xmult * Integer(X[i])</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">print(cnt)</span><br><span class="line">v = Xmult.nth_root(<span class="number">2</span>, truncate_mode=<span class="literal">True</span>)[<span class="number">0</span>]</span><br><span class="line">xmult = xmult % n </span><br><span class="line">c_cnt = (xmult * inverse(<span class="built_in">int</span>(v % n), n)) % n </span><br><span class="line"><span class="comment"># sqrt(1)中一个不是1和-1的值，可以分解n</span></span><br><span class="line">sq1 = (c_cnt * inverse(power_mod(c2, cnt // <span class="number">2</span>, n), n)) % n </span><br><span class="line"></span><br><span class="line">print(n)</span><br><span class="line">p = GCD(sq1+<span class="number">1</span>, n)</span><br><span class="line">q = GCD(sq1-<span class="number">1</span>, n)</span><br><span class="line"><span class="keyword">assert</span> p != <span class="number">1</span> <span class="keyword">and</span> q != <span class="number">1</span> <span class="keyword">and</span> p * q == n</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> u <span class="keyword">in</span> [<span class="number">1</span>, -<span class="number">1</span>]:</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> [<span class="number">1</span>, -<span class="number">1</span>]:</span><br><span class="line">        <span class="comment"># sqrt(1)的四个值乘以可能的c*sqrt(1),其中有一个是c</span></span><br><span class="line">        cc = crt(u, v, p, q)</span><br><span class="line">        c_real = (c * cc) % n</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        d = inverse(<span class="number">65537</span>, phi)</span><br><span class="line">        print(long_to_bytes(power_mod(c_real, d, n)))</span><br><span class="line"><span class="comment"># n1ctf&#123;b9e7d419-0df8-438a-9120-efdf3ddf155f&#125;</span></span><br><span class="line"><span class="comment"># 改自writeup https://rkm0959.tistory.com/243</span></span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="n1token2"><a href="#n1token2" class="headerlink" title="n1token2"></a>n1token2</h3><p>参考官方的writeup。</p>
<p>源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> FLAG.startswith(<span class="string">&#x27;n1ctf&#123;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> FLAG.endswith(<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">SECRET = <span class="built_in">bytes</span>.fromhex(FLAG[<span class="number">6</span>:-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(SECRET) == <span class="number">16</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">251</span></span><br><span class="line"> </span><br><span class="line">e = [<span class="number">1</span>, <span class="number">20</span>, <span class="number">113</span>, <span class="number">149</span>, <span class="number">219</span>]</span><br><span class="line"></span><br><span class="line">y = <span class="string">b&#x27;&#x27;</span> </span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, p):</span><br><span class="line">    coeff = [random.choice(e)] + <span class="built_in">list</span>(SECRET)</span><br><span class="line">    y += <span class="built_in">bytes</span>([<span class="built_in">sum</span>(c * <span class="built_in">pow</span>(x, i, p) <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(coeff)) % p])</span><br><span class="line">    </span><br><span class="line">print(<span class="string">f&#x27;Token: <span class="subst">&#123;y.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>已知的token值是<script type="math/tex">y(x) = e + c_0 \cdot x + c_1 \cdot x^2 + c_2 \cdot x^3 + ... + c_{15} \cdot x^{16} \pmod{p}</script>，其中x取1到p-1的值。很自然地我们想到解线性方程组。但是问题在于e是随机的，有五个值。令<script type="math/tex">f(x) = c_{0} + c_{1} \cdot x + c_{2} \cdot x^2 + c_{3} \cdot x^3 + \cdots + c_{15} \cdot x^{15}\pmod{p}</script> 上面的方程可以改写为 <script type="math/tex">f(x)-(y(x)-e)/x \equiv 0 \pmod{p}</script>​。令$k[i] = (y(x)-e[i])/x$, 因此必定有一个i使得， $f(x)-k[i] \equiv 0 \pmod{p}$ 成立。</p>
<p>那么多项式<script type="math/tex">F = (f(x)-k[0])(f(x)-k[1])(f(x)-k[2])(f(x)-k[3])(f(x)-k[4])\equiv 0 \pmod{p}</script>恒成立。展开：</p>
<p><script type="math/tex">F[5]*f^5(x)+F[4]*f^(x)+F[3]*f^(x)+F[2]*f^2(x)+F[1]*f^1(x) \equiv -F[0] \pmod{p}</script> 。  其中$(f(x))^i$, 是15次多项式， 这5个多项式的总未知系数是 76+61+46+31+16=230 ， 我们有 250 个 tokens, 解线性方程即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">251</span></span><br><span class="line">y = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;1d85d235d08dfa0f0593b1cfd41d3c98f2a542b2bf7a614c5d22ea787e326b4fd37cd6f68634d9bdf5f618605308d4bb16cb9b9190c0cb526e9b09533f19698b9be89b2e88ba00e80e44d6039d3c15555d780a6a2dbd14d8e57f1252334f16daef316ca692c02485684faee279d7bd926501c0872d01e62bc4d8baf55789b541358dfaa06d11528748534103a80c699a983c385e494a8612f4f124bd0b2747277182cec061c68197c5b105a22d9354be9e436c8393e3d2825e94f986a18bd6df9ab134168297c2e79eee5dc6ef15386b96b408b319f53b66c6e55b3b7d1a2a2930e9d34287b74799a59ab3f56a31ae3e9ffa73362e28f5751f79&#x27;</span>)</span><br><span class="line">e = [<span class="number">1</span>, <span class="number">20</span>, <span class="number">113</span>, <span class="number">149</span>, <span class="number">219</span>]</span><br><span class="line"></span><br><span class="line">A = matrix(GF(p),<span class="number">250</span>,<span class="number">230</span>)</span><br><span class="line">b = vector(GF(p),<span class="number">250</span>)</span><br><span class="line">PR.&lt;f&gt; = PolynomialRing(GF(p))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">250</span>):</span><br><span class="line">    F = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        F = F*(f-GF(p)((y[i]-e[j])/(i+<span class="number">1</span>)))</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">76</span>):</span><br><span class="line">        A[i,j] = F[<span class="number">5</span>]*<span class="built_in">pow</span>(i+<span class="number">1</span>,j,p)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">61</span>):</span><br><span class="line">        A[i,j+<span class="number">76</span>] = F[<span class="number">4</span>]*<span class="built_in">pow</span>(i+<span class="number">1</span>,j,p)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">46</span>):</span><br><span class="line">        A[i,j+<span class="number">137</span>] = F[<span class="number">3</span>]*<span class="built_in">pow</span>(i+<span class="number">1</span>,j,p)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">        A[i,j+<span class="number">183</span>] = F[<span class="number">2</span>]*<span class="built_in">pow</span>(i+<span class="number">1</span>,j,p)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        A[i,j+<span class="number">214</span>] = F[<span class="number">1</span>]*<span class="built_in">pow</span>(i+<span class="number">1</span>,j,p)</span><br><span class="line">    b[i] = -F[<span class="number">0</span>]</span><br><span class="line">res = A.solve_right(b)</span><br><span class="line">flag = <span class="string">&#x27;n1ctf&#123;&#x27;</span> + <span class="built_in">bytes</span>(res[<span class="number">214</span>:]).<span class="built_in">hex</span>() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="n1login"><a href="#n1login" class="headerlink" title="n1login"></a>n1login</h3><p>一个侧信道的攻击，参考官方wp：<a target="_blank" rel="noopener" href="https://github.com/Nu1LCTF/n1ctf-2021/tree/main/Crypto/n1ogin">n1login</a></p>
<p>&nbsp;</p>
<h2 id="2021-KQCTF-crypto题解"><a href="#2021-KQCTF-crypto题解" class="headerlink" title="2021 KQCTF crypto题解"></a>2021 KQCTF crypto题解</h2><p>赛题不是特别难，但是有两道比较有意思的题。一个是NTRU格密码，一个是多项式多点快速求值。题目存库于repo。</p>
<p>&nbsp;</p>
<h3 id="Polynomialtime"><a href="#Polynomialtime" class="headerlink" title="Polynomialtime"></a>Polynomialtime</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">interpolate</span>(<span class="params">l</span>):</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        x = random.getrandbits(<span class="number">32</span>*<span class="number">2</span>**<span class="number">4</span>)</span><br><span class="line">        print(x)</span><br><span class="line">    mo = random.getrandbits(<span class="number">32</span>*<span class="number">2</span>**<span class="number">4</span>)</span><br><span class="line">    FR.&lt;x&gt; = PolynomialRing(IntegerModRing(mo))</span><br><span class="line">    f = prod([(random.getrandbits(<span class="number">32</span>*<span class="number">2</span>**<span class="number">4</span>)*x-<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,l)])</span><br><span class="line">    <span class="keyword">return</span> f, mo</span><br><span class="line"></span><br><span class="line"><span class="comment">#hmm, maybe a bit slow</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">evaluate</span>(<span class="params">poly, points, mo</span>):</span></span><br><span class="line">    evaluations = []</span><br><span class="line">    <span class="keyword">for</span> point <span class="keyword">in</span> points:</span><br><span class="line">        evaluations.append(poly(point))</span><br><span class="line">    <span class="keyword">return</span> evaluations</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = f.read()</span><br><span class="line">    </span><br><span class="line">    size = <span class="number">1048576</span></span><br><span class="line">    poly, mo = interpolate(size)</span><br><span class="line">    R = Integers(mo)</span><br><span class="line">    points = [R(random.getrandbits(<span class="number">32</span>*<span class="number">2</span>**<span class="number">4</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(size)]</span><br><span class="line">    ans = <span class="built_in">bytearray</span>.fromhex(<span class="built_in">hex</span>(prod(evaluate(poly,points,mo)))[<span class="number">2</span>:-<span class="number">10</span>])</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ciphertext = <span class="built_in">bytearray</span>(<span class="string">b&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(flag):</span><br><span class="line">        ciphertext.append(<span class="built_in">ord</span>(c)^^ans[i])</span><br><span class="line">    </span><br><span class="line">    print(ciphertext)</span><br></pre></td></tr></table></figure>
<p>解题流程很容易理清，先需要恢复一个MT19937的PRNG，这个可以直接用<code>mt19937predictor</code>库进行。恢复后我们需要计算次数高达1048576次的多项式的100多万个点，这个计算量相当大。因此我们需要做优化。考虑用递归分治的算法进行求解，感觉这像是一个OI题，可以参考OI的wiki：<a target="_blank" rel="noopener" href="https://oi-wiki.org/math/poly/multipoint-eval-interpolation/">多项式多点快速求值</a>。sagemath脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> mt19937predictor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">mt=mt19937predictor.MT19937Predictor()</span><br><span class="line"></span><br><span class="line">data=<span class="built_in">open</span>(<span class="string">&quot;./outputpt.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">evaluate</span>(<span class="params">roots, points, mo</span>):</span></span><br><span class="line">    evaluations = []</span><br><span class="line">    <span class="keyword">for</span> point <span class="keyword">in</span> points:</span><br><span class="line">        evaluations.append(prod([ (root*point-<span class="number">1</span>) <span class="keyword">for</span> root <span class="keyword">in</span> roots]))</span><br><span class="line">        print(<span class="string">&quot;one point&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> evaluations</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fast_cacl</span>(<span class="params">f,points,mo</span>):</span></span><br><span class="line">    FR.&lt;x&gt; = PolynomialRing(IntegerModRing(mo))</span><br><span class="line">    p_len=<span class="built_in">len</span>(points)</span><br><span class="line">    <span class="keyword">if</span> p_len==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> [f(points[<span class="number">0</span>])]</span><br><span class="line">    f0=prod([(x-point) <span class="keyword">for</span> point <span class="keyword">in</span> points[:p_len//<span class="number">2</span>]])</span><br><span class="line">    f1=prod([(x-point) <span class="keyword">for</span> point <span class="keyword">in</span> points[p_len//<span class="number">2</span>:]])</span><br><span class="line">    right_res=fast_cacl(f%f0,points[:p_len//<span class="number">2</span>],mo)</span><br><span class="line">    left_res=fast_cacl(f%f1,points[p_len//<span class="number">2</span>:],mo)</span><br><span class="line">    <span class="keyword">return</span> right_res+left_res</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment"># recover prng state</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    mt.setrandbits(<span class="built_in">int</span>(data[i]),<span class="number">32</span>*<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;[+] recovered prng&quot;</span>)</span><br><span class="line">size = <span class="number">1048576</span></span><br><span class="line">mo = mt.getrandbits(<span class="number">32</span>*<span class="number">2</span>**<span class="number">4</span>)</span><br><span class="line">FR.&lt;x&gt; = PolynomialRing(IntegerModRing(mo))</span><br><span class="line">R = Integers(mo)</span><br><span class="line">f = prod([(mt.getrandbits(<span class="number">32</span>*<span class="number">2</span>**<span class="number">4</span>)*x-<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,size)])</span><br><span class="line">print(<span class="string">&quot;[+] Poly constructed!&quot;</span>)</span><br><span class="line"></span><br><span class="line">points = [R(mt.getrandbits(<span class="number">32</span>*<span class="number">2</span>**<span class="number">4</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(size)]</span><br><span class="line">print(<span class="string">&quot;[+] Points generated!&quot;</span>)</span><br><span class="line"></span><br><span class="line">temp_res=prod(fast_cacl(f,points,mo))</span><br><span class="line">print(<span class="string">&quot;[+] recover final result &quot;</span>,temp_res)</span><br><span class="line"></span><br><span class="line">ans = <span class="built_in">bytearray</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(temp_res))[<span class="number">2</span>:-<span class="number">10</span>])    </span><br><span class="line">print(<span class="string">&quot;[+] recover key stream &quot;</span>)</span><br><span class="line">print(ans)</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="built_in">bytearray</span>(<span class="string">b&quot;/\xbe\x9f\x83\x8a\x9eY\xb43\x9f\xfa\xc2\x98\xe9@K\xd7r\xd7j\xde\xd5\xef,\xda\x11\x1as\x83k\x10\xb8\xaaP\x7f \xb6|\xe02\x0fr\x0b\xf8\x9c\xfep2&quot;</span>)</span><br><span class="line">flag=<span class="built_in">bytearray</span>(<span class="string">b&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphertext):</span><br><span class="line">    flag.append(c^^ans[i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="KQRUEncrypt"><a href="#KQRUEncrypt" class="headerlink" title="KQRUEncrypt"></a>KQRUEncrypt</h3><p>一个NTRU格密码，可以直接参考：<a target="_blank" rel="noopener" href="https://latticehacks.cr.yp.to/ntru.html">https://latticehacks.cr.yp.to/ntru.html</a></p>
<p>主要记录一下源码和脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">Zx.&lt;x&gt; = ZZ[]</span><br><span class="line">d = <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cyclicconvolution</span>(<span class="params">f,g</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (f * g) % (x^n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">balancedmod</span>(<span class="params">f,q</span>):</span></span><br><span class="line">    g = <span class="built_in">list</span>( ((f[i] + q//<span class="number">2</span>) % q) - q//<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n) )</span><br><span class="line">    <span class="keyword">return</span> Zx(g)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rpoly</span>():</span></span><br><span class="line">    <span class="keyword">assert</span> d &lt;= n</span><br><span class="line">    result = n*[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                r = randrange(n)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> result[r]: <span class="keyword">break</span></span><br><span class="line">        result[r] = <span class="number">1</span>-<span class="number">2</span>*randrange(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> Zx(result)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invertmodprime</span>(<span class="params">f,p</span>):</span></span><br><span class="line">    T = Zx.change_ring(Integers(p)).quotient(x^n-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> Zx(lift(<span class="number">1</span> / T(f)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invertmodpowerof2</span>(<span class="params">f,q</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> q.is_power_of(<span class="number">2</span>)</span><br><span class="line">    g = invertmodprime(f,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = balancedmod(cyclicconvolution(g,f),q)</span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>: <span class="keyword">return</span> g</span><br><span class="line">        g = balancedmod(cyclicconvolution(g,<span class="number">2</span> - r),q)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keypair</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = rpoly()</span><br><span class="line">            fp = invertmodprime(f, p)</span><br><span class="line">            fq = invertmodpowerof2(f, q)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    g = rpoly()</span><br><span class="line">    publickey = balancedmod(p * cyclicconvolution(fq, g), q)</span><br><span class="line">    secretkey = (f, fp)</span><br><span class="line">    <span class="keyword">return</span> (publickey, secretkey)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">message, publickey</span>):</span></span><br><span class="line">    r = rpoly()</span><br><span class="line">    <span class="keyword">return</span> balancedmod(cyclicconvolution(publickey, r) + message, q)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">cipher,f,fp</span>):</span></span><br><span class="line">    <span class="comment"># cipher=Zx(cipher)</span></span><br><span class="line">    a=balancedmod(cyclicconvolution(f, cipher), q)</span><br><span class="line">    m=balancedmod(cyclicconvolution(fp, a),p)</span><br><span class="line">    bin_str=<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> m.coefficients(sparse=<span class="literal">False</span>)])</span><br><span class="line">    <span class="keyword">while</span> <span class="string">&#x27;-1&#x27;</span> <span class="keyword">in</span> bin_str:</span><br><span class="line">        bin_str=bin_str.replace(<span class="string">&#x27;-1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    flag=<span class="built_in">int</span>(bin_str,<span class="number">2</span>)</span><br><span class="line">    print(long_to_bytes(flag))</span><br><span class="line">    flag=<span class="built_in">int</span>(bin_str[::-<span class="number">1</span>],<span class="number">2</span>)</span><br><span class="line">    print(long_to_bytes(flag))</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genMessage</span>(<span class="params">message</span>):</span></span><br><span class="line">    m = Zx([</span><br><span class="line">        (<span class="number">1</span> <span class="keyword">if</span> random.random() &lt;= <span class="number">0.5</span> <span class="keyword">else</span> -<span class="number">1</span>)*<span class="built_in">int</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">format</span>(<span class="built_in">ord</span>(x), <span class="string">&#x27;b&#x27;</span>).zfill(<span class="number">8</span>) <span class="keyword">for</span> x <span class="keyword">in</span> message)</span><br><span class="line">    ])</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="comment"># hx public key</span></span><br><span class="line"><span class="comment"># ex secret key</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">LLL_ATTACK</span>(<span class="params">hx,r=<span class="number">0</span></span>):</span></span><br><span class="line">    N =<span class="number">161</span></span><br><span class="line">    p =<span class="number">3</span></span><br><span class="line">    q =<span class="number">128</span></span><br><span class="line">    p_dq=<span class="number">43</span></span><br><span class="line">    Q.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">    P.&lt;y&gt; = Zmod(p)[] </span><br><span class="line">    print(<span class="string">&#x27;-------decrypt------&#x27;</span>)</span><br><span class="line">    qq = x^N-<span class="number">1</span></span><br><span class="line">    pp = y^N-<span class="number">1</span></span><br><span class="line">    hn = [(<span class="built_in">int</span>(x)*p_dq+q//<span class="number">2</span>)%q-q//<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> hx]</span><br><span class="line">    n = <span class="built_in">len</span>(hn)</span><br><span class="line">    A1 = matrix.identity(n)*q</span><br><span class="line">    A0 = matrix.zero(n)</span><br><span class="line">    Aq = matrix.identity(n)</span><br><span class="line">    Ah = matrix(ZZ, [hn[-i:] + hn[:-i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">    M = block_matrix([A1,Ah,A0,Aq],nrows=<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># hn = [(int(x)*p_dq+q//2)%q-q//2 for x in hx]</span></span><br><span class="line">    <span class="comment"># n = len(hn)</span></span><br><span class="line">    <span class="comment"># A1 = matrix.identity(n)*q</span></span><br><span class="line">    <span class="comment"># A0 = matrix.zero(n)</span></span><br><span class="line">    <span class="comment"># Aq = matrix.identity(n)</span></span><br><span class="line">    <span class="comment"># Ah = matrix(ZZ, [hn[-i:] + hn[:-i] for i in range(n)])</span></span><br><span class="line">    <span class="comment"># M = block_matrix([A1,Ah,A0,Aq],nrows=2)</span></span><br><span class="line">    <span class="comment"># L = M.transpose().LLL()</span></span><br><span class="line">    <span class="comment"># for i in range(r):</span></span><br><span class="line">    <span class="comment">#     for j in range(2*n):</span></span><br><span class="line">    <span class="comment">#         M[j,n+i]=M[j,n+i]*10</span></span><br><span class="line">    <span class="comment"># print(M[0])</span></span><br><span class="line">    <span class="comment"># L = M.LLL()</span></span><br><span class="line">    L = M.transpose().LLL()</span><br><span class="line">    <span class="comment"># L=M.BKZ()</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        v=<span class="built_in">list</span>(L[i])</span><br><span class="line">        <span class="keyword">if</span> v.count(<span class="number">1</span>)+v.count(-<span class="number">1</span>)==<span class="number">14</span>:</span><br><span class="line">            print(v[:n])</span><br><span class="line">            print(v[n:])</span><br><span class="line">            print(<span class="string">&quot;valid&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># v=list(L[0])</span></span><br><span class="line">    <span class="comment"># print(v[:n])</span></span><br><span class="line">    <span class="comment"># print(v[n:])</span></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attack</span>(<span class="params">publickey</span>):</span></span><br><span class="line">    recip3 = lift(<span class="number">1</span>/Integers(q)(<span class="number">3</span>))</span><br><span class="line">    publickeyover3 = balancedmod(recip3 * publickey, q)</span><br><span class="line">    M = matrix(<span class="number">2</span> * n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        M[i, i] = q</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        M[i+n, i+n] = <span class="number">1</span></span><br><span class="line">        c = convolution(<span class="built_in">list</span>(x ^ i), <span class="built_in">list</span>(publickeyover3))</span><br><span class="line">        <span class="comment"># c.reverse()</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            M[i+n, j] = c[j]</span><br><span class="line">    M = M.LLL()</span><br><span class="line">    print(M[<span class="number">0</span>])</span><br><span class="line">    print(M[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>*n):</span><br><span class="line">        v=<span class="built_in">list</span>(M[i])</span><br><span class="line">        <span class="keyword">if</span> v.count(<span class="number">1</span>)+v.count(-<span class="number">1</span>)==<span class="number">14</span>:</span><br><span class="line">            print(<span class="string">&quot;valid&quot;</span>)</span><br><span class="line">            print(v)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> * n):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = Zx(<span class="built_in">list</span>(M[j][n:]))</span><br><span class="line">            f3 = invertmodprime(f, <span class="number">3</span>)</span><br><span class="line">            <span class="keyword">return</span> (f, f3)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> (f, f)</span><br><span class="line"></span><br><span class="line">n = <span class="number">161</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># with open(&quot;flag.txt&quot;,&quot;r&quot;) as f:</span></span><br><span class="line"><span class="comment">#     m = genMessage(f.readline())</span></span><br><span class="line">m = genMessage(<span class="string">&quot;f&quot;</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">(publickey, secretkey) = keypair()</span><br><span class="line">c = encrypt(m, publickey)</span><br><span class="line">r_m=decrypt(c,secretkey[<span class="number">0</span>],secretkey[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;secret key f&quot;</span>,secretkey[<span class="number">0</span>])</span><br><span class="line">print(<span class="string">&quot;secret key fp&quot;</span>,secretkey[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># hx = [43, -62, -28, 60, -54, -36, 53, -21, 19, 24, 33, 22, 12, 11, -11, -4, -16, -53, -20, -10, 9, 24, -14, 50, 51, 34, -10, -46, 21, -36, -30, 13, -57, -38, 40, 62, 6, -63, 59, -34, 8, -18, 26, 56, -36, 23, 19, -59, 10, 48, 41, -33, 5, -57, -13, 5, 46, 23, -49, 10, -19, 35, -20, 26, -37, -54, 16, 46, 11, 38, -22, 17, -6, -8, -38, -34, 50, 48, -48, -52, -47, -58, -35, 7, 8, -48, -59, -17, -9, -32, 46, -38, -22, -54, -43, -43, -21, 24, -55, 44, -56, -58, -37, 55, -42, -1, 4, 6, -47, -56, -52, 26, 41, 53, 48, 44, -9, -21, 59, -20, -41, 27, 60, 30, -52, -18, -23, 9, -6, -49, -37, -44, 22, 32, 51, -29, -8, 5, 60, -16, 20, -24, -17, 63, 53, 58, -9, 48, -19, 45, 7, -30, -36, 10, 48, -33, 25, 6, -62, 58, -57]</span></span><br><span class="line"><span class="comment"># hx.reverse()</span></span><br><span class="line"><span class="comment"># LLL_ATTACK(hx)</span></span><br><span class="line">hx=<span class="built_in">list</span>(publickey)</span><br><span class="line">print(<span class="built_in">len</span>(hx))</span><br><span class="line">hx.reverse()</span><br><span class="line">LLL_ATTACK(<span class="built_in">list</span>(publickey))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage </span></span><br><span class="line"><span class="comment">#多项式</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">N =<span class="number">161</span></span><br><span class="line">p =<span class="number">3</span></span><br><span class="line">q =<span class="number">128</span></span><br><span class="line">Q.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">P.&lt;y&gt; = Zmod(p)[]</span><br><span class="line">Zx.&lt;z&gt; = ZZ[]</span><br><span class="line"></span><br><span class="line">cipher = [-<span class="number">3</span>, -<span class="number">34</span>, -<span class="number">33</span>, -<span class="number">31</span>, <span class="number">59</span>, <span class="number">34</span>, <span class="number">50</span>, -<span class="number">56</span>, -<span class="number">46</span>, <span class="number">0</span>, -<span class="number">19</span>, <span class="number">6</span>, <span class="number">55</span>, <span class="number">18</span>, -<span class="number">20</span>, <span class="number">2</span>, <span class="number">57</span>, -<span class="number">36</span>, -<span class="number">61</span>, <span class="number">32</span>, -<span class="number">33</span>, <span class="number">13</span>, -<span class="number">27</span>, -<span class="number">25</span>, -<span class="number">29</span>, <span class="number">5</span>, <span class="number">36</span>, -<span class="number">37</span>, <span class="number">11</span>, -<span class="number">19</span>, -<span class="number">10</span>, -<span class="number">15</span>, -<span class="number">7</span>, -<span class="number">8</span>, <span class="number">63</span>, <span class="number">21</span>, <span class="number">51</span>, -<span class="number">30</span>, -<span class="number">64</span>, -<span class="number">15</span>, -<span class="number">54</span>, -<span class="number">28</span>, -<span class="number">23</span>, -<span class="number">6</span>, -<span class="number">28</span>, <span class="number">35</span>, <span class="number">21</span>, -<span class="number">24</span>, -<span class="number">11</span>, <span class="number">62</span>, <span class="number">21</span>, <span class="number">51</span>, -<span class="number">4</span>, -<span class="number">11</span>, -<span class="number">21</span>, -<span class="number">10</span>, <span class="number">60</span>, -<span class="number">53</span>, -<span class="number">28</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">36</span>, <span class="number">9</span>, <span class="number">44</span>, -<span class="number">19</span>, -<span class="number">53</span>, -<span class="number">57</span>, <span class="number">28</span>, -<span class="number">15</span>, <span class="number">33</span>, <span class="number">58</span>, -<span class="number">10</span>, <span class="number">32</span>, <span class="number">25</span>, <span class="number">46</span>, <span class="number">2</span>, -<span class="number">11</span>, -<span class="number">19</span>, <span class="number">6</span>, -<span class="number">9</span>, <span class="number">0</span>, -<span class="number">8</span>, <span class="number">32</span>, -<span class="number">25</span>, <span class="number">31</span>, -<span class="number">62</span>, -<span class="number">7</span>, <span class="number">16</span>, -<span class="number">13</span>, <span class="number">33</span>, <span class="number">54</span>, <span class="number">24</span>, -<span class="number">48</span>, -<span class="number">57</span>, <span class="number">37</span>, -<span class="number">62</span>, <span class="number">13</span>, <span class="number">46</span>, <span class="number">39</span>, <span class="number">5</span>, <span class="number">44</span>, <span class="number">30</span>, <span class="number">10</span>, -<span class="number">6</span>, -<span class="number">17</span>, -<span class="number">2</span>, <span class="number">22</span>, -<span class="number">23</span>, -<span class="number">14</span>, <span class="number">5</span>, -<span class="number">53</span>, -<span class="number">13</span>, -<span class="number">46</span>, <span class="number">22</span>, -<span class="number">32</span>, -<span class="number">8</span>, -<span class="number">16</span>, -<span class="number">34</span>, <span class="number">55</span>, <span class="number">56</span>, -<span class="number">5</span>, -<span class="number">29</span>, <span class="number">0</span>, <span class="number">42</span>, <span class="number">23</span>, <span class="number">40</span>, -<span class="number">47</span>, -<span class="number">62</span>, <span class="number">59</span>, <span class="number">47</span>, <span class="number">18</span>, -<span class="number">61</span>, -<span class="number">14</span>, -<span class="number">56</span>, <span class="number">29</span>, -<span class="number">61</span>, -<span class="number">52</span>, <span class="number">47</span>, -<span class="number">49</span>, <span class="number">22</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">60</span>, -<span class="number">12</span>, <span class="number">11</span>, -<span class="number">46</span>, <span class="number">1</span>, <span class="number">8</span>, -<span class="number">58</span>, -<span class="number">6</span>, -<span class="number">7</span>, <span class="number">41</span>, -<span class="number">58</span>, <span class="number">44</span>, -<span class="number">22</span>, -<span class="number">15</span>, -<span class="number">56</span>, -<span class="number">3</span>, -<span class="number">29</span>]</span><br><span class="line">pubkey = [<span class="number">43</span>, -<span class="number">62</span>, -<span class="number">28</span>, <span class="number">60</span>, -<span class="number">54</span>, -<span class="number">36</span>, <span class="number">53</span>, -<span class="number">21</span>, <span class="number">19</span>, <span class="number">24</span>, <span class="number">33</span>, <span class="number">22</span>, <span class="number">12</span>, <span class="number">11</span>, -<span class="number">11</span>, -<span class="number">4</span>, -<span class="number">16</span>, -<span class="number">53</span>, -<span class="number">20</span>, -<span class="number">10</span>, <span class="number">9</span>, <span class="number">24</span>, -<span class="number">14</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">34</span>, -<span class="number">10</span>, -<span class="number">46</span>, <span class="number">21</span>, -<span class="number">36</span>, -<span class="number">30</span>, <span class="number">13</span>, -<span class="number">57</span>, -<span class="number">38</span>, <span class="number">40</span>, <span class="number">62</span>, <span class="number">6</span>, -<span class="number">63</span>, <span class="number">59</span>, -<span class="number">34</span>, <span class="number">8</span>, -<span class="number">18</span>, <span class="number">26</span>, <span class="number">56</span>, -<span class="number">36</span>, <span class="number">23</span>, <span class="number">19</span>, -<span class="number">59</span>, <span class="number">10</span>, <span class="number">48</span>, <span class="number">41</span>, -<span class="number">33</span>, <span class="number">5</span>, -<span class="number">57</span>, -<span class="number">13</span>, <span class="number">5</span>, <span class="number">46</span>, <span class="number">23</span>, -<span class="number">49</span>, <span class="number">10</span>, -<span class="number">19</span>, <span class="number">35</span>, -<span class="number">20</span>, <span class="number">26</span>, -<span class="number">37</span>, -<span class="number">54</span>, <span class="number">16</span>, <span class="number">46</span>, <span class="number">11</span>, <span class="number">38</span>, -<span class="number">22</span>, <span class="number">17</span>, -<span class="number">6</span>, -<span class="number">8</span>, -<span class="number">38</span>, -<span class="number">34</span>, <span class="number">50</span>, <span class="number">48</span>, -<span class="number">48</span>, -<span class="number">52</span>, -<span class="number">47</span>, -<span class="number">58</span>, -<span class="number">35</span>, <span class="number">7</span>, <span class="number">8</span>, -<span class="number">48</span>, -<span class="number">59</span>, -<span class="number">17</span>, -<span class="number">9</span>, -<span class="number">32</span>, <span class="number">46</span>, -<span class="number">38</span>, -<span class="number">22</span>, -<span class="number">54</span>, -<span class="number">43</span>, -<span class="number">43</span>, -<span class="number">21</span>, <span class="number">24</span>, -<span class="number">55</span>, <span class="number">44</span>, -<span class="number">56</span>, -<span class="number">58</span>, -<span class="number">37</span>, <span class="number">55</span>, -<span class="number">42</span>, -<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, -<span class="number">47</span>, -<span class="number">56</span>, -<span class="number">52</span>, <span class="number">26</span>, <span class="number">41</span>, <span class="number">53</span>, <span class="number">48</span>, <span class="number">44</span>, -<span class="number">9</span>, -<span class="number">21</span>, <span class="number">59</span>, -<span class="number">20</span>, -<span class="number">41</span>, <span class="number">27</span>, <span class="number">60</span>, <span class="number">30</span>, -<span class="number">52</span>, -<span class="number">18</span>, -<span class="number">23</span>, <span class="number">9</span>, -<span class="number">6</span>, -<span class="number">49</span>, -<span class="number">37</span>, -<span class="number">44</span>, <span class="number">22</span>, <span class="number">32</span>, <span class="number">51</span>, -<span class="number">29</span>, -<span class="number">8</span>, <span class="number">5</span>, <span class="number">60</span>, -<span class="number">16</span>, <span class="number">20</span>, -<span class="number">24</span>, -<span class="number">17</span>, <span class="number">63</span>, <span class="number">53</span>, <span class="number">58</span>, -<span class="number">9</span>, <span class="number">48</span>, -<span class="number">19</span>, <span class="number">45</span>, <span class="number">7</span>, -<span class="number">30</span>, -<span class="number">36</span>, <span class="number">10</span>, <span class="number">48</span>, -<span class="number">33</span>, <span class="number">25</span>, <span class="number">6</span>, -<span class="number">62</span>, <span class="number">58</span>, -<span class="number">57</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cyclicconvolution</span>(<span class="params">f,g</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (f * g) % (x^n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">balancedmod</span>(<span class="params">f,q</span>):</span></span><br><span class="line">    g = <span class="built_in">list</span>( ((f[i] + q//<span class="number">2</span>) % q) - q//<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n) )</span><br><span class="line">    <span class="keyword">return</span> Zx(g)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invertmodprime</span>(<span class="params">f,p</span>):</span></span><br><span class="line">    T = Zx.change_ring(Integers(p)).quotient(x^n-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> Zx(lift(<span class="number">1</span> / T(f)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invertmodpowerof2</span>(<span class="params">f,q</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> q.is_power_of(<span class="number">2</span>)</span><br><span class="line">    g = invertmodprime(f,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = balancedmod(cyclicconvolution(g,f),q)</span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>: <span class="keyword">return</span> g</span><br><span class="line">        g = balancedmod(cyclicconvolution(g,<span class="number">2</span> - r),q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N =<span class="number">161</span></span><br><span class="line">p =<span class="number">3</span></span><br><span class="line">q =<span class="number">128</span></span><br><span class="line">p_dq=<span class="number">43</span></span><br><span class="line">Q.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">P.&lt;y&gt; = Zmod(p)[]</span><br><span class="line"><span class="comment"># ex = </span></span><br><span class="line"><span class="comment"># hx = </span></span><br><span class="line">ex = [-<span class="number">3</span>, -<span class="number">34</span>, -<span class="number">33</span>, -<span class="number">31</span>, <span class="number">59</span>, <span class="number">34</span>, <span class="number">50</span>, -<span class="number">56</span>, -<span class="number">46</span>, <span class="number">0</span>, -<span class="number">19</span>, <span class="number">6</span>, <span class="number">55</span>, <span class="number">18</span>, -<span class="number">20</span>, <span class="number">2</span>, <span class="number">57</span>, -<span class="number">36</span>, -<span class="number">61</span>, <span class="number">32</span>, -<span class="number">33</span>, <span class="number">13</span>, -<span class="number">27</span>, -<span class="number">25</span>, -<span class="number">29</span>, <span class="number">5</span>, <span class="number">36</span>, -<span class="number">37</span>, <span class="number">11</span>, -<span class="number">19</span>, -<span class="number">10</span>, -<span class="number">15</span>, -<span class="number">7</span>, -<span class="number">8</span>, <span class="number">63</span>, <span class="number">21</span>, <span class="number">51</span>, -<span class="number">30</span>, -<span class="number">64</span>, -<span class="number">15</span>, -<span class="number">54</span>, -<span class="number">28</span>, -<span class="number">23</span>, -<span class="number">6</span>, -<span class="number">28</span>, <span class="number">35</span>, <span class="number">21</span>, -<span class="number">24</span>, -<span class="number">11</span>, <span class="number">62</span>, <span class="number">21</span>, <span class="number">51</span>, -<span class="number">4</span>, -<span class="number">11</span>, -<span class="number">21</span>, -<span class="number">10</span>, <span class="number">60</span>, -<span class="number">53</span>, -<span class="number">28</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">36</span>, <span class="number">9</span>, <span class="number">44</span>, -<span class="number">19</span>, -<span class="number">53</span>, -<span class="number">57</span>, <span class="number">28</span>, -<span class="number">15</span>, <span class="number">33</span>, <span class="number">58</span>, -<span class="number">10</span>, <span class="number">32</span>, <span class="number">25</span>, <span class="number">46</span>, <span class="number">2</span>, -<span class="number">11</span>, -<span class="number">19</span>, <span class="number">6</span>, -<span class="number">9</span>, <span class="number">0</span>, -<span class="number">8</span>, <span class="number">32</span>, -<span class="number">25</span>, <span class="number">31</span>, -<span class="number">62</span>, -<span class="number">7</span>, <span class="number">16</span>, -<span class="number">13</span>, <span class="number">33</span>, <span class="number">54</span>, <span class="number">24</span>, -<span class="number">48</span>, -<span class="number">57</span>, <span class="number">37</span>, -<span class="number">62</span>, <span class="number">13</span>, <span class="number">46</span>, <span class="number">39</span>, <span class="number">5</span>, <span class="number">44</span>, <span class="number">30</span>, <span class="number">10</span>, -<span class="number">6</span>, -<span class="number">17</span>, -<span class="number">2</span>, <span class="number">22</span>, -<span class="number">23</span>, -<span class="number">14</span>, <span class="number">5</span>, -<span class="number">53</span>, -<span class="number">13</span>, -<span class="number">46</span>, <span class="number">22</span>, -<span class="number">32</span>, -<span class="number">8</span>, -<span class="number">16</span>, -<span class="number">34</span>, <span class="number">55</span>, <span class="number">56</span>, -<span class="number">5</span>, -<span class="number">29</span>, <span class="number">0</span>, <span class="number">42</span>, <span class="number">23</span>, <span class="number">40</span>, -<span class="number">47</span>, -<span class="number">62</span>, <span class="number">59</span>, <span class="number">47</span>, <span class="number">18</span>, -<span class="number">61</span>, -<span class="number">14</span>, -<span class="number">56</span>, <span class="number">29</span>, -<span class="number">61</span>, -<span class="number">52</span>, <span class="number">47</span>, -<span class="number">49</span>, <span class="number">22</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">60</span>, -<span class="number">12</span>, <span class="number">11</span>, -<span class="number">46</span>, <span class="number">1</span>, <span class="number">8</span>, -<span class="number">58</span>, -<span class="number">6</span>, -<span class="number">7</span>, <span class="number">41</span>, -<span class="number">58</span>, <span class="number">44</span>, -<span class="number">22</span>, -<span class="number">15</span>, -<span class="number">56</span>, -<span class="number">3</span>, -<span class="number">29</span>]</span><br><span class="line">hx = [<span class="number">43</span>, -<span class="number">62</span>, -<span class="number">28</span>, <span class="number">60</span>, -<span class="number">54</span>, -<span class="number">36</span>, <span class="number">53</span>, -<span class="number">21</span>, <span class="number">19</span>, <span class="number">24</span>, <span class="number">33</span>, <span class="number">22</span>, <span class="number">12</span>, <span class="number">11</span>, -<span class="number">11</span>, -<span class="number">4</span>, -<span class="number">16</span>, -<span class="number">53</span>, -<span class="number">20</span>, -<span class="number">10</span>, <span class="number">9</span>, <span class="number">24</span>, -<span class="number">14</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">34</span>, -<span class="number">10</span>, -<span class="number">46</span>, <span class="number">21</span>, -<span class="number">36</span>, -<span class="number">30</span>, <span class="number">13</span>, -<span class="number">57</span>, -<span class="number">38</span>, <span class="number">40</span>, <span class="number">62</span>, <span class="number">6</span>, -<span class="number">63</span>, <span class="number">59</span>, -<span class="number">34</span>, <span class="number">8</span>, -<span class="number">18</span>, <span class="number">26</span>, <span class="number">56</span>, -<span class="number">36</span>, <span class="number">23</span>, <span class="number">19</span>, -<span class="number">59</span>, <span class="number">10</span>, <span class="number">48</span>, <span class="number">41</span>, -<span class="number">33</span>, <span class="number">5</span>, -<span class="number">57</span>, -<span class="number">13</span>, <span class="number">5</span>, <span class="number">46</span>, <span class="number">23</span>, -<span class="number">49</span>, <span class="number">10</span>, -<span class="number">19</span>, <span class="number">35</span>, -<span class="number">20</span>, <span class="number">26</span>, -<span class="number">37</span>, -<span class="number">54</span>, <span class="number">16</span>, <span class="number">46</span>, <span class="number">11</span>, <span class="number">38</span>, -<span class="number">22</span>, <span class="number">17</span>, -<span class="number">6</span>, -<span class="number">8</span>, -<span class="number">38</span>, -<span class="number">34</span>, <span class="number">50</span>, <span class="number">48</span>, -<span class="number">48</span>, -<span class="number">52</span>, -<span class="number">47</span>, -<span class="number">58</span>, -<span class="number">35</span>, <span class="number">7</span>, <span class="number">8</span>, -<span class="number">48</span>, -<span class="number">59</span>, -<span class="number">17</span>, -<span class="number">9</span>, -<span class="number">32</span>, <span class="number">46</span>, -<span class="number">38</span>, -<span class="number">22</span>, -<span class="number">54</span>, -<span class="number">43</span>, -<span class="number">43</span>, -<span class="number">21</span>, <span class="number">24</span>, -<span class="number">55</span>, <span class="number">44</span>, -<span class="number">56</span>, -<span class="number">58</span>, -<span class="number">37</span>, <span class="number">55</span>, -<span class="number">42</span>, -<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, -<span class="number">47</span>, -<span class="number">56</span>, -<span class="number">52</span>, <span class="number">26</span>, <span class="number">41</span>, <span class="number">53</span>, <span class="number">48</span>, <span class="number">44</span>, -<span class="number">9</span>, -<span class="number">21</span>, <span class="number">59</span>, -<span class="number">20</span>, -<span class="number">41</span>, <span class="number">27</span>, <span class="number">60</span>, <span class="number">30</span>, -<span class="number">52</span>, -<span class="number">18</span>, -<span class="number">23</span>, <span class="number">9</span>, -<span class="number">6</span>, -<span class="number">49</span>, -<span class="number">37</span>, -<span class="number">44</span>, <span class="number">22</span>, <span class="number">32</span>, <span class="number">51</span>, -<span class="number">29</span>, -<span class="number">8</span>, <span class="number">5</span>, <span class="number">60</span>, -<span class="number">16</span>, <span class="number">20</span>, -<span class="number">24</span>, -<span class="number">17</span>, <span class="number">63</span>, <span class="number">53</span>, <span class="number">58</span>, -<span class="number">9</span>, <span class="number">48</span>, -<span class="number">19</span>, <span class="number">45</span>, <span class="number">7</span>, -<span class="number">30</span>, -<span class="number">36</span>, <span class="number">10</span>, <span class="number">48</span>, -<span class="number">33</span>, <span class="number">25</span>, <span class="number">6</span>, -<span class="number">62</span>, <span class="number">58</span>, -<span class="number">57</span>]</span><br><span class="line">hx.reverse()</span><br><span class="line">ex.reverse()</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;-------decrypt------&#x27;</span>)</span><br><span class="line">qq = x^N-<span class="number">1</span></span><br><span class="line">pp = y^N-<span class="number">1</span></span><br><span class="line">hn = [(<span class="built_in">int</span>(x)*p_dq+q//<span class="number">2</span>)%q-q//<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> hx]</span><br><span class="line">n = <span class="built_in">len</span>(hn)</span><br><span class="line">A1 = matrix.identity(n)*q</span><br><span class="line">A0 = matrix.zero(n)</span><br><span class="line">Aq = matrix.identity(n)</span><br><span class="line">Ah = matrix(ZZ, [hn[-i:] + hn[:-i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">M = block_matrix([A1,Ah,A0,Aq],nrows=<span class="number">2</span>)</span><br><span class="line">L = M.transpose().LLL()</span><br><span class="line"><span class="comment"># L = M.LLL()</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    v=<span class="built_in">list</span>(L[i])</span><br><span class="line">    print(v)</span><br><span class="line">    <span class="keyword">if</span> v.count(<span class="number">1</span>)+v.count(-<span class="number">1</span>)==<span class="number">14</span>:</span><br><span class="line">        print(<span class="string">&quot;valid&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">v=<span class="built_in">list</span>(L[<span class="number">0</span>])</span><br><span class="line">print(v)</span><br><span class="line"><span class="comment"># v.reverse()</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v)):</span><br><span class="line">    <span class="keyword">if</span> v[i]==<span class="number">3</span> <span class="keyword">or</span> v[i]==-<span class="number">3</span>:</span><br><span class="line">        v[i]=v[i]//<span class="number">3</span></span><br><span class="line">print(v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = (<span class="built_in">list</span>(v)[:n])</span><br><span class="line">g = (<span class="built_in">list</span>(v)[n:])</span><br><span class="line">fx = Q(f)</span><br><span class="line">fy = P(f)</span><br><span class="line">gx = Q(g)</span><br><span class="line">Fqx = fx.inverse_mod(qq)</span><br><span class="line">Fpy = fy.inverse_mod(pp)</span><br><span class="line"></span><br><span class="line"><span class="comment">#hxx = (Fqx*gx).mod(x^N-1)</span></span><br><span class="line"><span class="comment">#print(hxx==hx)</span></span><br><span class="line"></span><br><span class="line">c=Q(ex)</span><br><span class="line">ax = (fx*c).mod(qq)</span><br><span class="line">an = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> ax.coefficients()]</span><br><span class="line"><span class="comment">#中心提升(centerlift)，使域范围从[0,q)变换到(-q/2,q/2)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(an)):</span><br><span class="line">    <span class="keyword">if</span> an[i] &gt; q//<span class="number">2</span>:</span><br><span class="line">        an[i] -= q</span><br><span class="line">ax = P(an)</span><br><span class="line">print(ax)</span><br><span class="line">out = (Fpy * ax).mod(pp)</span><br><span class="line">print(out)</span><br><span class="line"></span><br><span class="line">bin_str=<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> out.coefficients(sparse=<span class="literal">False</span>)])</span><br><span class="line"><span class="keyword">while</span> <span class="string">&#x27;2&#x27;</span> <span class="keyword">in</span> bin_str:</span><br><span class="line">    bin_str=bin_str.replace(<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">print(bin_str)</span><br><span class="line">flag1=<span class="built_in">int</span>(bin_str,<span class="number">2</span>)</span><br><span class="line">flag2=<span class="built_in">int</span>(bin_str[::-<span class="number">1</span>],<span class="number">2</span>)</span><br><span class="line">v=[<span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">print(long_to_bytes(flag1))</span><br><span class="line">print(long_to_bytes(flag2))</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h2 id="2021-陇原杯-crypto题解"><a href="#2021-陇原杯-crypto题解" class="headerlink" title="2021 陇原杯 crypto题解"></a>2021 陇原杯 crypto题解</h2><p>比较简单，也是记录一下脚本。</p>
<p>&nbsp;</p>
<h3 id="easytask"><a href="#easytask" class="headerlink" title="easytask"></a>easytask</h3><p>原来以为是LWE，其实是GGH，之后在详细了解一下。不过按照LWE的格构造来解其实也是差不多的。GGH加密可以参考<a target="_blank" rel="noopener" href="https://hxp.io/blog/26/VolgaCTF-2016-Quals-crypto300-XXY-writeup/">这个</a>。或者我们认为它是没有取模的 LWE 问题，格直接取输出的M矩阵即可，不需要再构造额外的对角q矩阵，LLL格基规约后用 Babai算法解CVP问题，可以得到 r-e ，我们再确认 error 的范围和源代码一致即可： [-3,3] ,之后解线 性方程组即可得到m。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">res = [<span class="number">151991736758354</span> ,<span class="number">115130361237591</span>,  <span class="number">58905390613532</span> ,<span class="number">130965235357066</span> , <span class="number">74614897867998</span>  ,<span class="number">48099459442369</span> , <span class="number">45894485782943</span>   ,<span class="number">7933340009592</span>   ,  <span class="number">25794185638</span>]</span><br><span class="line">ma =[[-<span class="number">10150241248</span> ,-<span class="number">11679953514</span>  ,-<span class="number">8802490385</span>, -<span class="number">12260198788</span> ,-<span class="number">10290571893</span>   ,-<span class="number">334269043</span> ,-<span class="number">11669932300</span> , -<span class="number">2158827458</span>  ,   -<span class="number">7021995</span>],</span><br><span class="line">[ <span class="number">52255960212</span>,  <span class="number">48054224859</span>  ,<span class="number">28230779201</span>  ,<span class="number">43264260760</span>  ,<span class="number">20836572799</span>   ,<span class="number">8191198018</span>  ,<span class="number">14000400181</span>  , <span class="number">4370731005</span>    , <span class="number">14251110</span>],</span><br><span class="line">[  <span class="number">2274129180</span>  ,-<span class="number">1678741826</span>  ,-<span class="number">1009050115</span>  , <span class="number">1858488045</span>   , <span class="number">978763435</span>   ,<span class="number">4717368685</span>   ,-<span class="number">561197285</span> , -<span class="number">1999440633</span>     ,-<span class="number">6540190</span>],</span><br><span class="line">[ <span class="number">45454841384</span>  ,<span class="number">34351838833</span>  ,<span class="number">19058600591</span> , <span class="number">39744104894</span>  ,<span class="number">21481706222</span> , <span class="number">14785555279</span>  ,<span class="number">13193105539</span>  , <span class="number">2306952916</span>     , <span class="number">7501297</span>],</span><br><span class="line">[-<span class="number">16804706629</span> ,-<span class="number">13041485360</span>  ,-<span class="number">8292982763</span> ,-<span class="number">16801260566</span>  ,-<span class="number">9211427035</span>  ,-<span class="number">4808377155</span>  ,-<span class="number">6530124040</span>  ,-<span class="number">2572433293</span>    , -<span class="number">8393737</span>],</span><br><span class="line">[ <span class="number">28223439540</span>  ,<span class="number">19293284310</span>   ,<span class="number">5217202426</span>  ,<span class="number">27179839904</span>  ,<span class="number">23182044384</span>  ,<span class="number">10788207024</span>  ,<span class="number">18495479452</span>   ,<span class="number">4007452688</span>   ,  <span class="number">13046387</span>],</span><br><span class="line">[   <span class="number">968256091</span> , -<span class="number">1507028552</span>  , <span class="number">1677187853</span>   ,<span class="number">8685590653</span>   ,<span class="number">9696793863</span>   ,<span class="number">2942265602</span>  ,<span class="number">10534454095</span>   ,<span class="number">2668834317</span>   ,   <span class="number">8694828</span>],</span><br><span class="line">[ <span class="number">33556338459</span>  ,<span class="number">26577210571</span> , <span class="number">16558795385</span>  ,<span class="number">28327066095</span>  ,<span class="number">10684900266</span>   ,<span class="number">9113388576</span>  , <span class="number">2446282316</span>   ,-<span class="number">173705548</span>  ,    -<span class="number">577070</span>],</span><br><span class="line">[ <span class="number">35404775180</span>  ,<span class="number">32321129676</span>,  <span class="number">15071970630</span>  ,<span class="number">24947264815</span> , <span class="number">14402999486</span>   ,<span class="number">5857384379</span> , <span class="number">10620159241</span>   ,<span class="number">2408185012</span> ,     <span class="number">7841686</span>],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">W = matrix(ZZ, ma)</span><br><span class="line">cc = vector(ZZ, res)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Babai&#x27;s Nearest Plane algorithm</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Babai_closest_vector</span>(<span class="params">M, G, target</span>):</span></span><br><span class="line">    small = target</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(M.nrows())):</span><br><span class="line">            c = ((small * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">            small -=  M[i] * c</span><br><span class="line">    <span class="keyword">return</span> target - small</span><br><span class="line"></span><br><span class="line">lattice = IntegerLattice(W, lll_reduce=<span class="literal">True</span>)</span><br><span class="line">print(<span class="string">&quot;LLL done&quot;</span>)</span><br><span class="line">gram = lattice.reduced_basis.gram_schmidt()</span><br><span class="line">gram=gram[<span class="number">0</span>]</span><br><span class="line">target = cc</span><br><span class="line">re = Babai_closest_vector(lattice.reduced_basis, gram, target)</span><br><span class="line">print(<span class="string">&quot;Closest Vector: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(re))</span><br><span class="line">e = re - cc  <span class="comment"># error vector</span></span><br><span class="line">print(<span class="string">&quot;error sum &quot;</span>,e.norm()^<span class="number">2</span>)</span><br><span class="line"><span class="comment"># e全为-3,3之间说明正确恢复</span></span><br><span class="line">print(e)</span><br><span class="line"></span><br><span class="line"><span class="comment"># R = ZZ</span></span><br><span class="line">M = Matrix(ZZ, ma)</span><br><span class="line"><span class="comment"># ingredients全为素数说明恢复完全正确</span></span><br><span class="line">ingredients = <span class="built_in">list</span>(M.solve_left(re))</span><br><span class="line">print(<span class="string">&quot;Ingredients: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(ingredients))</span><br><span class="line"></span><br><span class="line">key = hashlib.sha256(<span class="built_in">str</span>(ingredients).encode()).digest()</span><br><span class="line">enc_flag =long_to_bytes(<span class="number">0x1070260d8986d5e3c4b7e672a6f1ef2c185c7fff682f99cc4a8e49cfce168aa0</span>)</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">flag = cipher.decrypt(enc_flag)</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment"># flag&#123;be5152d04a49234a251956a32b&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>&nbsp;</p>

    

    

    

  </div>
  <div class="article-info article-info-index">
    
    
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">CTF</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">writeup</a>
        		</li>
      		
		</ul>
	</div>

    
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/CTF//" class="article-tag-list-link color4">CTF</a>
        		</li>
      		
		</ul>
	</div>


    

    
    
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <!-- <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a> -->
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
     <!-- <img src="//pan.baidu.com/share/qrcode?url=https://tl2cents.github.io/2021/11/26/CRYPTO2021/" alt="微信分享二维码"> -->
    </div>
</div>

<div class="mask js-mask"></div>

    
    <div class="clearfix"></div>
  </div>
  </div>
</article>


<nav id="article-nav">
  
    <a href="/2021/12/14/Hitcon2021-Crypto-Writeup/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          Hitcon2021 Crypto Writeup
        
      </div>
    </a>
  
  
    <a href="/2021/10/31/Hackgame2021/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Hacker Game 2021 Writeup</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
        <div class="toc-container tooltip-left">
            <i class="icon-font icon-category"></i>
            <div class="tooltip tooltip-east">
                <span class="tooltip-item">
                </span>
                <span class="tooltip-content">
                    <div class="toc-article">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2021-Byte-CTF-crypto%E9%A2%98%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">2021 Byte CTF crypto题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JustDecrypt"><span class="toc-number">1.1.</span> <span class="toc-text">JustDecrypt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyxor"><span class="toc-number">1.2.</span> <span class="toc-text">easyxor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#overhead"><span class="toc-number">1.3.</span> <span class="toc-text">overhead</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#abusedkey"><span class="toc-number">1.4.</span> <span class="toc-text">abusedkey</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2021-L3HCTF-Crypto-%E9%A2%98%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">2021 L3HCTF Crypto 题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EzECDSA"><span class="toc-number">2.1.</span> <span class="toc-text">EzECDSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#p0o0w"><span class="toc-number">2.2.</span> <span class="toc-text">p0o0w</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2021-%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-Crypto%E9%A2%98%E8%A7%A3"><span class="toc-number">3.</span> <span class="toc-text">2021 西湖论剑 Crypto题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#unknownDSA"><span class="toc-number">3.1.</span> <span class="toc-text">unknownDSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FilterRandom"><span class="toc-number">3.2.</span> <span class="toc-text">FilterRandom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HardRSA"><span class="toc-number">3.3.</span> <span class="toc-text">HardRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SpecialCurve2"><span class="toc-number">3.4.</span> <span class="toc-text">SpecialCurve2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2021-N1CTF-Crypto%E9%A2%98%E8%A7%A3"><span class="toc-number">4.</span> <span class="toc-text">2021 N1CTF Crypto题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#checkin"><span class="toc-number">4.1.</span> <span class="toc-text">checkin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#n1token1"><span class="toc-number">4.2.</span> <span class="toc-text">n1token1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#n1token2"><span class="toc-number">4.3.</span> <span class="toc-text">n1token2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#n1login"><span class="toc-number">4.4.</span> <span class="toc-text">n1login</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2021-KQCTF-crypto%E9%A2%98%E8%A7%A3"><span class="toc-number">5.</span> <span class="toc-text">2021 KQCTF crypto题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Polynomialtime"><span class="toc-number">5.1.</span> <span class="toc-text">Polynomialtime</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KQRUEncrypt"><span class="toc-number">5.2.</span> <span class="toc-text">KQRUEncrypt</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2021-%E9%99%87%E5%8E%9F%E6%9D%AF-crypto%E9%A2%98%E8%A7%A3"><span class="toc-number">6.</span> <span class="toc-text">2021 陇原杯 crypto题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#easytask"><span class="toc-number">6.1.</span> <span class="toc-text">easytask</span></a></li></ol></li></ol>
                    </div>
                </span>
            </div>
        </div>
        
    </div>
</aside>














          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy;
        2021-2024
        <a href="https://tl2cents.github.io/" target="_blank">tl2cents</a>
      </div>
      <div class="footer-right">
        
        
        GitHub:<a href="https://github.com/JoeyBling/hexo-theme-yilia-plus" target="_blank">hexo-theme-yilia-plus</a> by Litten
      </div>
    </div>
  </div>

  
  <script src="/lib/busuanzi.pure.js"></script>
  
  
  
  
  <span id="busuanzi_container_site_pv" style="display:none">
    Total visits: <span id="busuanzi_value_site_pv"></span>
    <span class="post-meta-divider">|</span>
  </span>
  <span id="busuanzi_container_site_uv" style='display:none'>
    Total visitors: <span id="busuanzi_value_site_uv"></span>
    <span class="post-meta-divider">|</span>
    Since 2023.4.3
    <!-- Since 2023.4.3 -->
  </span>
  
</footer>

    </div>
    <script>
	var yiliaConfig = {
		mathjax: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: true
	}
</script>

<script>
  ! function (r) {
    function e(t) {
      if (i[t]) return i[t].exports;
      var n = i[t] = {
        exports: {},
        id: t,
        loaded: !1
      };
      return r[t].call(n.exports, n, n.exports, e), n.loaded = !0, n.exports
    }
    var i = {};
    e.m = r, e.c = i, e.p = "./", e(0)
  }([function (t, n, r) {
    r(208), t.exports = r(205)
  }, function (t, n, r) {
    var d = r(3),
      y = r(46),
      g = r(26),
      b = r(27),
      x = r(47),
      m = "prototype",
      S = function (t, n, r) {
        var e, i, o, u, c = t & S.F,
          f = t & S.G,
          a = t & S.S,
          s = t & S.P,
          l = t & S.B,
          h = f ? d : a ? d[n] || (d[n] = {}) : (d[n] || {})[m],
          v = f ? y : y[n] || (y[n] = {}),
          p = v[m] || (v[m] = {});
        for (e in f && (r = n), r) o = ((i = !c && h && void 0 !== h[e]) ? h : r)[e], u = l && i ? x(o, d) : s &&
          "function" == typeof o ? x(Function.call, o) : o, h && b(h, e, o, t & S.U), v[e] != o && g(v, e, u), s &&
          p[e] != o && (p[e] = o)
      };
    d.core = y, S.F = 1, S.G = 2, S.S = 4, S.P = 8, S.B = 16, S.W = 32, S.U = 64, S.R = 128, t.exports = S
  }, function (t, n, r) {
    var e = r(5);
    t.exports = function (t) {
      if (!e(t)) throw TypeError(t + " is not an object!");
      return t
    }
  }, function (t, n) {
    var r = t.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self &&
      self.Math == Math ? self : Function("return this")();
    "number" == typeof __g && (__g = r)
  }, function (t, n) {
    t.exports = function (t) {
      try {
        return !!t()
      } catch (t) {
        return !0
      }
    }
  }, function (t, n) {
    t.exports = function (t) {
      return "object" == typeof t ? null !== t : "function" == typeof t
    }
  }, function (t, n) {
    var r = t.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self &&
      self.Math == Math ? self : Function("return this")();
    "number" == typeof __g && (__g = r)
  }, function (t, n, r) {
    var e = r(118)("wks"),
      i = r(79),
      o = r(3).Symbol,
      u = "function" == typeof o;
    (t.exports = function (t) {
      return e[t] || (e[t] = u && o[t] || (u ? o : i)("Symbol." + t))
    }).store = e
  }, function (t, n, r) {
    var e = r(49),
      i = Math.min;
    t.exports = function (t) {
      return 0 < t ? i(e(t), 9007199254740991) : 0
    }
  }, function (t, n) {
    var r = {}.hasOwnProperty;
    t.exports = function (t, n) {
      return r.call(t, n)
    }
  }, function (t, n, r) {
    t.exports = !r(4)(function () {
      return 7 != Object.defineProperty({}, "a", {
        get: function () {
          return 7
        }
      }).a
    })
  }, function (t, n, r) {
    var e = r(2),
      i = r(174),
      o = r(53),
      u = Object.defineProperty;
    n.f = r(10) ? Object.defineProperty : function (t, n, r) {
      if (e(t), n = o(n, !0), e(r), i) try {
        return u(t, n, r)
      } catch (t) {}
      if ("get" in r || "set" in r) throw TypeError("Accessors not supported!");
      return "value" in r && (t[n] = r.value), t
    }
  }, function (t, n, r) {
    t.exports = !r(20)(function () {
      return 7 != Object.defineProperty({}, "a", {
        get: function () {
          return 7
        }
      }).a
    })
  }, function (t, n, r) {
    var e = r(14),
      i = r(24);
    t.exports = r(12) ? function (t, n, r) {
      return e.f(t, n, i(1, r))
    } : function (t, n, r) {
      return t[n] = r, t
    }
  }, function (t, n, r) {
    var e = r(22),
      i = r(60),
      o = r(42),
      u = Object.defineProperty;
    n.f = r(12) ? Object.defineProperty : function (t, n, r) {
      if (e(t), n = o(n, !0), e(r), i) try {
        return u(t, n, r)
      } catch (t) {}
      if ("get" in r || "set" in r) throw TypeError("Accessors not supported!");
      return "value" in r && (t[n] = r.value), t
    }
  }, function (t, n, r) {
    var e = r(96),
      i = r(34);
    t.exports = function (t) {
      return e(i(t))
    }
  }, function (t, n, r) {
    var e = r(40)("wks"),
      i = r(25),
      o = r(6).Symbol,
      u = "function" == typeof o;
    (t.exports = function (t) {
      return e[t] || (e[t] = u && o[t] || (u ? o : i)("Symbol." + t))
    }).store = e
  }, function (t, n, r) {
    var e = r(51);
    t.exports = function (t) {
      return Object(e(t))
    }
  }, function (t, n) {
    t.exports = function (t) {
      return "object" == typeof t ? null !== t : "function" == typeof t
    }
  }, function (t, n) {
    var r = t.exports = {
      version: "2.6.9"
    };
    "number" == typeof __e && (__e = r)
  }, function (t, n) {
    t.exports = function (t) {
      try {
        return !!t()
      } catch (t) {
        return !0
      }
    }
  }, function (t, n) {
    t.exports = function (t) {
      if ("function" != typeof t) throw TypeError(t + " is not a function!");
      return t
    }
  }, function (t, n, r) {
    var e = r(18);
    t.exports = function (t) {
      if (!e(t)) throw TypeError(t + " is not an object!");
      return t
    }
  }, function (t, n) {
    t.exports = !0
  }, function (t, n) {
    t.exports = function (t, n) {
      return {
        enumerable: !(1 & t),
        configurable: !(2 & t),
        writable: !(4 & t),
        value: n
      }
    }
  }, function (t, n) {
    var r = 0,
      e = Math.random();
    t.exports = function (t) {
      return "Symbol(".concat(void 0 === t ? "" : t, ")_", (++r + e).toString(36))
    }
  }, function (t, n, r) {
    var e = r(11),
      i = r(75);
    t.exports = r(10) ? function (t, n, r) {
      return e.f(t, n, i(1, r))
    } : function (t, n, r) {
      return t[n] = r, t
    }
  }, function (t, n, r) {
    var o = r(3),
      u = r(26),
      c = r(30),
      f = r(79)("src"),
      e = r(219),
      i = "toString",
      a = ("" + e).split(i);
    r(46).inspectSource = function (t) {
      return e.call(t)
    }, (t.exports = function (t, n, r, e) {
      var i = "function" == typeof r;
      i && (c(r, "name") || u(r, "name", n)), t[n] !== r && (i && (c(r, f) || u(r, f, t[n] ? "" + t[n] : a.join(
        String(n)))), t === o ? t[n] = r : e ? t[n] ? t[n] = r : u(t, n, r) : (delete t[n], u(t, n, r)))
    })(Function.prototype, i, function () {
      return "function" == typeof this && this[f] || e.call(this)
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(4),
      u = r(51),
      c = /"/g,
      o = function (t, n, r, e) {
        var i = String(u(t)),
          o = "<" + n;
        return "" !== r && (o += " " + r + '="' + String(e).replace(c, "&quot;") + '"'), o + ">" + i + "</" + n +
          ">"
      };
    t.exports = function (n, t) {
      var r = {};
      r[n] = t(o), e(e.P + e.F * i(function () {
        var t = "" [n]('"');
        return t !== t.toLowerCase() || 3 < t.split('"').length
      }), "String", r)
    }
  }, function (t, n, r) {
    var e = r(65),
      i = r(35);
    t.exports = Object.keys || function (t) {
      return e(t, i)
    }
  }, function (t, n) {
    var r = {}.hasOwnProperty;
    t.exports = function (t, n) {
      return r.call(t, n)
    }
  }, function (t, n, r) {
    var e = r(117),
      i = r(75),
      o = r(33),
      u = r(53),
      c = r(30),
      f = r(174),
      a = Object.getOwnPropertyDescriptor;
    n.f = r(10) ? a : function (t, n) {
      if (t = o(t), n = u(n, !0), f) try {
        return a(t, n)
      } catch (t) {}
      if (c(t, n)) return i(!e.f.call(t, n), t[n])
    }
  }, function (t, n, r) {
    var e = r(30),
      i = r(17),
      o = r(154)("IE_PROTO"),
      u = Object.prototype;
    t.exports = Object.getPrototypeOf || function (t) {
      return t = i(t), e(t, o) ? t[o] : "function" == typeof t.constructor && t instanceof t.constructor ? t
        .constructor.prototype : t instanceof Object ? u : null
    }
  }, function (t, n, r) {
    var e = r(116),
      i = r(51);
    t.exports = function (t) {
      return e(i(t))
    }
  }, function (t, n) {
    t.exports = function (t) {
      if (null == t) throw TypeError("Can't call method on  " + t);
      return t
    }
  }, function (t, n) {
    t.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf"
      .split(",")
  }, function (t, n) {
    t.exports = {}
  }, function (t, n) {
    n.f = {}.propertyIsEnumerable
  }, function (t, n, r) {
    var e = r(14).f,
      i = r(9),
      o = r(16)("toStringTag");
    t.exports = function (t, n, r) {
      t && !i(t = r ? t : t.prototype, o) && e(t, o, {
        configurable: !0,
        value: n
      })
    }
  }, function (t, n, r) {
    var e = r(40)("keys"),
      i = r(25);
    t.exports = function (t) {
      return e[t] || (e[t] = i(t))
    }
  }, function (t, n, r) {
    var e = r(19),
      i = r(6),
      o = "__core-js_shared__",
      u = i[o] || (i[o] = {});
    (t.exports = function (t, n) {
      return u[t] || (u[t] = void 0 !== n ? n : {})
    })("versions", []).push({
      version: e.version,
      mode: r(23) ? "pure" : "global",
      copyright: "© 2019 Denis Pushkarev (zloirock.ru)"
    })
  }, function (t, n) {
    var r = Math.ceil,
      e = Math.floor;
    t.exports = function (t) {
      return isNaN(t = +t) ? 0 : (0 < t ? e : r)(t)
    }
  }, function (t, n, r) {
    var i = r(18);
    t.exports = function (t, n) {
      if (!i(t)) return t;
      var r, e;
      if (n && "function" == typeof (r = t.toString) && !i(e = r.call(t))) return e;
      if ("function" == typeof (r = t.valueOf) && !i(e = r.call(t))) return e;
      if (!n && "function" == typeof (r = t.toString) && !i(e = r.call(t))) return e;
      throw TypeError("Can't convert object to primitive value")
    }
  }, function (t, n, r) {
    var e = r(6),
      i = r(19),
      o = r(23),
      u = r(44),
      c = r(14).f;
    t.exports = function (t) {
      var n = i.Symbol || (i.Symbol = o ? {} : e.Symbol || {});
      "_" == t.charAt(0) || t in n || c(n, t, {
        value: u.f(t)
      })
    }
  }, function (t, n, r) {
    n.f = r(16)
  }, function (t, n) {
    var r = {}.toString;
    t.exports = function (t) {
      return r.call(t).slice(8, -1)
    }
  }, function (t, n) {
    var r = t.exports = {
      version: "2.6.9"
    };
    "number" == typeof __e && (__e = r)
  }, function (t, n, r) {
    var o = r(21);
    t.exports = function (e, i, t) {
      if (o(e), void 0 === i) return e;
      switch (t) {
        case 1:
          return function (t) {
            return e.call(i, t)
          };
        case 2:
          return function (t, n) {
            return e.call(i, t, n)
          };
        case 3:
          return function (t, n, r) {
            return e.call(i, t, n, r)
          }
      }
      return function () {
        return e.apply(i, arguments)
      }
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(4);
    t.exports = function (t, n) {
      return !!t && e(function () {
        n ? t.call(null, function () {}, 1) : t.call(null)
      })
    }
  }, function (t, n) {
    var r = Math.ceil,
      e = Math.floor;
    t.exports = function (t) {
      return isNaN(t = +t) ? 0 : (0 < t ? e : r)(t)
    }
  }, function (t, n, r) {
    var x = r(47),
      m = r(116),
      S = r(17),
      w = r(8),
      e = r(138);
    t.exports = function (l, t) {
      var h = 1 == l,
        v = 2 == l,
        p = 3 == l,
        d = 4 == l,
        y = 6 == l,
        g = 5 == l || y,
        b = t || e;
      return function (t, n, r) {
        for (var e, i, o = S(t), u = m(o), c = x(n, r, 3), f = w(u.length), a = 0, s = h ? b(t, f) : v ? b(t,
            0) : void 0; a < f; a++)
          if ((g || a in u) && (i = c(e = u[a], a, o), l))
            if (h) s[a] = i;
            else if (i) switch (l) {
          case 3:
            return !0;
          case 5:
            return e;
          case 6:
            return a;
          case 2:
            s.push(e)
        } else if (d) return !1;
        return y ? -1 : p || d ? d : s
      }
    }
  }, function (t, n) {
    t.exports = function (t) {
      if (null == t) throw TypeError("Can't call method on  " + t);
      return t
    }
  }, function (t, n, r) {
    var i = r(1),
      o = r(46),
      u = r(4);
    t.exports = function (t, n) {
      var r = (o.Object || {})[t] || Object[t],
        e = {};
      e[t] = n(r), i(i.S + i.F * u(function () {
        r(1)
      }), "Object", e)
    }
  }, function (t, n, r) {
    var i = r(5);
    t.exports = function (t, n) {
      if (!i(t)) return t;
      var r, e;
      if (n && "function" == typeof (r = t.toString) && !i(e = r.call(t))) return e;
      if ("function" == typeof (r = t.valueOf) && !i(e = r.call(t))) return e;
      if (!n && "function" == typeof (r = t.toString) && !i(e = r.call(t))) return e;
      throw TypeError("Can't convert object to primitive value")
    }
  }, function (t, n, r) {
    var d = r(6),
      y = r(19),
      g = r(93),
      b = r(13),
      x = r(9),
      m = "prototype",
      S = function (t, n, r) {
        var e, i, o, u = t & S.F,
          c = t & S.G,
          f = t & S.S,
          a = t & S.P,
          s = t & S.B,
          l = t & S.W,
          h = c ? y : y[n] || (y[n] = {}),
          v = h[m],
          p = c ? d : f ? d[n] : (d[n] || {})[m];
        for (e in c && (r = n), r)(i = !u && p && void 0 !== p[e]) && x(h, e) || (o = i ? p[e] : r[e], h[e] = c &&
          "function" != typeof p[e] ? r[e] : s && i ? g(o, d) : l && p[e] == o ? function (e) {
            var t = function (t, n, r) {
              if (this instanceof e) {
                switch (arguments.length) {
                  case 0:
                    return new e;
                  case 1:
                    return new e(t);
                  case 2:
                    return new e(t, n)
                }
                return new e(t, n, r)
              }
              return e.apply(this, arguments)
            };
            return t[m] = e[m], t
          }(o) : a && "function" == typeof o ? g(Function.call, o) : o, a && ((h.virtual || (h.virtual = {}))[e] =
            o, t & S.R && v && !v[e] && b(v, e, o)))
      };
    S.F = 1, S.G = 2, S.S = 4, S.P = 8, S.B = 16, S.W = 32, S.U = 64, S.R = 128, t.exports = S
  }, function (t, n, r) {
    var e = r(34);
    t.exports = function (t) {
      return Object(e(t))
    }
  }, function (t, n, r) {
    var o = r(196),
      e = r(1),
      i = r(118)("metadata"),
      u = i.store || (i.store = new(r(200))),
      c = function (t, n, r) {
        var e = u.get(t);
        if (!e) {
          if (!r) return;
          u.set(t, e = new o)
        }
        var i = e.get(n);
        if (!i) {
          if (!r) return;
          e.set(n, i = new o)
        }
        return i
      };
    t.exports = {
      store: u,
      map: c,
      has: function (t, n, r) {
        var e = c(n, r, !1);
        return void 0 !== e && e.has(t)
      },
      get: function (t, n, r) {
        var e = c(n, r, !1);
        return void 0 === e ? void 0 : e.get(t)
      },
      set: function (t, n, r, e) {
        c(r, e, !0).set(t, n)
      },
      keys: function (t, n) {
        var r = c(t, n, !1),
          e = [];
        return r && r.forEach(function (t, n) {
          e.push(n)
        }), e
      },
      key: function (t) {
        return void 0 === t || "symbol" == typeof t ? t : String(t)
      },
      exp: function (t) {
        e(e.S, "Reflect", t)
      }
    }
  }, function (t, n, r) {
    "use strict";
    if (r(10)) {
      var g = r(68),
        b = r(3),
        x = r(4),
        m = r(1),
        S = r(132),
        e = r(159),
        h = r(47),
        w = r(70),
        i = r(75),
        _ = r(26),
        o = r(76),
        u = r(49),
        O = r(8),
        E = r(194),
        c = r(78),
        f = r(53),
        a = r(30),
        M = r(81),
        P = r(5),
        v = r(17),
        p = r(145),
        j = r(72),
        F = r(32),
        A = r(73).f,
        d = r(161),
        s = r(79),
        l = r(7),
        y = r(50),
        I = r(120),
        L = r(119),
        N = r(162),
        T = r(82),
        k = r(125),
        R = r(77),
        C = r(137),
        D = r(166),
        G = r(11),
        W = r(31),
        U = G.f,
        V = W.f,
        B = b.RangeError,
        q = b.TypeError,
        z = b.Uint8Array,
        K = "ArrayBuffer",
        H = "Shared" + K,
        J = "BYTES_PER_ELEMENT",
        $ = "prototype",
        Y = Array[$],
        X = e.ArrayBuffer,
        Q = e.DataView,
        Z = y(0),
        tt = y(2),
        nt = y(3),
        rt = y(4),
        et = y(5),
        it = y(6),
        ot = I(!0),
        ut = I(!1),
        ct = N.values,
        ft = N.keys,
        at = N.entries,
        st = Y.lastIndexOf,
        lt = Y.reduce,
        ht = Y.reduceRight,
        vt = Y.join,
        pt = Y.sort,
        dt = Y.slice,
        yt = Y.toString,
        gt = Y.toLocaleString,
        bt = l("iterator"),
        xt = l("toStringTag"),
        mt = s("typed_constructor"),
        St = s("def_constructor"),
        wt = S.CONSTR,
        _t = S.TYPED,
        Ot = S.VIEW,
        Et = "Wrong length!",
        Mt = y(1, function (t, n) {
          return It(L(t, t[St]), n)
        }),
        Pt = x(function () {
          return 1 === new z(new Uint16Array([1]).buffer)[0]
        }),
        jt = !!z && !!z[$].set && x(function () {
          new z(1).set({})
        }),
        Ft = function (t, n) {
          var r = u(t);
          if (r < 0 || r % n) throw B("Wrong offset!");
          return r
        },
        At = function (t) {
          if (P(t) && _t in t) return t;
          throw q(t + " is not a typed array!")
        },
        It = function (t, n) {
          if (!(P(t) && mt in t)) throw q("It is not a typed array constructor!");
          return new t(n)
        },
        Lt = function (t, n) {
          return Nt(L(t, t[St]), n)
        },
        Nt = function (t, n) {
          for (var r = 0, e = n.length, i = It(t, e); r < e;) i[r] = n[r++];
          return i
        },
        Tt = function (t, n, r) {
          U(t, n, {
            get: function () {
              return this._d[r]
            }
          })
        },
        kt = function (t) {
          var n, r, e, i, o, u, c = v(t),
            f = arguments.length,
            a = 1 < f ? arguments[1] : void 0,
            s = void 0 !== a,
            l = d(c);
          if (null != l && !p(l)) {
            for (u = l.call(c), e = [], n = 0; !(o = u.next()).done; n++) e.push(o.value);
            c = e
          }
          for (s && 2 < f && (a = h(a, arguments[2], 2)), n = 0, r = O(c.length), i = It(this, r); n < r; n++) i[
            n] = s ? a(c[n], n) : c[n];
          return i
        },
        Rt = function () {
          for (var t = 0, n = arguments.length, r = It(this, n); t < n;) r[t] = arguments[t++];
          return r
        },
        Ct = !!z && x(function () {
          gt.call(new z(1))
        }),
        Dt = function () {
          return gt.apply(Ct ? dt.call(At(this)) : At(this), arguments)
        },
        Gt = {
          copyWithin: function (t, n) {
            return D.call(At(this), t, n, 2 < arguments.length ? arguments[2] : void 0)
          },
          every: function (t) {
            return rt(At(this), t, 1 < arguments.length ? arguments[1] : void 0)
          },
          fill: function (t) {
            return C.apply(At(this), arguments)
          },
          filter: function (t) {
            return Lt(this, tt(At(this), t, 1 < arguments.length ? arguments[1] : void 0))
          },
          find: function (t) {
            return et(At(this), t, 1 < arguments.length ? arguments[1] : void 0)
          },
          findIndex: function (t) {
            return it(At(this), t, 1 < arguments.length ? arguments[1] : void 0)
          },
          forEach: function (t) {
            Z(At(this), t, 1 < arguments.length ? arguments[1] : void 0)
          },
          indexOf: function (t) {
            return ut(At(this), t, 1 < arguments.length ? arguments[1] : void 0)
          },
          includes: function (t) {
            return ot(At(this), t, 1 < arguments.length ? arguments[1] : void 0)
          },
          join: function (t) {
            return vt.apply(At(this), arguments)
          },
          lastIndexOf: function (t) {
            return st.apply(At(this), arguments)
          },
          map: function (t) {
            return Mt(At(this), t, 1 < arguments.length ? arguments[1] : void 0)
          },
          reduce: function (t) {
            return lt.apply(At(this), arguments)
          },
          reduceRight: function (t) {
            return ht.apply(At(this), arguments)
          },
          reverse: function () {
            for (var t, n = this, r = At(n).length, e = Math.floor(r / 2), i = 0; i < e;) t = n[i], n[i++] = n[--
              r], n[r] = t;
            return n
          },
          some: function (t) {
            return nt(At(this), t, 1 < arguments.length ? arguments[1] : void 0)
          },
          sort: function (t) {
            return pt.call(At(this), t)
          },
          subarray: function (t, n) {
            var r = At(this),
              e = r.length,
              i = c(t, e);
            return new(L(r, r[St]))(r.buffer, r.byteOffset + i * r.BYTES_PER_ELEMENT, O((void 0 === n ? e : c(n,
              e)) - i))
          }
        },
        Wt = function (t, n) {
          return Lt(this, dt.call(At(this), t, n))
        },
        Ut = function (t) {
          At(this);
          var n = Ft(arguments[1], 1),
            r = this.length,
            e = v(t),
            i = O(e.length),
            o = 0;
          if (r < i + n) throw B(Et);
          for (; o < i;) this[n + o] = e[o++]
        },
        Vt = {
          entries: function () {
            return at.call(At(this))
          },
          keys: function () {
            return ft.call(At(this))
          },
          values: function () {
            return ct.call(At(this))
          }
        },
        Bt = function (t, n) {
          return P(t) && t[_t] && "symbol" != typeof n && n in t && String(+n) == String(n)
        },
        qt = function (t, n) {
          return Bt(t, n = f(n, !0)) ? i(2, t[n]) : V(t, n)
        },
        zt = function (t, n, r) {
          return !(Bt(t, n = f(n, !0)) && P(r) && a(r, "value")) || a(r, "get") || a(r, "set") || r.configurable ||
            a(r, "writable") && !r.writable || a(r, "enumerable") && !r.enumerable ? U(t, n, r) : (t[n] = r.value,
              t)
        };
      wt || (W.f = qt, G.f = zt), m(m.S + m.F * !wt, "Object", {
        getOwnPropertyDescriptor: qt,
        defineProperty: zt
      }), x(function () {
        yt.call({})
      }) && (yt = gt = function () {
        return vt.call(this)
      });
      var Kt = o({}, Gt);
      o(Kt, Vt), _(Kt, bt, Vt.values), o(Kt, {
        slice: Wt,
        set: Ut,
        constructor: function () {},
        toString: yt,
        toLocaleString: Dt
      }), Tt(Kt, "buffer", "b"), Tt(Kt, "byteOffset", "o"), Tt(Kt, "byteLength", "l"), Tt(Kt, "length", "e"), U(
        Kt, xt, {
          get: function () {
            return this[_t]
          }
        }), t.exports = function (t, l, n, o) {
        var h = t + ((o = !!o) ? "Clamped" : "") + "Array",
          r = "get" + t,
          u = "set" + t,
          v = b[h],
          c = v || {},
          e = v && F(v),
          i = !v || !S.ABV,
          f = {},
          a = v && v[$],
          p = function (t, i) {
            U(t, i, {
              get: function () {
                return t = i, (n = this._d).v[r](t * l + n.o, Pt);
                var t, n
              },
              set: function (t) {
                return n = i, r = t, e = this._d, o && (r = (r = Math.round(r)) < 0 ? 0 : 255 < r ? 255 :
                  255 & r), void e.v[u](n * l + e.o, r, Pt);
                var n, r, e
              },
              enumerable: !0
            })
          };
        i ? (v = n(function (t, n, r, e) {
          w(t, v, h, "_d");
          var i, o, u, c, f = 0,
            a = 0;
          if (P(n)) {
            if (!(n instanceof X || (c = M(n)) == K || c == H)) return _t in n ? Nt(v, n) : kt.call(v, n);
            i = n, a = Ft(r, l);
            var s = n.byteLength;
            if (void 0 === e) {
              if (s % l) throw B(Et);
              if ((o = s - a) < 0) throw B(Et)
            } else if (s < (o = O(e) * l) + a) throw B(Et);
            u = o / l
          } else u = E(n), i = new X(o = u * l);
          for (_(t, "_d", {
              b: i,
              o: a,
              l: o,
              e: u,
              v: new Q(i)
            }); f < u;) p(t, f++)
        }), a = v[$] = j(Kt), _(a, "constructor", v)) : x(function () {
          v(1)
        }) && x(function () {
          new v(-1)
        }) && k(function (t) {
          new v, new v(null), new v(1.5), new v(t)
        }, !0) || (v = n(function (t, n, r, e) {
          var i;
          return w(t, v, h), P(n) ? n instanceof X || (i = M(n)) == K || i == H ? void 0 !== e ? new c(n,
            Ft(r, l), e) : void 0 !== r ? new c(n, Ft(r, l)) : new c(n) : _t in n ? Nt(v, n) : kt.call(v,
            n) : new c(E(n))
        }), Z(e !== Function.prototype ? A(c).concat(A(e)) : A(c), function (t) {
          t in v || _(v, t, c[t])
        }), v[$] = a, g || (a.constructor = v));
        var s = a[bt],
          d = !!s && ("values" == s.name || null == s.name),
          y = Vt.values;
        _(v, mt, !0), _(a, _t, h), _(a, Ot, !0), _(a, St, v), (o ? new v(1)[xt] == h : xt in a) || U(a, xt, {
          get: function () {
            return h
          }
        }), f[h] = v, m(m.G + m.W + m.F * (v != c), f), m(m.S, h, {
          BYTES_PER_ELEMENT: l
        }), m(m.S + m.F * x(function () {
          c.of.call(v, 1)
        }), h, {
          from: kt,
          of: Rt
        }), J in a || _(a, J, l), m(m.P, h, Gt), R(h), m(m.P + m.F * jt, h, {
          set: Ut
        }), m(m.P + m.F * !d, h, Vt), g || a.toString == yt || (a.toString = yt), m(m.P + m.F * x(function () {
          new v(1).slice()
        }), h, {
          slice: Wt
        }), m(m.P + m.F * (x(function () {
          return [1, 2].toLocaleString() != new v([1, 2]).toLocaleString()
        }) || !x(function () {
          a.toLocaleString.call([1, 2])
        })), h, {
          toLocaleString: Dt
        }), T[h] = d ? s : y, g || d || _(a, bt, y)
      }
    } else t.exports = function () {}
  }, function (t, n) {
    var r = {}.toString;
    t.exports = function (t) {
      return r.call(t).slice(8, -1)
    }
  }, function (t, n, r) {
    var e = r(18),
      i = r(6).document,
      o = e(i) && e(i.createElement);
    t.exports = function (t) {
      return o ? i.createElement(t) : {}
    }
  }, function (t, n, r) {
    t.exports = !r(12) && !r(20)(function () {
      return 7 != Object.defineProperty(r(59)("div"), "a", {
        get: function () {
          return 7
        }
      }).a
    })
  }, function (t, n, r) {
    "use strict";
    var x = r(23),
      m = r(54),
      S = r(66),
      w = r(13),
      _ = r(36),
      O = r(98),
      E = r(38),
      M = r(104),
      P = r(16)("iterator"),
      j = !([].keys && "next" in [].keys()),
      F = "values",
      A = function () {
        return this
      };
    t.exports = function (t, n, r, e, i, o, u) {
      O(r, n, e);
      var c, f, a, s = function (t) {
          if (!j && t in p) return p[t];
          switch (t) {
            case "keys":
            case F:
              return function () {
                return new r(this, t)
              }
          }
          return function () {
            return new r(this, t)
          }
        },
        l = n + " Iterator",
        h = i == F,
        v = !1,
        p = t.prototype,
        d = p[P] || p["@@iterator"] || i && p[i],
        y = d || s(i),
        g = i ? h ? s("entries") : y : void 0,
        b = "Array" == n && p.entries || d;
      if (b && ((a = M(b.call(new t))) !== Object.prototype && a.next && (E(a, l, !0), x || "function" ==
          typeof a[P] || w(a, P, A))), h && d && d.name !== F && (v = !0, y = function () {
          return d.call(this)
        }), x && !u || !j && !v && p[P] || w(p, P, y), _[n] = y, _[l] = A, i)
        if (c = {
            values: h ? y : s(F),
            keys: o ? y : s("keys"),
            entries: g
          }, u)
          for (f in c) f in p || S(p, f, c[f]);
        else m(m.P + m.F * (j || v), n, c);
      return c
    }
  }, function (t, n, e) {
    var i = e(22),
      o = e(101),
      u = e(35),
      c = e(39)("IE_PROTO"),
      f = function () {},
      a = "prototype",
      s = function () {
        var t, n = e(59)("iframe"),
          r = u.length;
        for (n.style.display = "none", e(95).appendChild(n), n.src = "javascript:", (t = n.contentWindow.document)
          .open(), t.write("<script>document.F=Object<\/script>"), t.close(), s = t.F; r--;) delete s[a][u[r]];
        return s()
      };
    t.exports = Object.create || function (t, n) {
      var r;
      return null !== t ? (f[a] = i(t), r = new f, f[a] = null, r[c] = t) : r = s(), void 0 === n ? r : o(r, n)
    }
  }, function (t, n, r) {
    var e = r(65),
      i = r(35).concat("length", "prototype");
    n.f = Object.getOwnPropertyNames || function (t) {
      return e(t, i)
    }
  }, function (t, n) {
    n.f = Object.getOwnPropertySymbols
  }, function (t, n, r) {
    var u = r(9),
      c = r(15),
      f = r(92)(!1),
      a = r(39)("IE_PROTO");
    t.exports = function (t, n) {
      var r, e = c(t),
        i = 0,
        o = [];
      for (r in e) r != a && u(e, r) && o.push(r);
      for (; n.length > i;) u(e, r = n[i++]) && (~f(o, r) || o.push(r));
      return o
    }
  }, function (t, n, r) {
    t.exports = r(13)
  }, function (t, n, r) {
    var e = r(7)("unscopables"),
      i = Array.prototype;
    null == i[e] && r(26)(i, e, {}), t.exports = function (t) {
      i[e][t] = !0
    }
  }, function (t, n) {
    t.exports = !1
  }, function (t, n, r) {
    var e = r(79)("meta"),
      i = r(5),
      o = r(30),
      u = r(11).f,
      c = 0,
      f = Object.isExtensible || function () {
        return !0
      },
      a = !r(4)(function () {
        return f(Object.preventExtensions({}))
      }),
      s = function (t) {
        u(t, e, {
          value: {
            i: "O" + ++c,
            w: {}
          }
        })
      },
      l = t.exports = {
        KEY: e,
        NEED: !1,
        fastKey: function (t, n) {
          if (!i(t)) return "symbol" == typeof t ? t : ("string" == typeof t ? "S" : "P") + t;
          if (!o(t, e)) {
            if (!f(t)) return "F";
            if (!n) return "E";
            s(t)
          }
          return t[e].i
        },
        getWeak: function (t, n) {
          if (!o(t, e)) {
            if (!f(t)) return !0;
            if (!n) return !1;
            s(t)
          }
          return t[e].w
        },
        onFreeze: function (t) {
          return a && l.NEED && f(t) && !o(t, e) && s(t), t
        }
      }
  }, function (t, n) {
    t.exports = function (t, n, r, e) {
      if (!(t instanceof n) || void 0 !== e && e in t) throw TypeError(r + ": incorrect invocation!");
      return t
    }
  }, function (t, n, r) {
    var h = r(47),
      v = r(177),
      p = r(145),
      d = r(2),
      y = r(8),
      g = r(161),
      b = {},
      x = {};
    (n = t.exports = function (t, n, r, e, i) {
      var o, u, c, f, a = i ? function () {
          return t
        } : g(t),
        s = h(r, e, n ? 2 : 1),
        l = 0;
      if ("function" != typeof a) throw TypeError(t + " is not iterable!");
      if (p(a)) {
        for (o = y(t.length); l < o; l++)
          if ((f = n ? s(d(u = t[l])[0], u[1]) : s(t[l])) === b || f === x) return f
      } else
        for (c = a.call(t); !(u = c.next()).done;)
          if ((f = v(c, s, u.value, n)) === b || f === x) return f
    }).BREAK = b, n.RETURN = x
  }, function (t, n, e) {
    var i = e(2),
      o = e(183),
      u = e(141),
      c = e(154)("IE_PROTO"),
      f = function () {},
      a = "prototype",
      s = function () {
        var t, n = e(140)("iframe"),
          r = u.length;
        for (n.style.display = "none", e(143).appendChild(n), n.src = "javascript:", (t = n.contentWindow.document)
          .open(), t.write("<script>document.F=Object<\/script>"), t.close(), s = t.F; r--;) delete s[a][u[r]];
        return s()
      };
    t.exports = Object.create || function (t, n) {
      var r;
      return null !== t ? (f[a] = i(t), r = new f, f[a] = null, r[c] = t) : r = s(), void 0 === n ? r : o(r, n)
    }
  }, function (t, n, r) {
    var e = r(185),
      i = r(141).concat("length", "prototype");
    n.f = Object.getOwnPropertyNames || function (t) {
      return e(t, i)
    }
  }, function (t, n, r) {
    var e = r(185),
      i = r(141);
    t.exports = Object.keys || function (t) {
      return e(t, i)
    }
  }, function (t, n) {
    t.exports = function (t, n) {
      return {
        enumerable: !(1 & t),
        configurable: !(2 & t),
        writable: !(4 & t),
        value: n
      }
    }
  }, function (t, n, r) {
    var i = r(27);
    t.exports = function (t, n, r) {
      for (var e in n) i(t, e, n[e], r);
      return t
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(3),
      i = r(11),
      o = r(10),
      u = r(7)("species");
    t.exports = function (t) {
      var n = e[t];
      o && n && !n[u] && i.f(n, u, {
        configurable: !0,
        get: function () {
          return this
        }
      })
    }
  }, function (t, n, r) {
    var e = r(49),
      i = Math.max,
      o = Math.min;
    t.exports = function (t, n) {
      return (t = e(t)) < 0 ? i(t + n, 0) : o(t, n)
    }
  }, function (t, n) {
    var r = 0,
      e = Math.random();
    t.exports = function (t) {
      return "Symbol(".concat(void 0 === t ? "" : t, ")_", (++r + e).toString(36))
    }
  }, function (t, n, r) {
    var e = r(5);
    t.exports = function (t, n) {
      if (!e(t) || t._t !== n) throw TypeError("Incompatible receiver, " + n + " required!");
      return t
    }
  }, function (t, n, r) {
    var i = r(45),
      o = r(7)("toStringTag"),
      u = "Arguments" == i(function () {
        return arguments
      }());
    t.exports = function (t) {
      var n, r, e;
      return void 0 === t ? "Undefined" : null === t ? "Null" : "string" == typeof (r = function (t, n) {
          try {
            return t[n]
          } catch (t) {}
        }(n = Object(t), o)) ? r : u ? i(n) : "Object" == (e = i(n)) && "function" == typeof n.callee ?
        "Arguments" : e
    }
  }, function (t, n) {
    t.exports = {}
  }, function (t, n, r) {
    var e = r(11).f,
      i = r(30),
      o = r(7)("toStringTag");
    t.exports = function (t, n, r) {
      t && !i(t = r ? t : t.prototype, o) && e(t, o, {
        configurable: !0,
        value: n
      })
    }
  }, function (t, n, r) {
    var u = r(1),
      e = r(51),
      c = r(4),
      f = r(157),
      i = "[" + f + "]",
      o = RegExp("^" + i + i + "*"),
      a = RegExp(i + i + "*$"),
      s = function (t, n, r) {
        var e = {},
          i = c(function () {
            return !!f[t]() || "​" != "​" [t]()
          }),
          o = e[t] = i ? n(l) : f[t];
        r && (e[r] = o), u(u.P + u.F * i, "String", e)
      },
      l = s.trim = function (t, n) {
        return t = String(e(t)), 1 & n && (t = t.replace(o, "")), 2 & n && (t = t.replace(a, "")), t
      };
    t.exports = s
  }, function (t, n, r) {
    t.exports = {
      default: r(88),
      __esModule: !0
    }
  }, function (t, n, r) {
    t.exports = {
      default: r(89),
      __esModule: !0
    }
  }, function (t, n, r) {
    "use strict";

    function e(t) {
      return t && t.__esModule ? t : {
        default: t
      }
    }
    n.__esModule = !0;
    var i = e(r(86)),
      o = e(r(85)),
      u = "function" == typeof o.default && "symbol" == typeof i.default ? function (t) {
        return typeof t
      } : function (t) {
        return t && "function" == typeof o.default && t.constructor === o.default && t !== o.default.prototype ?
          "symbol" : typeof t
      };
    n.default = "function" == typeof o.default && "symbol" === u(i.default) ? function (t) {
      return void 0 === t ? "undefined" : u(t)
    } : function (t) {
      return t && "function" == typeof o.default && t.constructor === o.default && t !== o.default.prototype ?
        "symbol" : void 0 === t ? "undefined" : u(t)
    }
  }, function (t, n, r) {
    r(111), r(109), r(112), r(113), t.exports = r(19).Symbol
  }, function (t, n, r) {
    r(110), r(114), t.exports = r(44).f("iterator")
  }, function (t, n) {
    t.exports = function (t) {
      if ("function" != typeof t) throw TypeError(t + " is not a function!");
      return t
    }
  }, function (t, n) {
    t.exports = function () {}
  }, function (t, n, r) {
    var f = r(15),
      a = r(107),
      s = r(106);
    t.exports = function (c) {
      return function (t, n, r) {
        var e, i = f(t),
          o = a(i.length),
          u = s(r, o);
        if (c && n != n) {
          for (; u < o;)
            if ((e = i[u++]) != e) return !0
        } else
          for (; u < o; u++)
            if ((c || u in i) && i[u] === n) return c || u || 0;
        return !c && -1
      }
    }
  }, function (t, n, r) {
    var o = r(90);
    t.exports = function (e, i, t) {
      if (o(e), void 0 === i) return e;
      switch (t) {
        case 1:
          return function (t) {
            return e.call(i, t)
          };
        case 2:
          return function (t, n) {
            return e.call(i, t, n)
          };
        case 3:
          return function (t, n, r) {
            return e.call(i, t, n, r)
          }
      }
      return function () {
        return e.apply(i, arguments)
      }
    }
  }, function (t, n, r) {
    var c = r(29),
      f = r(64),
      a = r(37);
    t.exports = function (t) {
      var n = c(t),
        r = f.f;
      if (r)
        for (var e, i = r(t), o = a.f, u = 0; i.length > u;) o.call(t, e = i[u++]) && n.push(e);
      return n
    }
  }, function (t, n, r) {
    var e = r(6).document;
    t.exports = e && e.documentElement
  }, function (t, n, r) {
    var e = r(58);
    t.exports = Object("z").propertyIsEnumerable(0) ? Object : function (t) {
      return "String" == e(t) ? t.split("") : Object(t)
    }
  }, function (t, n, r) {
    var e = r(58);
    t.exports = Array.isArray || function (t) {
      return "Array" == e(t)
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(62),
      i = r(24),
      o = r(38),
      u = {};
    r(13)(u, r(16)("iterator"), function () {
      return this
    }), t.exports = function (t, n, r) {
      t.prototype = e(u, {
        next: i(1, r)
      }), o(t, n + " Iterator")
    }
  }, function (t, n) {
    t.exports = function (t, n) {
      return {
        value: n,
        done: !!t
      }
    }
  }, function (t, n, r) {
    var e = r(25)("meta"),
      i = r(18),
      o = r(9),
      u = r(14).f,
      c = 0,
      f = Object.isExtensible || function () {
        return !0
      },
      a = !r(20)(function () {
        return f(Object.preventExtensions({}))
      }),
      s = function (t) {
        u(t, e, {
          value: {
            i: "O" + ++c,
            w: {}
          }
        })
      },
      l = t.exports = {
        KEY: e,
        NEED: !1,
        fastKey: function (t, n) {
          if (!i(t)) return "symbol" == typeof t ? t : ("string" == typeof t ? "S" : "P") + t;
          if (!o(t, e)) {
            if (!f(t)) return "F";
            if (!n) return "E";
            s(t)
          }
          return t[e].i
        },
        getWeak: function (t, n) {
          if (!o(t, e)) {
            if (!f(t)) return !0;
            if (!n) return !1;
            s(t)
          }
          return t[e].w
        },
        onFreeze: function (t) {
          return a && l.NEED && f(t) && !o(t, e) && s(t), t
        }
      }
  }, function (t, n, r) {
    var u = r(14),
      c = r(22),
      f = r(29);
    t.exports = r(12) ? Object.defineProperties : function (t, n) {
      c(t);
      for (var r, e = f(n), i = e.length, o = 0; o < i;) u.f(t, r = e[o++], n[r]);
      return t
    }
  }, function (t, n, r) {
    var e = r(37),
      i = r(24),
      o = r(15),
      u = r(42),
      c = r(9),
      f = r(60),
      a = Object.getOwnPropertyDescriptor;
    n.f = r(12) ? a : function (t, n) {
      if (t = o(t), n = u(n, !0), f) try {
        return a(t, n)
      } catch (t) {}
      if (c(t, n)) return i(!e.f.call(t, n), t[n])
    }
  }, function (t, n, r) {
    var e = r(15),
      i = r(63).f,
      o = {}.toString,
      u = "object" == typeof window && window && Object.getOwnPropertyNames ? Object.getOwnPropertyNames(window) :
      [];
    t.exports.f = function (t) {
      return u && "[object Window]" == o.call(t) ? function (t) {
        try {
          return i(t)
        } catch (t) {
          return u.slice()
        }
      }(t) : i(e(t))
    }
  }, function (t, n, r) {
    var e = r(9),
      i = r(55),
      o = r(39)("IE_PROTO"),
      u = Object.prototype;
    t.exports = Object.getPrototypeOf || function (t) {
      return t = i(t), e(t, o) ? t[o] : "function" == typeof t.constructor && t instanceof t.constructor ? t
        .constructor.prototype : t instanceof Object ? u : null
    }
  }, function (t, n, r) {
    var f = r(41),
      a = r(34);
    t.exports = function (c) {
      return function (t, n) {
        var r, e, i = String(a(t)),
          o = f(n),
          u = i.length;
        return o < 0 || u <= o ? c ? "" : void 0 : (r = i.charCodeAt(o)) < 55296 || 56319 < r || o + 1 === u ||
          (e = i.charCodeAt(o + 1)) < 56320 || 57343 < e ? c ? i.charAt(o) : r : c ? i.slice(o, o + 2) : e -
          56320 + (r - 55296 << 10) + 65536
      }
    }
  }, function (t, n, r) {
    var e = r(41),
      i = Math.max,
      o = Math.min;
    t.exports = function (t, n) {
      return (t = e(t)) < 0 ? i(t + n, 0) : o(t, n)
    }
  }, function (t, n, r) {
    var e = r(41),
      i = Math.min;
    t.exports = function (t) {
      return 0 < t ? i(e(t), 9007199254740991) : 0
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(91),
      i = r(99),
      o = r(36),
      u = r(15);
    t.exports = r(61)(Array, "Array", function (t, n) {
      this._t = u(t), this._i = 0, this._k = n
    }, function () {
      var t = this._t,
        n = this._k,
        r = this._i++;
      return !t || r >= t.length ? (this._t = void 0, i(1)) : i(0, "keys" == n ? r : "values" == n ? t[r] : [r,
        t[r]
      ])
    }, "values"), o.Arguments = o.Array, e("keys"), e("values"), e("entries")
  }, function (t, n) {}, function (t, n, r) {
    "use strict";
    var e = r(105)(!0);
    r(61)(String, "String", function (t) {
      this._t = String(t), this._i = 0
    }, function () {
      var t, n = this._t,
        r = this._i;
      return r >= n.length ? {
        value: void 0,
        done: !0
      } : (t = e(n, r), this._i += t.length, {
        value: t,
        done: !1
      })
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(6),
      u = r(9),
      i = r(12),
      o = r(54),
      c = r(66),
      f = r(100).KEY,
      a = r(20),
      s = r(40),
      l = r(38),
      h = r(25),
      v = r(16),
      p = r(44),
      d = r(43),
      y = r(94),
      g = r(97),
      b = r(22),
      x = r(18),
      m = r(55),
      S = r(15),
      w = r(42),
      _ = r(24),
      O = r(62),
      E = r(103),
      M = r(102),
      P = r(64),
      j = r(14),
      F = r(29),
      A = M.f,
      I = j.f,
      L = E.f,
      N = e.Symbol,
      T = e.JSON,
      k = T && T.stringify,
      R = "prototype",
      C = v("_hidden"),
      D = v("toPrimitive"),
      G = {}.propertyIsEnumerable,
      W = s("symbol-registry"),
      U = s("symbols"),
      V = s("op-symbols"),
      B = Object[R],
      q = "function" == typeof N && !!P.f,
      z = e.QObject,
      K = !z || !z[R] || !z[R].findChild,
      H = i && a(function () {
        return 7 != O(I({}, "a", {
          get: function () {
            return I(this, "a", {
              value: 7
            }).a
          }
        })).a
      }) ? function (t, n, r) {
        var e = A(B, n);
        e && delete B[n], I(t, n, r), e && t !== B && I(B, n, e)
      } : I,
      J = function (t) {
        var n = U[t] = O(N[R]);
        return n._k = t, n
      },
      $ = q && "symbol" == typeof N.iterator ? function (t) {
        return "symbol" == typeof t
      } : function (t) {
        return t instanceof N
      },
      Y = function (t, n, r) {
        return t === B && Y(V, n, r), b(t), n = w(n, !0), b(r), u(U, n) ? (r.enumerable ? (u(t, C) && t[C][n] && (t[
          C][n] = !1), r = O(r, {
          enumerable: _(0, !1)
        })) : (u(t, C) || I(t, C, _(1, {})), t[C][n] = !0), H(t, n, r)) : I(t, n, r)
      },
      X = function (t, n) {
        b(t);
        for (var r, e = y(n = S(n)), i = 0, o = e.length; i < o;) Y(t, r = e[i++], n[r]);
        return t
      },
      Q = function (t) {
        var n = G.call(this, t = w(t, !0));
        return !(this === B && u(U, t) && !u(V, t)) && (!(n || !u(this, t) || !u(U, t) || u(this, C) && this[C][
          t]) || n)
      },
      Z = function (t, n) {
        if (t = S(t), n = w(n, !0), t !== B || !u(U, n) || u(V, n)) {
          var r = A(t, n);
          return !r || !u(U, n) || u(t, C) && t[C][n] || (r.enumerable = !0), r
        }
      },
      tt = function (t) {
        for (var n, r = L(S(t)), e = [], i = 0; r.length > i;) u(U, n = r[i++]) || n == C || n == f || e.push(n);
        return e
      },
      nt = function (t) {
        for (var n, r = t === B, e = L(r ? V : S(t)), i = [], o = 0; e.length > o;) !u(U, n = e[o++]) || r && !u(B,
          n) || i.push(U[n]);
        return i
      };
    q || (c((N = function () {
      if (this instanceof N) throw TypeError("Symbol is not a constructor!");
      var n = h(0 < arguments.length ? arguments[0] : void 0),
        r = function (t) {
          this === B && r.call(V, t), u(this, C) && u(this[C], n) && (this[C][n] = !1), H(this, n, _(1, t))
        };
      return i && K && H(B, n, {
        configurable: !0,
        set: r
      }), J(n)
    })[R], "toString", function () {
      return this._k
    }), M.f = Z, j.f = Y, r(63).f = E.f = tt, r(37).f = Q, P.f = nt, i && !r(23) && c(B, "propertyIsEnumerable",
      Q, !0), p.f = function (t) {
      return J(v(t))
    }), o(o.G + o.W + o.F * !q, {
      Symbol: N
    });
    for (var rt =
        "hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables"
        .split(","), et = 0; rt.length > et;) v(rt[et++]);
    for (var it = F(v.store), ot = 0; it.length > ot;) d(it[ot++]);
    o(o.S + o.F * !q, "Symbol", {
      for: function (t) {
        return u(W, t += "") ? W[t] : W[t] = N(t)
      },
      keyFor: function (t) {
        if (!$(t)) throw TypeError(t + " is not a symbol!");
        for (var n in W)
          if (W[n] === t) return n
      },
      useSetter: function () {
        K = !0
      },
      useSimple: function () {
        K = !1
      }
    }), o(o.S + o.F * !q, "Object", {
      create: function (t, n) {
        return void 0 === n ? O(t) : X(O(t), n)
      },
      defineProperty: Y,
      defineProperties: X,
      getOwnPropertyDescriptor: Z,
      getOwnPropertyNames: tt,
      getOwnPropertySymbols: nt
    });
    var ut = a(function () {
      P.f(1)
    });
    o(o.S + o.F * ut, "Object", {
      getOwnPropertySymbols: function (t) {
        return P.f(m(t))
      }
    }), T && o(o.S + o.F * (!q || a(function () {
      var t = N();
      return "[null]" != k([t]) || "{}" != k({
        a: t
      }) || "{}" != k(Object(t))
    })), "JSON", {
      stringify: function (t) {
        for (var n, r, e = [t], i = 1; arguments.length > i;) e.push(arguments[i++]);
        if (r = n = e[1], (x(n) || void 0 !== t) && !$(t)) return g(n) || (n = function (t, n) {
          if ("function" == typeof r && (n = r.call(this, t, n)), !$(n)) return n
        }), e[1] = n, k.apply(T, e)
      }
    }), N[R][D] || r(13)(N[R], D, N[R].valueOf), l(N, "Symbol"), l(Math, "Math", !0), l(e.JSON, "JSON", !0)
  }, function (t, n, r) {
    r(43)("asyncIterator")
  }, function (t, n, r) {
    r(43)("observable")
  }, function (t, n, r) {
    r(108);
    for (var e = r(6), i = r(13), o = r(36), u = r(16)("toStringTag"), c =
        "CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList"
        .split(","), f = 0; f < c.length; f++) {
      var a = c[f],
        s = e[a],
        l = s && s.prototype;
      l && !l[u] && i(l, u, a), o[a] = o.Array
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(2);
    t.exports = function () {
      var t = e(this),
        n = "";
      return t.global && (n += "g"), t.ignoreCase && (n += "i"), t.multiline && (n += "m"), t.unicode && (n +=
        "u"), t.sticky && (n += "y"), n
    }
  }, function (t, n, r) {
    var e = r(45);
    t.exports = Object("z").propertyIsEnumerable(0) ? Object : function (t) {
      return "String" == e(t) ? t.split("") : Object(t)
    }
  }, function (t, n) {
    n.f = {}.propertyIsEnumerable
  }, function (t, n, r) {
    var e = r(46),
      i = r(3),
      o = "__core-js_shared__",
      u = i[o] || (i[o] = {});
    (t.exports = function (t, n) {
      return u[t] || (u[t] = void 0 !== n ? n : {})
    })("versions", []).push({
      version: e.version,
      mode: r(68) ? "pure" : "global",
      copyright: "© 2019 Denis Pushkarev (zloirock.ru)"
    })
  }, function (t, n, r) {
    var i = r(2),
      o = r(21),
      u = r(7)("species");
    t.exports = function (t, n) {
      var r, e = i(t).constructor;
      return void 0 === e || null == (r = i(e)[u]) ? n : o(r)
    }
  }, function (t, n, r) {
    var f = r(33),
      a = r(8),
      s = r(78);
    t.exports = function (c) {
      return function (t, n, r) {
        var e, i = f(t),
          o = a(i.length),
          u = s(r, o);
        if (c && n != n) {
          for (; u < o;)
            if ((e = i[u++]) != e) return !0
        } else
          for (; u < o; u++)
            if ((c || u in i) && i[u] === n) return c || u || 0;
        return !c && -1
      }
    }
  }, function (t, n, r) {
    "use strict";
    var g = r(3),
      b = r(1),
      x = r(27),
      m = r(76),
      S = r(69),
      w = r(71),
      _ = r(70),
      O = r(5),
      E = r(4),
      M = r(125),
      P = r(83),
      j = r(144);
    t.exports = function (e, t, n, r, i, o) {
      var u = g[e],
        c = u,
        f = i ? "set" : "add",
        a = c && c.prototype,
        s = {},
        l = function (t) {
          var r = a[t];
          x(a, t, "delete" == t ? function (t) {
            return !(o && !O(t)) && r.call(this, 0 === t ? 0 : t)
          } : "has" == t ? function (t) {
            return !(o && !O(t)) && r.call(this, 0 === t ? 0 : t)
          } : "get" == t ? function (t) {
            return o && !O(t) ? void 0 : r.call(this, 0 === t ? 0 : t)
          } : "add" == t ? function (t) {
            return r.call(this, 0 === t ? 0 : t), this
          } : function (t, n) {
            return r.call(this, 0 === t ? 0 : t, n), this
          })
        };
      if ("function" == typeof c && (o || a.forEach && !E(function () {
          (new c).entries().next()
        }))) {
        var h = new c,
          v = h[f](o ? {} : -0, 1) != h,
          p = E(function () {
            h.has(1)
          }),
          d = M(function (t) {
            new c(t)
          }),
          y = !o && E(function () {
            for (var t = new c, n = 5; n--;) t[f](n, n);
            return !t.has(-0)
          });
        d || (((c = t(function (t, n) {
          _(t, c, e);
          var r = j(new u, t, c);
          return null != n && w(n, i, r[f], r), r
        })).prototype = a).constructor = c), (p || y) && (l("delete"), l("has"), i && l("get")), (y || v) && l(
          f), o && a.clear && delete a.clear
      } else c = r.getConstructor(t, e, i, f), m(c.prototype, n), S.NEED = !0;
      return P(c, e), s[e] = c, b(b.G + b.W + b.F * (c != u), s), o || r.setStrong(c, e, i), c
    }
  }, function (t, n, r) {
    "use strict";
    r(197);
    var s = r(27),
      l = r(26),
      h = r(4),
      v = r(51),
      p = r(7),
      d = r(152),
      y = p("species"),
      g = !h(function () {
        var t = /./;
        return t.exec = function () {
          var t = [];
          return t.groups = {
            a: "7"
          }, t
        }, "7" !== "".replace(t, "$<a>")
      }),
      b = function () {
        var t = /(?:)/,
          n = t.exec;
        t.exec = function () {
          return n.apply(this, arguments)
        };
        var r = "ab".split(t);
        return 2 === r.length && "a" === r[0] && "b" === r[1]
      }();
    t.exports = function (r, t, n) {
      var e = p(r),
        o = !h(function () {
          var t = {};
          return t[e] = function () {
            return 7
          }, 7 != "" [r](t)
        }),
        i = o ? !h(function () {
          var t = !1,
            n = /a/;
          return n.exec = function () {
            return t = !0, null
          }, "split" === r && (n.constructor = {}, n.constructor[y] = function () {
            return n
          }), n[e](""), !t
        }) : void 0;
      if (!o || !i || "replace" === r && !g || "split" === r && !b) {
        var u = /./ [e],
          c = n(v, e, "" [r], function (t, n, r, e, i) {
            return n.exec === d ? o && !i ? {
              done: !0,
              value: u.call(n, r, e)
            } : {
              done: !0,
              value: t.call(r, n, e)
            } : {
              done: !1
            }
          }),
          f = c[0],
          a = c[1];
        s(String.prototype, r, f), l(RegExp.prototype, e, 2 == t ? function (t, n) {
          return a.call(t, this, n)
        } : function (t) {
          return a.call(t, this)
        })
      }
    }
  }, function (t, n, r) {
    var e = r(45);
    t.exports = Array.isArray || function (t) {
      return "Array" == e(t)
    }
  }, function (t, n, r) {
    var e = r(5),
      i = r(45),
      o = r(7)("match");
    t.exports = function (t) {
      var n;
      return e(t) && (void 0 !== (n = t[o]) ? !!n : "RegExp" == i(t))
    }
  }, function (t, n, r) {
    var o = r(7)("iterator"),
      u = !1;
    try {
      var e = [7][o]();
      e.return = function () {
        u = !0
      }, Array.from(e, function () {
        throw 2
      })
    } catch (t) {}
    t.exports = function (t, n) {
      if (!n && !u) return !1;
      var r = !1;
      try {
        var e = [7],
          i = e[o]();
        i.next = function () {
          return {
            done: r = !0
          }
        }, e[o] = function () {
          return i
        }, t(e)
      } catch (t) {}
      return r
    }
  }, function (t, n, r) {
    "use strict";
    t.exports = r(68) || !r(4)(function () {
      var t = Math.random();
      __defineSetter__.call(null, t, function () {}), delete r(3)[t]
    })
  }, function (t, n) {
    n.f = Object.getOwnPropertySymbols
  }, function (t, n, r) {
    "use strict";
    var i = r(81),
      o = RegExp.prototype.exec;
    t.exports = function (t, n) {
      var r = t.exec;
      if ("function" == typeof r) {
        var e = r.call(t, n);
        if ("object" != typeof e) throw new TypeError(
          "RegExp exec method returned something other than an Object or null");
        return e
      }
      if ("RegExp" !== i(t)) throw new TypeError("RegExp#exec called on incompatible receiver");
      return o.call(t, n)
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      u = r(21),
      c = r(47),
      f = r(71);
    t.exports = function (t) {
      e(e.S, t, {
        from: function (t) {
          var n, r, e, i, o = arguments[1];
          return u(this), (n = void 0 !== o) && u(o), null == t ? new this : (r = [], n ? (e = 0, i = c(o,
            arguments[2], 2), f(t, !1, function (t) {
            r.push(i(t, e++))
          })) : f(t, !1, r.push, r), new this(r))
        }
      })
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(1);
    t.exports = function (t) {
      e(e.S, t, {
        of: function () {
          for (var t = arguments.length, n = new Array(t); t--;) n[t] = arguments[t];
          return new this(n)
        }
      })
    }
  }, function (t, n, r) {
    var f = r(49),
      a = r(51);
    t.exports = function (c) {
      return function (t, n) {
        var r, e, i = String(a(t)),
          o = f(n),
          u = i.length;
        return o < 0 || u <= o ? c ? "" : void 0 : (r = i.charCodeAt(o)) < 55296 || 56319 < r || o + 1 === u ||
          (e = i.charCodeAt(o + 1)) < 56320 || 57343 < e ? c ? i.charAt(o) : r : c ? i.slice(o, o + 2) : e -
          56320 + (r - 55296 << 10) + 65536
      }
    }
  }, function (t, n, r) {
    for (var e, i = r(3), o = r(26), u = r(79), c = u("typed_array"), f = u("view"), a = !(!i.ArrayBuffer || !i
          .DataView), s = a, l = 0, h =
        "Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array"
        .split(","); l < 9;)(e = i[h[l++]]) ? (o(e.prototype, c, !0), o(e.prototype, f, !0)) : s = !1;
    t.exports = {
      ABV: a,
      CONSTR: s,
      TYPED: c,
      VIEW: f
    }
  }, function (t, n, r) {
    var e = r(3).navigator;
    t.exports = e && e.userAgent || ""
  }, function (t, n) {
    "use strict";
    var r, e = {
      versions: (r = window.navigator.userAgent, {
        trident: -1 < r.indexOf("Trident"),
        presto: -1 < r.indexOf("Presto"),
        webKit: -1 < r.indexOf("AppleWebKit"),
        gecko: -1 < r.indexOf("Gecko") && -1 == r.indexOf("KHTML"),
        mobile: !!r.match(/AppleWebKit.*Mobile.*/),
        ios: !!r.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),
        android: -1 < r.indexOf("Android") || -1 < r.indexOf("Linux"),
        iPhone: -1 < r.indexOf("iPhone") || -1 < r.indexOf("Mac"),
        iPad: -1 < r.indexOf("iPad"),
        webApp: -1 == r.indexOf("Safari"),
        weixin: -1 == r.indexOf("MicroMessenger")
      })
    };
    t.exports = e
  }, function (t, n, r) {
    "use strict";
    var e, i = r(87),
      l = (e = i) && e.__esModule ? e : {
        default: e
      },
      h = function () {
        function n(t, n, r) {
          return n || r ? String.fromCharCode(n || r) : o[t] || t
        }

        function r(t) {
          return s[t]
        }
        var e = /&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,
          i = /['<> "&]/g,
          o = {
            "&quot;": '"',
            "&lt;": "<",
            "&gt;": ">",
            "&amp;": "&",
            "&nbsp;": " "
          },
          u = /\u00a0/g,
          c = /<br\s*\/?>/gi,
          f = /\r?\n/g,
          a = /\s/g,
          s = {};
        for (var t in o) s[o[t]] = t;
        return o["&apos;"] = "'", s["'"] = "&#39;", {
          encode: function (t) {
            return t ? ("" + t).replace(i, r).replace(f, "<br/>").replace(a, "&nbsp;") : ""
          },
          decode: function (t) {
            return t ? ("" + t).replace(c, "\n").replace(e, n).replace(u, " ") : ""
          },
          encodeBase16: function (t) {
            if (!t) return t;
            for (var n = [], r = 0, e = (t += "").length; r < e; r++) n.push(t.charCodeAt(r).toString(16)
              .toUpperCase());
            return n.join("")
          },
          encodeBase16forJSON: function (t) {
            if (!t) return t;
            for (var n = [], r = 0, e = (t = t.replace(/[\u4E00-\u9FBF]/gi, function (t) {
                return escape(t).replace("%u", "\\u")
              })).length; r < e; r++) n.push(t.charCodeAt(r).toString(16).toUpperCase());
            return n.join("")
          },
          decodeBase16: function (t) {
            if (!t) return t;
            for (var n = [], r = 0, e = (t += "").length; r < e; r += 2) n.push(String.fromCharCode("0x" + t
              .slice(r, r + 2)));
            return n.join("")
          },
          encodeObject: function (t) {
            if (t instanceof Array)
              for (var n = 0, r = t.length; n < r; n++) t[n] = h.encodeObject(t[n]);
            else if ("object" == (void 0 === t ? "undefined" : (0, l.default)(t)))
              for (var e in t) t[e] = h.encodeObject(t[e]);
            else if ("string" == typeof t) return h.encode(t);
            return t
          },
          loadScript: function (t) {
            var n = document.createElement("script");
            document.getElementsByTagName("body")[0].appendChild(n), n.setAttribute("src", t)
          },
          addLoadEvent: function (t) {
            var n = window.onload;
            "function" != typeof window.onload ? window.onload = t : window.onload = function () {
              n(), t()
            }
          }
        }
      }();
    t.exports = h
  }, function (t, n, r) {
    "use strict";
    var e = r(131)(!0);
    t.exports = function (t, n, r) {
      return n + (r ? e(t, n).length : 1)
    }
  }, function (t, n, r) {
    "use strict";
    var c = r(17),
      f = r(78),
      a = r(8);
    t.exports = function (t) {
      for (var n = c(this), r = a(n.length), e = arguments.length, i = f(1 < e ? arguments[1] : void 0, r), o =
          2 < e ? arguments[2] : void 0, u = void 0 === o ? r : f(o, r); i < u;) n[i++] = t;
      return n
    }
  }, function (t, n, r) {
    var e = r(215);
    t.exports = function (t, n) {
      return new(e(t))(n)
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(11),
      i = r(75);
    t.exports = function (t, n, r) {
      n in t ? e.f(t, n, i(0, r)) : t[n] = r
    }
  }, function (t, n, r) {
    var e = r(5),
      i = r(3).document,
      o = e(i) && e(i.createElement);
    t.exports = function (t) {
      return o ? i.createElement(t) : {}
    }
  }, function (t, n) {
    t.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf"
      .split(",")
  }, function (t, n, r) {
    var e = r(7)("match");
    t.exports = function (n) {
      var r = /./;
      try {
        "/./" [n](r)
      } catch (t) {
        try {
          return r[e] = !1, !"/./" [n](r)
        } catch (n) {}
      }
      return !0
    }
  }, function (t, n, r) {
    var e = r(3).document;
    t.exports = e && e.documentElement
  }, function (t, n, r) {
    var o = r(5),
      u = r(153).set;
    t.exports = function (t, n, r) {
      var e, i = n.constructor;
      return i !== r && "function" == typeof i && (e = i.prototype) !== r.prototype && o(e) && u && u(t, e), t
    }
  }, function (t, n, r) {
    var e = r(82),
      i = r(7)("iterator"),
      o = Array.prototype;
    t.exports = function (t) {
      return void 0 !== t && (e.Array === t || o[i] === t)
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(72),
      i = r(75),
      o = r(83),
      u = {};
    r(26)(u, r(7)("iterator"), function () {
      return this
    }), t.exports = function (t, n, r) {
      t.prototype = e(u, {
        next: i(1, r)
      }), o(t, n + " Iterator")
    }
  }, function (t, n, r) {
    "use strict";
    var x = r(68),
      m = r(1),
      S = r(27),
      w = r(26),
      _ = r(82),
      O = r(146),
      E = r(83),
      M = r(32),
      P = r(7)("iterator"),
      j = !([].keys && "next" in [].keys()),
      F = "values",
      A = function () {
        return this
      };
    t.exports = function (t, n, r, e, i, o, u) {
      O(r, n, e);
      var c, f, a, s = function (t) {
          if (!j && t in p) return p[t];
          switch (t) {
            case "keys":
            case F:
              return function () {
                return new r(this, t)
              }
          }
          return function () {
            return new r(this, t)
          }
        },
        l = n + " Iterator",
        h = i == F,
        v = !1,
        p = t.prototype,
        d = p[P] || p["@@iterator"] || i && p[i],
        y = d || s(i),
        g = i ? h ? s("entries") : y : void 0,
        b = "Array" == n && p.entries || d;
      if (b && ((a = M(b.call(new t))) !== Object.prototype && a.next && (E(a, l, !0), x || "function" ==
          typeof a[P] || w(a, P, A))), h && d && d.name !== F && (v = !0, y = function () {
          return d.call(this)
        }), x && !u || !j && !v && p[P] || w(p, P, y), _[n] = y, _[l] = A, i)
        if (c = {
            values: h ? y : s(F),
            keys: o ? y : s("keys"),
            entries: g
          }, u)
          for (f in c) f in p || S(p, f, c[f]);
        else m(m.P + m.F * (j || v), n, c);
      return c
    }
  }, function (t, n) {
    var r = Math.expm1;
    t.exports = !r || 22025.465794806718 < r(10) || r(10) < 22025.465794806718 || -2e-17 != r(-2e-17) ? function (
    t) {
      return 0 == (t = +t) ? t : -1e-6 < t && t < 1e-6 ? t + t * t / 2 : Math.exp(t) - 1
    } : r
  }, function (t, n) {
    t.exports = Math.sign || function (t) {
      return 0 == (t = +t) || t != t ? t : t < 0 ? -1 : 1
    }
  }, function (t, n, r) {
    var c = r(3),
      f = r(158).set,
      a = c.MutationObserver || c.WebKitMutationObserver,
      s = c.process,
      l = c.Promise,
      h = "process" == r(45)(s);
    t.exports = function () {
      var r, e, i, t = function () {
        var t, n;
        for (h && (t = s.domain) && t.exit(); r;) {
          n = r.fn, r = r.next;
          try {
            n()
          } catch (t) {
            throw r ? i() : e = void 0, t
          }
        }
        e = void 0, t && t.enter()
      };
      if (h) i = function () {
        s.nextTick(t)
      };
      else if (!a || c.navigator && c.navigator.standalone)
        if (l && l.resolve) {
          var n = l.resolve(void 0);
          i = function () {
            n.then(t)
          }
        } else i = function () {
          f.call(c, t)
        };
      else {
        var o = !0,
          u = document.createTextNode("");
        new a(t).observe(u, {
          characterData: !0
        }), i = function () {
          u.data = o = !o
        }
      }
      return function (t) {
        var n = {
          fn: t,
          next: void 0
        };
        e && (e.next = n), r || (r = n, i()), e = n
      }
    }
  }, function (t, n, r) {
    "use strict";

    function e(t) {
      var r, e;
      this.promise = new t(function (t, n) {
        if (void 0 !== r || void 0 !== e) throw TypeError("Bad Promise constructor");
        r = t, e = n
      }), this.resolve = i(r), this.reject = i(e)
    }
    var i = r(21);
    t.exports.f = function (t) {
      return new e(t)
    }
  }, function (t, n, r) {
    "use strict";
    var e, i, u = r(115),
      c = RegExp.prototype.exec,
      f = String.prototype.replace,
      o = c,
      a = "lastIndex",
      s = (e = /a/, i = /b*/g, c.call(e, "a"), c.call(i, "a"), 0 !== e[a] || 0 !== i[a]),
      l = void 0 !== /()??/.exec("")[1];
    (s || l) && (o = function (t) {
      var n, r, e, i, o = this;
      return l && (r = new RegExp("^" + o.source + "$(?!\\s)", u.call(o))), s && (n = o[a]), e = c.call(o, t),
        s && e && (o[a] = o.global ? e.index + e[0].length : n), l && e && 1 < e.length && f.call(e[0], r,
          function () {
            for (i = 1; i < arguments.length - 2; i++) void 0 === arguments[i] && (e[i] = void 0)
          }), e
    }), t.exports = o
  }, function (t, n, i) {
    var r = i(5),
      e = i(2),
      o = function (t, n) {
        if (e(t), !r(n) && null !== n) throw TypeError(n + ": can't set as prototype!")
      };
    t.exports = {
      set: Object.setPrototypeOf || ("__proto__" in {} ? function (t, r, e) {
        try {
          (e = i(47)(Function.call, i(31).f(Object.prototype, "__proto__").set, 2))(t, []), r = !(
            t instanceof Array)
        } catch (t) {
          r = !0
        }
        return function (t, n) {
          return o(t, n), r ? t.__proto__ = n : e(t, n), t
        }
      }({}, !1) : void 0),
      check: o
    }
  }, function (t, n, r) {
    var e = r(118)("keys"),
      i = r(79);
    t.exports = function (t) {
      return e[t] || (e[t] = i(t))
    }
  }, function (t, n, r) {
    var e = r(124),
      i = r(51);
    t.exports = function (t, n, r) {
      if (e(n)) throw TypeError("String#" + r + " doesn't accept regex!");
      return String(i(t))
    }
  }, function (t, n, r) {
    "use strict";
    var i = r(49),
      o = r(51);
    t.exports = function (t) {
      var n = String(o(this)),
        r = "",
        e = i(t);
      if (e < 0 || e == 1 / 0) throw RangeError("Count can't be negative");
      for (; 0 < e;
        (e >>>= 1) && (n += n)) 1 & e && (r += n);
      return r
    }
  }, function (t, n) {
    t.exports = "\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"
  }, function (t, n, r) {
    var e, i, o, u = r(47),
      c = r(175),
      f = r(143),
      a = r(140),
      s = r(3),
      l = s.process,
      h = s.setImmediate,
      v = s.clearImmediate,
      p = s.MessageChannel,
      d = s.Dispatch,
      y = 0,
      g = {},
      b = "onreadystatechange",
      x = function () {
        var t = +this;
        if (g.hasOwnProperty(t)) {
          var n = g[t];
          delete g[t], n()
        }
      },
      m = function (t) {
        x.call(t.data)
      };
    h && v || (h = function (t) {
        for (var n = [], r = 1; arguments.length > r;) n.push(arguments[r++]);
        return g[++y] = function () {
          c("function" == typeof t ? t : Function(t), n)
        }, e(y), y
      }, v = function (t) {
        delete g[t]
      }, "process" == r(45)(l) ? e = function (t) {
        l.nextTick(u(x, t, 1))
      } : d && d.now ? e = function (t) {
        d.now(u(x, t, 1))
      } : p ? (o = (i = new p).port2, i.port1.onmessage = m, e = u(o.postMessage, o, 1)) : s.addEventListener &&
      "function" == typeof postMessage && !s.importScripts ? (e = function (t) {
        s.postMessage(t + "", "*")
      }, s.addEventListener("message", m, !1)) : e = b in a("script") ? function (t) {
        f.appendChild(a("script"))[b] = function () {
          f.removeChild(this), x.call(t)
        }
      } : function (t) {
        setTimeout(u(x, t, 1), 0)
      }), t.exports = {
      set: h,
      clear: v
    }
  }, function (t, n, r) {
    "use strict";

    function e(t, n, r) {
      var e, i, o, u = new Array(r),
        c = 8 * r - n - 1,
        f = (1 << c) - 1,
        a = f >> 1,
        s = 23 === n ? W(2, -24) - W(2, -77) : 0,
        l = 0,
        h = t < 0 || 0 === t && 1 / t < 0 ? 1 : 0;
      for ((t = G(t)) != t || t === C ? (i = t != t ? 1 : 0, e = f) : (e = U(V(t) / B), t * (o = W(2, -e)) < 1 && (
          e--, o *= 2), 2 <= (t += 1 <= e + a ? s / o : s * W(2, 1 - a)) * o && (e++, o /= 2), f <= e + a ? (i =
          0, e = f) : 1 <= e + a ? (i = (t * o - 1) * W(2, n), e += a) : (i = t * W(2, a - 1) * W(2, n), e =
        0)); 8 <= n; u[l++] = 255 & i, i /= 256, n -= 8);
      for (e = e << n | i, c += n; 0 < c; u[l++] = 255 & e, e /= 256, c -= 8);
      return u[--l] |= 128 * h, u
    }

    function i(t, n, r) {
      var e, i = 8 * r - n - 1,
        o = (1 << i) - 1,
        u = o >> 1,
        c = i - 7,
        f = r - 1,
        a = t[f--],
        s = 127 & a;
      for (a >>= 7; 0 < c; s = 256 * s + t[f], f--, c -= 8);
      for (e = s & (1 << -c) - 1, s >>= -c, c += n; 0 < c; e = 256 * e + t[f], f--, c -= 8);
      if (0 === s) s = 1 - u;
      else {
        if (s === o) return e ? NaN : a ? -C : C;
        e += W(2, n), s -= u
      }
      return (a ? -1 : 1) * e * W(2, s - n)
    }

    function o(t) {
      return t[3] << 24 | t[2] << 16 | t[1] << 8 | t[0]
    }

    function u(t) {
      return [255 & t]
    }

    function c(t) {
      return [255 & t, t >> 8 & 255]
    }

    function f(t) {
      return [255 & t, t >> 8 & 255, t >> 16 & 255, t >> 24 & 255]
    }

    function a(t) {
      return e(t, 52, 8)
    }

    function s(t) {
      return e(t, 23, 4)
    }

    function l(t, n, r) {
      M(t[I], n, {
        get: function () {
          return this[r]
        }
      })
    }

    function h(t, n, r, e) {
      var i = O(+r);
      if (i + n > t[H]) throw R(L);
      var o = t[K]._b,
        u = i + t[J],
        c = o.slice(u, u + n);
      return e ? c : c.reverse()
    }

    function v(t, n, r, e, i, o) {
      var u = O(+r);
      if (u + n > t[H]) throw R(L);
      for (var c = t[K]._b, f = u + t[J], a = e(+i), s = 0; s < n; s++) c[f + s] = a[o ? s : n - s - 1]
    }
    var p = r(3),
      d = r(10),
      y = r(68),
      g = r(132),
      b = r(26),
      x = r(76),
      m = r(4),
      S = r(70),
      w = r(49),
      _ = r(8),
      O = r(194),
      E = r(73).f,
      M = r(11).f,
      P = r(137),
      j = r(83),
      F = "ArrayBuffer",
      A = "DataView",
      I = "prototype",
      L = "Wrong index!",
      N = p[F],
      T = p[A],
      k = p.Math,
      R = p.RangeError,
      C = p.Infinity,
      D = N,
      G = k.abs,
      W = k.pow,
      U = k.floor,
      V = k.log,
      B = k.LN2,
      q = "byteLength",
      z = "byteOffset",
      K = d ? "_b" : "buffer",
      H = d ? "_l" : q,
      J = d ? "_o" : z;
    if (g.ABV) {
      if (!m(function () {
          N(1)
        }) || !m(function () {
          new N(-1)
        }) || m(function () {
          return new N, new N(1.5), new N(NaN), N.name != F
        })) {
        for (var $, Y = (N = function (t) {
            return S(this, N), new D(O(t))
          })[I] = D[I], X = E(D), Q = 0; X.length > Q;)($ = X[Q++]) in N || b(N, $, D[$]);
        y || (Y.constructor = N)
      }
      var Z = new T(new N(2)),
        tt = T[I].setInt8;
      Z.setInt8(0, 2147483648), Z.setInt8(1, 2147483649), !Z.getInt8(0) && Z.getInt8(1) || x(T[I], {
        setInt8: function (t, n) {
          tt.call(this, t, n << 24 >> 24)
        },
        setUint8: function (t, n) {
          tt.call(this, t, n << 24 >> 24)
        }
      }, !0)
    } else N = function (t) {
      S(this, N, F);
      var n = O(t);
      this._b = P.call(new Array(n), 0), this[H] = n
    }, T = function (t, n, r) {
      S(this, T, A), S(t, N, A);
      var e = t[H],
        i = w(n);
      if (i < 0 || e < i) throw R("Wrong offset!");
      if (e < i + (r = void 0 === r ? e - i : _(r))) throw R("Wrong length!");
      this[K] = t, this[J] = i, this[H] = r
    }, d && (l(N, q, "_l"), l(T, "buffer", "_b"), l(T, q, "_l"), l(T, z, "_o")), x(T[I], {
      getInt8: function (t) {
        return h(this, 1, t)[0] << 24 >> 24
      },
      getUint8: function (t) {
        return h(this, 1, t)[0]
      },
      getInt16: function (t) {
        var n = h(this, 2, t, arguments[1]);
        return (n[1] << 8 | n[0]) << 16 >> 16
      },
      getUint16: function (t) {
        var n = h(this, 2, t, arguments[1]);
        return n[1] << 8 | n[0]
      },
      getInt32: function (t) {
        return o(h(this, 4, t, arguments[1]))
      },
      getUint32: function (t) {
        return o(h(this, 4, t, arguments[1])) >>> 0
      },
      getFloat32: function (t) {
        return i(h(this, 4, t, arguments[1]), 23, 4)
      },
      getFloat64: function (t) {
        return i(h(this, 8, t, arguments[1]), 52, 8)
      },
      setInt8: function (t, n) {
        v(this, 1, t, u, n)
      },
      setUint8: function (t, n) {
        v(this, 1, t, u, n)
      },
      setInt16: function (t, n) {
        v(this, 2, t, c, n, arguments[2])
      },
      setUint16: function (t, n) {
        v(this, 2, t, c, n, arguments[2])
      },
      setInt32: function (t, n) {
        v(this, 4, t, f, n, arguments[2])
      },
      setUint32: function (t, n) {
        v(this, 4, t, f, n, arguments[2])
      },
      setFloat32: function (t, n) {
        v(this, 4, t, s, n, arguments[2])
      },
      setFloat64: function (t, n) {
        v(this, 8, t, a, n, arguments[2])
      }
    });
    j(N, F), j(T, A), b(T[I], g.VIEW, !0), n[F] = N, n[A] = T
  }, function (t, n, r) {
    var e = r(3),
      i = r(46),
      o = r(68),
      u = r(195),
      c = r(11).f;
    t.exports = function (t) {
      var n = i.Symbol || (i.Symbol = o ? {} : e.Symbol || {});
      "_" == t.charAt(0) || t in n || c(n, t, {
        value: u.f(t)
      })
    }
  }, function (t, n, r) {
    var e = r(81),
      i = r(7)("iterator"),
      o = r(82);
    t.exports = r(46).getIteratorMethod = function (t) {
      if (null != t) return t[i] || t["@@iterator"] || o[e(t)]
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(67),
      i = r(178),
      o = r(82),
      u = r(33);
    t.exports = r(147)(Array, "Array", function (t, n) {
      this._t = u(t), this._i = 0, this._k = n
    }, function () {
      var t = this._t,
        n = this._k,
        r = this._i++;
      return !t || r >= t.length ? (this._t = void 0, i(1)) : i(0, "keys" == n ? r : "values" == n ? t[r] : [r,
        t[r]
      ])
    }, "values"), o.Arguments = o.Array, e("keys"), e("values"), e("entries")
  }, function (t, n) {
    t.exports = function (t, n) {
      t.classList ? t.classList.add(n) : t.className += " " + n
    }
  }, function (t, n) {
    t.exports = function (t, n) {
      if (t.classList) t.classList.remove(n);
      else {
        var r = new RegExp("(^|\\b)" + n.split(" ").join("|") + "(\\b|$)", "gi");
        t.className = t.className.replace(r, " ")
      }
    }
  }, function (t, n, r) {
    var e = r(45);
    t.exports = function (t, n) {
      if ("number" != typeof t && "Number" != e(t)) throw TypeError(n);
      return +t
    }
  }, function (t, n, r) {
    "use strict";
    var a = r(17),
      s = r(78),
      l = r(8);
    t.exports = [].copyWithin || function (t, n) {
      var r = a(this),
        e = l(r.length),
        i = s(t, e),
        o = s(n, e),
        u = 2 < arguments.length ? arguments[2] : void 0,
        c = Math.min((void 0 === u ? e : s(u, e)) - o, e - i),
        f = 1;
      for (o < i && i < o + c && (f = -1, o += c - 1, i += c - 1); 0 < c--;) o in r ? r[i] = r[o] : delete r[i],
        i += f, o += f;
      return r
    }
  }, function (t, n, r) {
    var e = r(71);
    t.exports = function (t, n) {
      var r = [];
      return e(t, !1, r.push, r, n), r
    }
  }, function (t, n, r) {
    var s = r(21),
      l = r(17),
      h = r(116),
      v = r(8);
    t.exports = function (t, n, r, e, i) {
      s(n);
      var o = l(t),
        u = h(o),
        c = v(o.length),
        f = i ? c - 1 : 0,
        a = i ? -1 : 1;
      if (r < 2)
        for (;;) {
          if (f in u) {
            e = u[f], f += a;
            break
          }
          if (f += a, i ? f < 0 : c <= f) throw TypeError("Reduce of empty array with no initial value")
        }
      for (; i ? 0 <= f : f < c; f += a) f in u && (e = n(e, u[f], f, o));
      return e
    }
  }, function (t, n, r) {
    "use strict";
    var o = r(21),
      u = r(5),
      c = r(175),
      f = [].slice,
      a = {};
    t.exports = Function.bind || function (n) {
      var r = o(this),
        e = f.call(arguments, 1),
        i = function () {
          var t = e.concat(f.call(arguments));
          return this instanceof i ? function (t, n, r) {
            if (!(n in a)) {
              for (var e = [], i = 0; i < n; i++) e[i] = "a[" + i + "]";
              a[n] = Function("F,a", "return new F(" + e.join(",") + ")")
            }
            return a[n](t, r)
          }(r, t.length, t) : c(r, t, n)
        };
      return u(r.prototype) && (i.prototype = r.prototype), i
    }
  }, function (t, n, r) {
    "use strict";
    var u = r(11).f,
      c = r(72),
      f = r(76),
      a = r(47),
      s = r(70),
      l = r(71),
      e = r(147),
      i = r(178),
      o = r(77),
      h = r(10),
      v = r(69).fastKey,
      p = r(80),
      d = h ? "_s" : "size",
      y = function (t, n) {
        var r, e = v(n);
        if ("F" !== e) return t._i[e];
        for (r = t._f; r; r = r.n)
          if (r.k == n) return r
      };
    t.exports = {
      getConstructor: function (t, o, r, e) {
        var i = t(function (t, n) {
          s(t, i, o, "_i"), t._t = o, t._i = c(null), t._f = void 0, t._l = void 0, t[d] = 0, null != n &&
            l(n, r, t[e], t)
        });
        return f(i.prototype, {
          clear: function () {
            for (var t = p(this, o), n = t._i, r = t._f; r; r = r.n) r.r = !0, r.p && (r.p = r.p.n =
              void 0), delete n[r.i];
            t._f = t._l = void 0, t[d] = 0
          },
          delete: function (t) {
            var n = p(this, o),
              r = y(n, t);
            if (r) {
              var e = r.n,
                i = r.p;
              delete n._i[r.i], r.r = !0, i && (i.n = e), e && (e.p = i), n._f == r && (n._f = e), n._l ==
                r && (n._l = i), n[d]--
            }
            return !!r
          },
          forEach: function (t) {
            p(this, o);
            for (var n, r = a(t, 1 < arguments.length ? arguments[1] : void 0, 3); n = n ? n.n : this._f;)
              for (r(n.v, n.k, this); n && n.r;) n = n.p
          },
          has: function (t) {
            return !!y(p(this, o), t)
          }
        }), h && u(i.prototype, "size", {
          get: function () {
            return p(this, o)[d]
          }
        }), i
      },
      def: function (t, n, r) {
        var e, i, o = y(t, n);
        return o ? o.v = r : (t._l = o = {
          i: i = v(n, !0),
          k: n,
          v: r,
          p: e = t._l,
          n: void 0,
          r: !1
        }, t._f || (t._f = o), e && (e.n = o), t[d]++, "F" !== i && (t._i[i] = o)), t
      },
      getEntry: y,
      setStrong: function (t, r, n) {
        e(t, r, function (t, n) {
          this._t = p(t, r), this._k = n, this._l = void 0
        }, function () {
          for (var t = this, n = t._k, r = t._l; r && r.r;) r = r.p;
          return t._t && (t._l = r = r ? r.n : t._t._f) ? i(0, "keys" == n ? r.k : "values" == n ? r.v : [r
            .k, r.v
          ]) : (t._t = void 0, i(1))
        }, n ? "entries" : "values", !n, !0), o(r)
      }
    }
  }, function (t, n, r) {
    var e = r(81),
      i = r(167);
    t.exports = function (t) {
      return function () {
        if (e(this) != t) throw TypeError(t + "#toJSON isn't generic");
        return i(this)
      }
    }
  }, function (t, n, r) {
    "use strict";
    var u = r(76),
      c = r(69).getWeak,
      i = r(2),
      f = r(5),
      a = r(70),
      s = r(71),
      e = r(50),
      l = r(30),
      h = r(80),
      o = e(5),
      v = e(6),
      p = 0,
      d = function (t) {
        return t._l || (t._l = new y)
      },
      y = function () {
        this.a = []
      },
      g = function (t, n) {
        return o(t.a, function (t) {
          return t[0] === n
        })
      };
    y.prototype = {
      get: function (t) {
        var n = g(this, t);
        if (n) return n[1]
      },
      has: function (t) {
        return !!g(this, t)
      },
      set: function (t, n) {
        var r = g(this, t);
        r ? r[1] = n : this.a.push([t, n])
      },
      delete: function (n) {
        var t = v(this.a, function (t) {
          return t[0] === n
        });
        return ~t && this.a.splice(t, 1), !!~t
      }
    }, t.exports = {
      getConstructor: function (t, r, e, i) {
        var o = t(function (t, n) {
          a(t, o, r, "_i"), t._t = r, t._i = p++, t._l = void 0, null != n && s(n, e, t[i], t)
        });
        return u(o.prototype, {
          delete: function (t) {
            if (!f(t)) return !1;
            var n = c(t);
            return !0 === n ? d(h(this, r)).delete(t) : n && l(n, this._i) && delete n[this._i]
          },
          has: function (t) {
            if (!f(t)) return !1;
            var n = c(t);
            return !0 === n ? d(h(this, r)).has(t) : n && l(n, this._i)
          }
        }), o
      },
      def: function (t, n, r) {
        var e = c(i(n), !0);
        return !0 === e ? d(t).set(n, r) : e[t._i] = r, t
      },
      ufstore: d
    }
  }, function (t, n, r) {
    "use strict";
    var p = r(123),
      d = r(5),
      y = r(8),
      g = r(47),
      b = r(7)("isConcatSpreadable");
    t.exports = function t(n, r, e, i, o, u, c, f) {
      for (var a, s, l = o, h = 0, v = !!c && g(c, f, 3); h < i;) {
        if (h in e) {
          if (a = v ? v(e[h], h, r) : e[h], s = !1, d(a) && (s = void 0 !== (s = a[b]) ? !!s : p(a)), s && 0 < u)
            l = t(n, r, a, y(a.length), l, u - 1) - 1;
          else {
            if (9007199254740991 <= l) throw TypeError();
            n[l] = a
          }
          l++
        }
        h++
      }
      return l
    }
  }, function (t, n, r) {
    t.exports = !r(10) && !r(4)(function () {
      return 7 != Object.defineProperty(r(140)("div"), "a", {
        get: function () {
          return 7
        }
      }).a
    })
  }, function (t, n) {
    t.exports = function (t, n, r) {
      var e = void 0 === r;
      switch (n.length) {
        case 0:
          return e ? t() : t.call(r);
        case 1:
          return e ? t(n[0]) : t.call(r, n[0]);
        case 2:
          return e ? t(n[0], n[1]) : t.call(r, n[0], n[1]);
        case 3:
          return e ? t(n[0], n[1], n[2]) : t.call(r, n[0], n[1], n[2]);
        case 4:
          return e ? t(n[0], n[1], n[2], n[3]) : t.call(r, n[0], n[1], n[2], n[3])
      }
      return t.apply(r, n)
    }
  }, function (t, n, r) {
    var e = r(5),
      i = Math.floor;
    t.exports = function (t) {
      return !e(t) && isFinite(t) && i(t) === t
    }
  }, function (t, n, r) {
    var o = r(2);
    t.exports = function (t, n, r, e) {
      try {
        return e ? n(o(r)[0], r[1]) : n(r)
      } catch (n) {
        var i = t.return;
        throw void 0 !== i && o(i.call(t)), n
      }
    }
  }, function (t, n) {
    t.exports = function (t, n) {
      return {
        value: n,
        done: !!t
      }
    }
  }, function (t, n, r) {
    var o = r(149),
      e = Math.pow,
      u = e(2, -52),
      c = e(2, -23),
      f = e(2, 127) * (2 - c),
      a = e(2, -126);
    t.exports = Math.fround || function (t) {
      var n, r, e = Math.abs(t),
        i = o(t);
      return e < a ? i * (e / a / c + 1 / u - 1 / u) * a * c : f < (r = (n = (1 + c / u) * e) - (n - e)) || r !=
        r ? i * (1 / 0) : i * r
    }
  }, function (t, n) {
    t.exports = Math.log1p || function (t) {
      return -1e-8 < (t = +t) && t < 1e-8 ? t - t * t / 2 : Math.log(1 + t)
    }
  }, function (t, n) {
    t.exports = Math.scale || function (t, n, r, e, i) {
      return 0 === arguments.length || t != t || n != n || r != r || e != e || i != i ? NaN : t === 1 / 0 || t ===
        -1 / 0 ? t : (t - n) * (i - e) / (r - n) + e
    }
  }, function (t, n, r) {
    "use strict";
    var h = r(10),
      v = r(74),
      p = r(127),
      d = r(117),
      y = r(17),
      g = r(116),
      i = Object.assign;
    t.exports = !i || r(4)(function () {
      var t = {},
        n = {},
        r = Symbol(),
        e = "abcdefghijklmnopqrst";
      return t[r] = 7, e.split("").forEach(function (t) {
        n[t] = t
      }), 7 != i({}, t)[r] || Object.keys(i({}, n)).join("") != e
    }) ? function (t, n) {
      for (var r = y(t), e = arguments.length, i = 1, o = p.f, u = d.f; i < e;)
        for (var c, f = g(arguments[i++]), a = o ? v(f).concat(o(f)) : v(f), s = a.length, l = 0; l < s;) c = a[
          l++], h && !u.call(f, c) || (r[c] = f[c]);
      return r
    } : i
  }, function (t, n, r) {
    var u = r(11),
      c = r(2),
      f = r(74);
    t.exports = r(10) ? Object.defineProperties : function (t, n) {
      c(t);
      for (var r, e = f(n), i = e.length, o = 0; o < i;) u.f(t, r = e[o++], n[r]);
      return t
    }
  }, function (t, n, r) {
    var e = r(33),
      i = r(73).f,
      o = {}.toString,
      u = "object" == typeof window && window && Object.getOwnPropertyNames ? Object.getOwnPropertyNames(window) :
      [];
    t.exports.f = function (t) {
      return u && "[object Window]" == o.call(t) ? function (t) {
        try {
          return i(t)
        } catch (t) {
          return u.slice()
        }
      }(t) : i(e(t))
    }
  }, function (t, n, r) {
    var u = r(30),
      c = r(33),
      f = r(120)(!1),
      a = r(154)("IE_PROTO");
    t.exports = function (t, n) {
      var r, e = c(t),
        i = 0,
        o = [];
      for (r in e) r != a && u(e, r) && o.push(r);
      for (; n.length > i;) u(e, r = n[i++]) && (~f(o, r) || o.push(r));
      return o
    }
  }, function (t, n, r) {
    var f = r(10),
      a = r(74),
      s = r(33),
      l = r(117).f;
    t.exports = function (c) {
      return function (t) {
        for (var n, r = s(t), e = a(r), i = e.length, o = 0, u = []; o < i;) n = e[o++], f && !l.call(r, n) || u
          .push(c ? [n, r[n]] : r[n]);
        return u
      }
    }
  }, function (t, n, r) {
    var e = r(73),
      i = r(127),
      o = r(2),
      u = r(3).Reflect;
    t.exports = u && u.ownKeys || function (t) {
      var n = e.f(o(t)),
        r = i.f;
      return r ? n.concat(r(t)) : n
    }
  }, function (t, n, r) {
    var e = r(3).parseFloat,
      i = r(84).trim;
    t.exports = 1 / e(r(157) + "-0") != -1 / 0 ? function (t) {
      var n = i(String(t), 3),
        r = e(n);
      return 0 === r && "-" == n.charAt(0) ? -0 : r
    } : e
  }, function (t, n, r) {
    var e = r(3).parseInt,
      i = r(84).trim,
      o = r(157),
      u = /^[-+]?0[xX]/;
    t.exports = 8 !== e(o + "08") || 22 !== e(o + "0x16") ? function (t, n) {
      var r = i(String(t), 3);
      return e(r, n >>> 0 || (u.test(r) ? 16 : 10))
    } : e
  }, function (t, n) {
    t.exports = function (t) {
      try {
        return {
          e: !1,
          v: t()
        }
      } catch (t) {
        return {
          e: !0,
          v: t
        }
      }
    }
  }, function (t, n, r) {
    var e = r(2),
      i = r(5),
      o = r(151);
    t.exports = function (t, n) {
      if (e(t), i(n) && n.constructor === t) return n;
      var r = o.f(t);
      return (0, r.resolve)(n), r.promise
    }
  }, function (t, n) {
    t.exports = Object.is || function (t, n) {
      return t === n ? 0 !== t || 1 / t == 1 / n : t != t && n != n
    }
  }, function (t, n, r) {
    var s = r(8),
      l = r(156),
      h = r(51);
    t.exports = function (t, n, r, e) {
      var i = String(h(t)),
        o = i.length,
        u = void 0 === r ? " " : String(r),
        c = s(n);
      if (c <= o || "" == u) return i;
      var f = c - o,
        a = l.call(u, Math.ceil(f / u.length));
      return a.length > f && (a = a.slice(0, f)), e ? a + i : i + a
    }
  }, function (t, n, r) {
    var e = r(49),
      i = r(8);
    t.exports = function (t) {
      if (void 0 === t) return 0;
      var n = e(t),
        r = i(n);
      if (n !== r) throw RangeError("Wrong length!");
      return r
    }
  }, function (t, n, r) {
    n.f = r(7)
  }, function (t, n, r) {
    "use strict";
    var e = r(170),
      i = r(80);
    t.exports = r(121)("Map", function (t) {
      return function () {
        return t(this, 0 < arguments.length ? arguments[0] : void 0)
      }
    }, {
      get: function (t) {
        var n = e.getEntry(i(this, "Map"), t);
        return n && n.v
      },
      set: function (t, n) {
        return e.def(i(this, "Map"), 0 === t ? 0 : t, n)
      }
    }, e, !0)
  }, function (t, n, r) {
    "use strict";
    var e = r(152);
    r(1)({
      target: "RegExp",
      proto: !0,
      forced: e !== /./.exec
    }, {
      exec: e
    })
  }, function (t, n, r) {
    r(10) && "g" != /./g.flags && r(11).f(RegExp.prototype, "flags", {
      configurable: !0,
      get: r(115)
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(170),
      i = r(80);
    t.exports = r(121)("Set", function (t) {
      return function () {
        return t(this, 0 < arguments.length ? arguments[0] : void 0)
      }
    }, {
      add: function (t) {
        return e.def(i(this, "Set"), t = 0 === t ? 0 : t, t)
      }
    }, e)
  }, function (t, n, r) {
    "use strict";
    var o, e = r(3),
      i = r(50)(0),
      u = r(27),
      c = r(69),
      f = r(182),
      a = r(172),
      s = r(5),
      l = r(80),
      h = r(80),
      v = !e.ActiveXObject && "ActiveXObject" in e,
      p = "WeakMap",
      d = c.getWeak,
      y = Object.isExtensible,
      g = a.ufstore,
      b = function (t) {
        return function () {
          return t(this, 0 < arguments.length ? arguments[0] : void 0)
        }
      },
      x = {
        get: function (t) {
          if (s(t)) {
            var n = d(t);
            return !0 === n ? g(l(this, p)).get(t) : n ? n[this._i] : void 0
          }
        },
        set: function (t, n) {
          return a.def(l(this, p), t, n)
        }
      },
      m = t.exports = r(121)(p, b, x, a, !0, !0);
    h && v && (f((o = a.getConstructor(b, p)).prototype, x), c.NEED = !0, i(["delete", "has", "get", "set"],
      function (e) {
        var t = m.prototype,
          i = t[e];
        u(t, e, function (t, n) {
          if (!s(t) || y(t)) return i.call(this, t, n);
          this._f || (this._f = new o);
          var r = this._f[e](t, n);
          return "set" == e ? this : r
        })
      }))
  }, , , , function (t, n) {
    "use strict";
    t.exports = {
      init: function () {
        var t = document.querySelector("#page-nav");
        t && !document.querySelector("#page-nav .extend.prev") && (t.innerHTML =
            '<a class="extend prev disabled" rel="prev"></a>' + t.innerHTML), t && !document
          .querySelector("#page-nav .extend.next") && (t.innerHTML = t.innerHTML +
            '<a class="extend next disabled" rel="next"></a>'), yiliaConfig && yiliaConfig
          .open_in_new && document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function (
            t) {
            var n = t.getAttribute("target");
            n && "" !== n || t.setAttribute("target", "_blank")
          }), yiliaConfig && yiliaConfig.toc_hide_index && document.querySelectorAll(".toc-number").forEach(
            function (t) {
              t.style.display = "none"
            })
      }
    }
  }, function (t, n, r) {
    "use strict";

    function e(t) {
      return t && t.__esModule ? t : {
        default: t
      }
    }

    function i(t, n, r, e, i) {
      var o = function (t) {
          for (var n = t.offsetLeft, r = t.offsetParent; null !== r;) n += r.offsetLeft, r = r.offsetParent;
          return n
        }(t),
        u = function (t) {
          for (var n = t.offsetTop, r = t.offsetParent; null !== r;) n += r.offsetTop, r = r.offsetParent;
          return n
        }(t) - n;
      if (u - r <= i) {
        var c = t.$newDom;
        c || (c = t.cloneNode(!0), (0, a.default)(t, c), (t.$newDom = c).style.position = "fixed", c.style.top = (
            r || u) + "px", c.style.left = o + "px", c.style.zIndex = e || 2, c.style.width = "100%", c.style
          .color = "#fff"), c.style.visibility = "visible", t.style.visibility = "hidden"
      } else {
        t.style.visibility = "visible";
        var f = t.$newDom;
        f && (f.style.visibility = "hidden")
      }
    }

    function o() {
      var t = document.querySelector(".js-overlay"),
        n = document.querySelector(".js-header-menu");
      i(t, document.body.scrollTop, -63, 2, 0), i(n, document.body.scrollTop, 1, 3, 0)
    }
    var f = e(r(163)),
      a = e((e(r(164)), r(414))),
      u = e(r(134)),
      c = e(r(204)),
      s = r(135);
    u.default.versions.mobile && window.screen.width < 800 && (function () {
      for (var t = document.querySelectorAll(".js-header-menu li a"), n = window.location.pathname, r = 0, e = t
          .length; r < e; r++) {
        var i = t[r];
        o = n, u = i.getAttribute("href"), c = /\/|index.html/g, o.replace(c, "") === u.replace(c, "") && (0, f
          .default)(i, "active")
      }
      var o, u, c
    }(), document.querySelector("#container").addEventListener("scroll", function (t) {
      o()
    }), window.addEventListener("scroll", function (t) {
      o()
    }), o()), (0, s.addLoadEvent)(function () {
      c.default.init()
    }), t.exports = {}
  }, , , function (t, n, r) {
    (function (t) {
      "use strict";

      function n(t, n, r) {
        t[n] || Object.defineProperty(t, n, {
          writable: !0,
          configurable: !0,
          value: r
        })
      }
      if (r(413), r(209), r(211), t._babelPolyfill) throw new Error(
        "only one instance of babel-polyfill is allowed");
      t._babelPolyfill = !0;
      n(String.prototype, "padLeft", "".padStart), n(String.prototype, "padRight", "".padEnd),
        "pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill"
        .split(",").forEach(function (t) {
          [][t] && n(Array, t, Function.call.bind([][t]))
        })
    }).call(n, function () {
      return this
    }())
  }, function (L, t) {
    (function (t) {
      ! function (t) {
        "use strict";

        function o(t, n, r, e) {
          var o, u, c, f, i = n && n.prototype instanceof h ? n : h,
            a = Object.create(i.prototype),
            s = new p(e || []);
          return a._invoke = (o = t, u = r, c = s, f = _, function (t, n) {
            if (f === E) throw new Error("Generator is already running");
            if (f === M) {
              if ("throw" === t) throw n;
              return d()
            }
            for (c.method = t, c.arg = n;;) {
              var r = c.delegate;
              if (r) {
                var e = v(r, c);
                if (e) {
                  if (e === P) continue;
                  return e
                }
              }
              if ("next" === c.method) c.sent = c._sent = c.arg;
              else if ("throw" === c.method) {
                if (f === _) throw f = M, c.arg;
                c.dispatchException(c.arg)
              } else "return" === c.method && c.abrupt("return", c.arg);
              f = E;
              var i = l(o, u, c);
              if ("normal" === i.type) {
                if (f = c.done ? M : O, i.arg === P) continue;
                return {
                  value: i.arg,
                  done: c.done
                }
              }
              "throw" === i.type && (f = M, c.method = "throw", c.arg = i.arg)
            }
          }), a
        }

        function l(t, n, r) {
          try {
            return {
              type: "normal",
              arg: t.call(n, r)
            }
          } catch (t) {
            return {
              type: "throw",
              arg: t
            }
          }
        }

        function h() {}

        function r() {}

        function n() {}

        function e(t) {
          ["next", "throw", "return"].forEach(function (n) {
            t[n] = function (t) {
              return this._invoke(n, t)
            }
          })
        }

        function u(c) {
          function f(t, n, r, e) {
            var i = l(c[t], c, n);
            if ("throw" !== i.type) {
              var o = i.arg,
                u = o.value;
              return u && "object" == typeof u && y.call(u, "__await") ? Promise.resolve(u.__await).then(
                function (t) {
                  f("next", t, r, e)
                },
                function (t) {
                  f("throw", t, r, e)
                }) : Promise.resolve(u).then(function (t) {
                o.value = t, r(o)
              }, e)
            }
            e(i.arg)
          }
          var n;
          "object" == typeof t.process && t.process.domain && (f = t.process.domain.bind(f)), this._invoke =
            function (r, e) {
              function t() {
                return new Promise(function (t, n) {
                  f(r, e, t, n)
                })
              }
              return n = n ? n.then(t, t) : t()
            }
        }

        function v(t, n) {
          var r = t.iterator[n.method];
          if (r === a) {
            if (n.delegate = null, "throw" === n.method) {
              if (t.iterator.return && (n.method = "return", n.arg = a, v(t, n), "throw" === n.method)) return P;
              n.method = "throw", n.arg = new TypeError("The iterator does not provide a 'throw' method")
            }
            return P
          }
          var e = l(r, t.iterator, n.arg);
          if ("throw" === e.type) return n.method = "throw", n.arg = e.arg, n.delegate = null, P;
          var i = e.arg;
          return i ? i.done ? (n[t.resultName] = i.value, n.next = t.nextLoc, "return" !== n.method && (n.method =
            "next", n.arg = a), n.delegate = null, P) : i : (n.method = "throw", n.arg = new TypeError(
            "iterator result is not an object"), n.delegate = null, P)
        }

        function i(t) {
          var n = {
            tryLoc: t[0]
          };
          1 in t && (n.catchLoc = t[1]), 2 in t && (n.finallyLoc = t[2], n.afterLoc = t[3]), this.tryEntries.push(
            n)
        }

        function c(t) {
          var n = t.completion || {};
          n.type = "normal", delete n.arg, t.completion = n
        }

        function p(t) {
          this.tryEntries = [{
            tryLoc: "root"
          }], t.forEach(i, this), this.reset(!0)
        }

        function f(n) {
          if (n) {
            var t = n[b];
            if (t) return t.call(n);
            if ("function" == typeof n.next) return n;
            if (!isNaN(n.length)) {
              var r = -1,
                e = function t() {
                  for (; ++r < n.length;)
                    if (y.call(n, r)) return t.value = n[r], t.done = !1, t;
                  return t.value = a, t.done = !0, t
                };
              return e.next = e
            }
          }
          return {
            next: d
          }
        }

        function d() {
          return {
            value: a,
            done: !0
          }
        }
        var a, s = Object.prototype,
          y = s.hasOwnProperty,
          g = "function" == typeof Symbol ? Symbol : {},
          b = g.iterator || "@@iterator",
          x = g.asyncIterator || "@@asyncIterator",
          m = g.toStringTag || "@@toStringTag",
          S = "object" == typeof L,
          w = t.regeneratorRuntime;
        if (w) S && (L.exports = w);
        else {
          (w = t.regeneratorRuntime = S ? L.exports : {}).wrap = o;
          var _ = "suspendedStart",
            O = "suspendedYield",
            E = "executing",
            M = "completed",
            P = {},
            j = {};
          j[b] = function () {
            return this
          };
          var F = Object.getPrototypeOf,
            A = F && F(F(f([])));
          A && A !== s && y.call(A, b) && (j = A);
          var I = n.prototype = h.prototype = Object.create(j);
          r.prototype = I.constructor = n, n.constructor = r, n[m] = r.displayName = "GeneratorFunction", w
            .isGeneratorFunction = function (t) {
              var n = "function" == typeof t && t.constructor;
              return !!n && (n === r || "GeneratorFunction" === (n.displayName || n.name))
            }, w.mark = function (t) {
              return Object.setPrototypeOf ? Object.setPrototypeOf(t, n) : (t.__proto__ = n, m in t || (t[m] =
                "GeneratorFunction")), t.prototype = Object.create(I), t
            }, w.awrap = function (t) {
              return {
                __await: t
              }
            }, e(u.prototype), u.prototype[x] = function () {
              return this
            }, w.AsyncIterator = u, w.async = function (t, n, r, e) {
              var i = new u(o(t, n, r, e));
              return w.isGeneratorFunction(n) ? i : i.next().then(function (t) {
                return t.done ? t.value : i.next()
              })
            }, e(I), I[m] = "Generator", I[b] = function () {
              return this
            }, I.toString = function () {
              return "[object Generator]"
            }, w.keys = function (r) {
              var e = [];
              for (var t in r) e.push(t);
              return e.reverse(),
                function t() {
                  for (; e.length;) {
                    var n = e.pop();
                    if (n in r) return t.value = n, t.done = !1, t
                  }
                  return t.done = !0, t
                }
            }, w.values = f, p.prototype = {
              constructor: p,
              reset: function (t) {
                if (this.prev = 0, this.next = 0, this.sent = this._sent = a, this.done = !1, this.delegate =
                  null, this.method = "next", this.arg = a, this.tryEntries.forEach(c), !t)
                  for (var n in this) "t" === n.charAt(0) && y.call(this, n) && !isNaN(+n.slice(1)) && (this[
                    n] = a)
              },
              stop: function () {
                this.done = !0;
                var t = this.tryEntries[0].completion;
                if ("throw" === t.type) throw t.arg;
                return this.rval
              },
              dispatchException: function (r) {
                function t(t, n) {
                  return o.type = "throw", o.arg = r, e.next = t, n && (e.method = "next", e.arg = a), !!n
                }
                if (this.done) throw r;
                for (var e = this, n = this.tryEntries.length - 1; 0 <= n; --n) {
                  var i = this.tryEntries[n],
                    o = i.completion;
                  if ("root" === i.tryLoc) return t("end");
                  if (i.tryLoc <= this.prev) {
                    var u = y.call(i, "catchLoc"),
                      c = y.call(i, "finallyLoc");
                    if (u && c) {
                      if (this.prev < i.catchLoc) return t(i.catchLoc, !0);
                      if (this.prev < i.finallyLoc) return t(i.finallyLoc)
                    } else if (u) {
                      if (this.prev < i.catchLoc) return t(i.catchLoc, !0)
                    } else {
                      if (!c) throw new Error("try statement without catch or finally");
                      if (this.prev < i.finallyLoc) return t(i.finallyLoc)
                    }
                  }
                }
              },
              abrupt: function (t, n) {
                for (var r = this.tryEntries.length - 1; 0 <= r; --r) {
                  var e = this.tryEntries[r];
                  if (e.tryLoc <= this.prev && y.call(e, "finallyLoc") && this.prev < e.finallyLoc) {
                    var i = e;
                    break
                  }
                }
                i && ("break" === t || "continue" === t) && i.tryLoc <= n && n <= i.finallyLoc && (i = null);
                var o = i ? i.completion : {};
                return o.type = t, o.arg = n, i ? (this.method = "next", this.next = i.finallyLoc, P) : this
                  .complete(o)
              },
              complete: function (t, n) {
                if ("throw" === t.type) throw t.arg;
                return "break" === t.type || "continue" === t.type ? this.next = t.arg : "return" === t.type ? (
                    this.rval = this.arg = t.arg, this.method = "return", this.next = "end") : "normal" === t
                  .type && n && (this.next = n), P
              },
              finish: function (t) {
                for (var n = this.tryEntries.length - 1; 0 <= n; --n) {
                  var r = this.tryEntries[n];
                  if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), c(r), P
                }
              },
              catch: function (t) {
                for (var n = this.tryEntries.length - 1; 0 <= n; --n) {
                  var r = this.tryEntries[n];
                  if (r.tryLoc === t) {
                    var e = r.completion;
                    if ("throw" === e.type) {
                      var i = e.arg;
                      c(r)
                    }
                    return i
                  }
                }
                throw new Error("illegal catch attempt")
              },
              delegateYield: function (t, n, r) {
                return this.delegate = {
                  iterator: f(t),
                  resultName: n,
                  nextLoc: r
                }, "next" === this.method && (this.arg = a), P
              }
            }
        }
      }("object" == typeof t ? t : "object" == typeof window ? window : "object" == typeof self ? self : this)
    }).call(t, function () {
      return this
    }())
  }, , function (t, n, r) {
    r(221), t.exports = r(46).RegExp.escape
  }, , , , function (t, n, r) {
    var e = r(5),
      i = r(123),
      o = r(7)("species");
    t.exports = function (t) {
      var n;
      return i(t) && ("function" != typeof (n = t.constructor) || n !== Array && !i(n.prototype) || (n = void 0),
        e(n) && (null === (n = n[o]) && (n = void 0))), void 0 === n ? Array : n
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(4),
      i = Date.prototype.getTime,
      o = Date.prototype.toISOString,
      u = function (t) {
        return 9 < t ? t : "0" + t
      };
    t.exports = e(function () {
      return "0385-07-25T07:06:39.999Z" != o.call(new Date(-5e13 - 1))
    }) || !e(function () {
      o.call(new Date(NaN))
    }) ? function () {
      if (!isFinite(i.call(this))) throw RangeError("Invalid time value");
      var t = this,
        n = t.getUTCFullYear(),
        r = t.getUTCMilliseconds(),
        e = n < 0 ? "-" : 9999 < n ? "+" : "";
      return e + ("00000" + Math.abs(n)).slice(e ? -6 : -4) + "-" + u(t.getUTCMonth() + 1) + "-" + u(t
        .getUTCDate()) + "T" + u(t.getUTCHours()) + ":" + u(t.getUTCMinutes()) + ":" + u(t.getUTCSeconds()) +
        "." + (99 < r ? r : "0" + u(r)) + "Z"
    } : o
  }, function (t, n, r) {
    "use strict";
    var e = r(2),
      i = r(53);
    t.exports = function (t) {
      if ("string" !== t && "number" !== t && "default" !== t) throw TypeError("Incorrect hint");
      return i(e(this), "number" != t)
    }
  }, function (t, n, r) {
    var c = r(74),
      f = r(127),
      a = r(117);
    t.exports = function (t) {
      var n = c(t),
        r = f.f;
      if (r)
        for (var e, i = r(t), o = a.f, u = 0; i.length > u;) o.call(t, e = i[u++]) && n.push(e);
      return n
    }
  }, function (t, n, r) {
    t.exports = r(118)("native-function-to-string", Function.toString)
  }, function (t, n) {
    t.exports = function (n, r) {
      var e = r === Object(r) ? function (t) {
        return r[t]
      } : r;
      return function (t) {
        return String(t).replace(n, e)
      }
    }
  }, function (t, n, r) {
    var e = r(1),
      i = r(220)(/[\\^$*+?.()|[\]{}]/g, "\\$&");
    e(e.S, "RegExp", {
      escape: function (t) {
        return i(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P, "Array", {
      copyWithin: r(166)
    }), r(67)("copyWithin")
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(50)(4);
    e(e.P + e.F * !r(48)([].every, !0), "Array", {
      every: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P, "Array", {
      fill: r(137)
    }), r(67)("fill")
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(50)(2);
    e(e.P + e.F * !r(48)([].filter, !0), "Array", {
      filter: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(50)(6),
      o = "findIndex",
      u = !0;
    o in [] && Array(1)[o](function () {
      u = !1
    }), e(e.P + e.F * u, "Array", {
      findIndex: function (t) {
        return i(this, t, 1 < arguments.length ? arguments[1] : void 0)
      }
    }), r(67)(o)
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(50)(5),
      o = "find",
      u = !0;
    o in [] && Array(1)[o](function () {
      u = !1
    }), e(e.P + e.F * u, "Array", {
      find: function (t) {
        return i(this, t, 1 < arguments.length ? arguments[1] : void 0)
      }
    }), r(67)(o)
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(50)(0),
      o = r(48)([].forEach, !0);
    e(e.P + e.F * !o, "Array", {
      forEach: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    "use strict";
    var h = r(47),
      e = r(1),
      v = r(17),
      p = r(177),
      d = r(145),
      y = r(8),
      g = r(139),
      b = r(161);
    e(e.S + e.F * !r(125)(function (t) {
      Array.from(t)
    }), "Array", {
      from: function (t) {
        var n, r, e, i, o = v(t),
          u = "function" == typeof this ? this : Array,
          c = arguments.length,
          f = 1 < c ? arguments[1] : void 0,
          a = void 0 !== f,
          s = 0,
          l = b(o);
        if (a && (f = h(f, 2 < c ? arguments[2] : void 0, 2)), null == l || u == Array && d(l))
          for (r = new u(n = y(o.length)); s < n; s++) g(r, s, a ? f(o[s], s) : o[s]);
        else
          for (i = l.call(o), r = new u; !(e = i.next()).done; s++) g(r, s, a ? p(i, f, [e.value, s], !0) : e
            .value);
        return r.length = s, r
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(120)(!1),
      o = [].indexOf,
      u = !!o && 1 / [1].indexOf(1, -0) < 0;
    e(e.P + e.F * (u || !r(48)(o)), "Array", {
      indexOf: function (t) {
        return u ? o.apply(this, arguments) || 0 : i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Array", {
      isArray: r(123)
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(33),
      o = [].join;
    e(e.P + e.F * (r(116) != Object || !r(48)(o)), "Array", {
      join: function (t) {
        return o.call(i(this), void 0 === t ? "," : t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(33),
      o = r(49),
      u = r(8),
      c = [].lastIndexOf,
      f = !!c && 1 / [1].lastIndexOf(1, -0) < 0;
    e(e.P + e.F * (f || !r(48)(c)), "Array", {
      lastIndexOf: function (t) {
        if (f) return c.apply(this, arguments) || 0;
        var n = i(this),
          r = u(n.length),
          e = r - 1;
        for (1 < arguments.length && (e = Math.min(e, o(arguments[1]))), e < 0 && (e = r + e); 0 <= e; e--)
          if (e in n && n[e] === t) return e || 0;
        return -1
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(50)(1);
    e(e.P + e.F * !r(48)([].map, !0), "Array", {
      map: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(139);
    e(e.S + e.F * r(4)(function () {
      function t() {}
      return !(Array.of.call(t) instanceof t)
    }), "Array", {
      of: function () {
        for (var t = 0, n = arguments.length, r = new("function" == typeof this ? this : Array)(n); t < n;) i(
          r, t, arguments[t++]);
        return r.length = n, r
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(168);
    e(e.P + e.F * !r(48)([].reduceRight, !0), "Array", {
      reduceRight: function (t) {
        return i(this, t, arguments.length, arguments[1], !0)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(168);
    e(e.P + e.F * !r(48)([].reduce, !0), "Array", {
      reduce: function (t) {
        return i(this, t, arguments.length, arguments[1], !1)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(143),
      a = r(45),
      s = r(78),
      l = r(8),
      h = [].slice;
    e(e.P + e.F * r(4)(function () {
      i && h.call(i)
    }), "Array", {
      slice: function (t, n) {
        var r = l(this.length),
          e = a(this);
        if (n = void 0 === n ? r : n, "Array" == e) return h.call(this, t, n);
        for (var i = s(t, r), o = s(n, r), u = l(o - i), c = new Array(u), f = 0; f < u; f++) c[f] =
          "String" == e ? this.charAt(i + f) : this[i + f];
        return c
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(50)(3);
    e(e.P + e.F * !r(48)([].some, !0), "Array", {
      some: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(21),
      o = r(17),
      u = r(4),
      c = [].sort,
      f = [1, 2, 3];
    e(e.P + e.F * (u(function () {
      f.sort(void 0)
    }) || !u(function () {
      f.sort(null)
    }) || !r(48)(c)), "Array", {
      sort: function (t) {
        return void 0 === t ? c.call(o(this)) : c.call(o(this), i(t))
      }
    })
  }, function (t, n, r) {
    r(77)("Array")
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Date", {
      now: function () {
        return (new Date).getTime()
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(216);
    e(e.P + e.F * (Date.prototype.toISOString !== i), "Date", {
      toISOString: i
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(17),
      o = r(53);
    e(e.P + e.F * r(4)(function () {
      return null !== new Date(NaN).toJSON() || 1 !== Date.prototype.toJSON.call({
        toISOString: function () {
          return 1
        }
      })
    }), "Date", {
      toJSON: function (t) {
        var n = i(this),
          r = o(n);
        return "number" != typeof r || isFinite(r) ? n.toISOString() : null
      }
    })
  }, function (t, n, r) {
    var e = r(7)("toPrimitive"),
      i = Date.prototype;
    e in i || r(26)(i, e, r(217))
  }, function (t, n, r) {
    var e = Date.prototype,
      i = "Invalid Date",
      o = "toString",
      u = e[o],
      c = e.getTime;
    new Date(NaN) + "" != i && r(27)(e, o, function () {
      var t = c.call(this);
      return t == t ? u.call(this) : i
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P, "Function", {
      bind: r(169)
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(5),
      i = r(32),
      o = r(7)("hasInstance"),
      u = Function.prototype;
    o in u || r(11).f(u, o, {
      value: function (t) {
        if ("function" != typeof this || !e(t)) return !1;
        if (!e(this.prototype)) return t instanceof this;
        for (; t = i(t);)
          if (this.prototype === t) return !0;
        return !1
      }
    })
  }, function (t, n, r) {
    var e = r(11).f,
      i = Function.prototype,
      o = /^\s*function ([^ (]*)/;
    "name" in i || r(10) && e(i, "name", {
      configurable: !0,
      get: function () {
        try {
          return ("" + this).match(o)[1]
        } catch (t) {
          return ""
        }
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(180),
      o = Math.sqrt,
      u = Math.acosh;
    e(e.S + e.F * !(u && 710 == Math.floor(u(Number.MAX_VALUE)) && u(1 / 0) == 1 / 0), "Math", {
      acosh: function (t) {
        return (t = +t) < 1 ? NaN : 94906265.62425156 < t ? Math.log(t) + Math.LN2 : i(t - 1 + o(t - 1) * o(
          t + 1))
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = Math.asinh;
    e(e.S + e.F * !(i && 0 < 1 / i(0)), "Math", {
      asinh: function t(n) {
        return isFinite(n = +n) && 0 != n ? n < 0 ? -t(-n) : Math.log(n + Math.sqrt(n * n + 1)) : n
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = Math.atanh;
    e(e.S + e.F * !(i && 1 / i(-0) < 0), "Math", {
      atanh: function (t) {
        return 0 == (t = +t) ? t : Math.log((1 + t) / (1 - t)) / 2
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(149);
    e(e.S, "Math", {
      cbrt: function (t) {
        return i(t = +t) * Math.pow(Math.abs(t), 1 / 3)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      clz32: function (t) {
        return (t >>>= 0) ? 31 - Math.floor(Math.log(t + .5) * Math.LOG2E) : 32
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = Math.exp;
    e(e.S, "Math", {
      cosh: function (t) {
        return (i(t = +t) + i(-t)) / 2
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(148);
    e(e.S + e.F * (i != Math.expm1), "Math", {
      expm1: i
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      fround: r(179)
    })
  }, function (t, n, r) {
    var e = r(1),
      f = Math.abs;
    e(e.S, "Math", {
      hypot: function (t, n) {
        for (var r, e, i = 0, o = 0, u = arguments.length, c = 0; o < u;) c < (r = f(arguments[o++])) ? (i =
          i * (e = c / r) * e + 1, c = r) : 0 < r ? i += (e = r / c) * e : i += r;
        return c === 1 / 0 ? 1 / 0 : c * Math.sqrt(i)
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = Math.imul;
    e(e.S + e.F * r(4)(function () {
      return -5 != i(4294967295, 5) || 2 != i.length
    }), "Math", {
      imul: function (t, n) {
        var r = 65535,
          e = +t,
          i = +n,
          o = r & e,
          u = r & i;
        return 0 | o * u + ((r & e >>> 16) * u + o * (r & i >>> 16) << 16 >>> 0)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      log10: function (t) {
        return Math.log(t) * Math.LOG10E
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      log1p: r(180)
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      log2: function (t) {
        return Math.log(t) / Math.LN2
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      sign: r(149)
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(148),
      o = Math.exp;
    e(e.S + e.F * r(4)(function () {
      return -2e-17 != !Math.sinh(-2e-17)
    }), "Math", {
      sinh: function (t) {
        return Math.abs(t = +t) < 1 ? (i(t) - i(-t)) / 2 : (o(t - 1) - o(-t - 1)) * (Math.E / 2)
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(148),
      o = Math.exp;
    e(e.S, "Math", {
      tanh: function (t) {
        var n = i(t = +t),
          r = i(-t);
        return n == 1 / 0 ? 1 : r == 1 / 0 ? -1 : (n - r) / (o(t) + o(-t))
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      trunc: function (t) {
        return (0 < t ? Math.floor : Math.ceil)(t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(3),
      i = r(30),
      o = r(45),
      u = r(144),
      s = r(53),
      c = r(4),
      f = r(73).f,
      a = r(31).f,
      l = r(11).f,
      h = r(84).trim,
      v = "Number",
      p = e[v],
      d = p,
      y = p.prototype,
      g = o(r(72)(y)) == v,
      b = "trim" in String.prototype,
      x = function (t) {
        var n = s(t, !1);
        if ("string" == typeof n && 2 < n.length) {
          var r, e, i, o = (n = b ? n.trim() : h(n, 3)).charCodeAt(0);
          if (43 === o || 45 === o) {
            if (88 === (r = n.charCodeAt(2)) || 120 === r) return NaN
          } else if (48 === o) {
            switch (n.charCodeAt(1)) {
              case 66:
              case 98:
                e = 2, i = 49;
                break;
              case 79:
              case 111:
                e = 8, i = 55;
                break;
              default:
                return +n
            }
            for (var u, c = n.slice(2), f = 0, a = c.length; f < a; f++)
              if ((u = c.charCodeAt(f)) < 48 || i < u) return NaN;
            return parseInt(c, e)
          }
        }
        return +n
      };
    if (!p(" 0o1") || !p("0b1") || p("+0x1")) {
      p = function (t) {
        var n = arguments.length < 1 ? 0 : t,
          r = this;
        return r instanceof p && (g ? c(function () {
          y.valueOf.call(r)
        }) : o(r) != v) ? u(new d(x(n)), r, p) : x(n)
      };
      for (var m, S = r(10) ? f(d) :
          "MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger"
          .split(","), w = 0; S.length > w; w++) i(d, m = S[w]) && !i(p, m) && l(p, m, a(d, m));
      (p.prototype = y).constructor = p, r(27)(e, v, p)
    }
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {
      EPSILON: Math.pow(2, -52)
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(3).isFinite;
    e(e.S, "Number", {
      isFinite: function (t) {
        return "number" == typeof t && i(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {
      isInteger: r(176)
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {
      isNaN: function (t) {
        return t != t
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(176),
      o = Math.abs;
    e(e.S, "Number", {
      isSafeInteger: function (t) {
        return i(t) && o(t) <= 9007199254740991
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {
      MAX_SAFE_INTEGER: 9007199254740991
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {
      MIN_SAFE_INTEGER: -9007199254740991
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(188);
    e(e.S + e.F * (Number.parseFloat != i), "Number", {
      parseFloat: i
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(189);
    e(e.S + e.F * (Number.parseInt != i), "Number", {
      parseInt: i
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      a = r(49),
      s = r(165),
      l = r(156),
      i = 1..toFixed,
      o = Math.floor,
      u = [0, 0, 0, 0, 0, 0],
      h = "Number.toFixed: incorrect invocation!",
      v = function (t, n) {
        for (var r = -1, e = n; ++r < 6;) e += t * u[r], u[r] = e % 1e7, e = o(e / 1e7)
      },
      p = function (t) {
        for (var n = 6, r = 0; 0 <= --n;) r += u[n], u[n] = o(r / t), r = r % t * 1e7
      },
      d = function () {
        for (var t = 6, n = ""; 0 <= --t;)
          if ("" !== n || 0 === t || 0 !== u[t]) {
            var r = String(u[t]);
            n = "" === n ? r : n + l.call("0", 7 - r.length) + r
          } return n
      },
      y = function (t, n, r) {
        return 0 === n ? r : n % 2 == 1 ? y(t, n - 1, r * t) : y(t * t, n / 2, r)
      };
    e(e.P + e.F * (!!i && ("0.000" !== 8e-5.toFixed(3) || "1" !== .9.toFixed(0) || "1.25" !== 1.255.toFixed(2) ||
      "1000000000000000128" !== (0xde0b6b3a7640080).toFixed(0)) || !r(4)(function () {
      i.call({})
    })), "Number", {
      toFixed: function (t) {
        var n, r, e, i, o = s(this, h),
          u = a(t),
          c = "",
          f = "0";
        if (u < 0 || 20 < u) throw RangeError(h);
        if (o != o) return "NaN";
        if (o <= -1e21 || 1e21 <= o) return String(o);
        if (o < 0 && (c = "-", o = -o), 1e-21 < o)
          if (r = (n = function (t) {
              for (var n = 0, r = t; 4096 <= r;) n += 12, r /= 4096;
              for (; 2 <= r;) n += 1, r /= 2;
              return n
            }(o * y(2, 69, 1)) - 69) < 0 ? o * y(2, -n, 1) : o / y(2, n, 1), r *= 4503599627370496, 0 < (n =
              52 - n)) {
            for (v(0, r), e = u; 7 <= e;) v(1e7, 0), e -= 7;
            for (v(y(10, e, 1), 0), e = n - 1; 23 <= e;) p(1 << 23), e -= 23;
            p(1 << e), v(1, 1), p(2), f = d()
          } else v(0, r), v(1 << -n, 0), f = d() + l.call("0", u);
        return f = 0 < u ? c + ((i = f.length) <= u ? "0." + l.call("0", u - i) + f : f.slice(0, i - u) +
          "." + f.slice(i - u)) : c + f
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(4),
      o = r(165),
      u = 1..toPrecision;
    e(e.P + e.F * (i(function () {
      return "1" !== u.call(1, void 0)
    }) || !i(function () {
      u.call({})
    })), "Number", {
      toPrecision: function (t) {
        var n = o(this, "Number#toPrecision: incorrect invocation!");
        return void 0 === t ? u.call(n) : u.call(n, t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S + e.F, "Object", {
      assign: r(182)
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Object", {
      create: r(72)
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S + e.F * !r(10), "Object", {
      defineProperties: r(183)
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S + e.F * !r(10), "Object", {
      defineProperty: r(11).f
    })
  }, function (t, n, r) {
    var e = r(5),
      i = r(69).onFreeze;
    r(52)("freeze", function (n) {
      return function (t) {
        return n && e(t) ? n(i(t)) : t
      }
    })
  }, function (t, n, r) {
    var e = r(33),
      i = r(31).f;
    r(52)("getOwnPropertyDescriptor", function () {
      return function (t, n) {
        return i(e(t), n)
      }
    })
  }, function (t, n, r) {
    r(52)("getOwnPropertyNames", function () {
      return r(184).f
    })
  }, function (t, n, r) {
    var e = r(17),
      i = r(32);
    r(52)("getPrototypeOf", function () {
      return function (t) {
        return i(e(t))
      }
    })
  }, function (t, n, r) {
    var e = r(5);
    r(52)("isExtensible", function (n) {
      return function (t) {
        return !!e(t) && (!n || n(t))
      }
    })
  }, function (t, n, r) {
    var e = r(5);
    r(52)("isFrozen", function (n) {
      return function (t) {
        return !e(t) || !!n && n(t)
      }
    })
  }, function (t, n, r) {
    var e = r(5);
    r(52)("isSealed", function (n) {
      return function (t) {
        return !e(t) || !!n && n(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Object", {
      is: r(192)
    })
  }, function (t, n, r) {
    var e = r(17),
      i = r(74);
    r(52)("keys", function () {
      return function (t) {
        return i(e(t))
      }
    })
  }, function (t, n, r) {
    var e = r(5),
      i = r(69).onFreeze;
    r(52)("preventExtensions", function (n) {
      return function (t) {
        return n && e(t) ? n(i(t)) : t
      }
    })
  }, function (t, n, r) {
    var e = r(5),
      i = r(69).onFreeze;
    r(52)("seal", function (n) {
      return function (t) {
        return n && e(t) ? n(i(t)) : t
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Object", {
      setPrototypeOf: r(153).set
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(81),
      i = {};
    i[r(7)("toStringTag")] = "z", i + "" != "[object z]" && r(27)(Object.prototype, "toString", function () {
      return "[object " + e(this) + "]"
    }, !0)
  }, function (t, n, r) {
    var e = r(1),
      i = r(188);
    e(e.G + e.F * (parseFloat != i), {
      parseFloat: i
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(189);
    e(e.G + e.F * (parseInt != i), {
      parseInt: i
    })
  }, function (t, n, r) {
    "use strict";
    var e, i, o, u, c = r(68),
      f = r(3),
      a = r(47),
      s = r(81),
      l = r(1),
      h = r(5),
      v = r(21),
      p = r(70),
      d = r(71),
      y = r(119),
      g = r(158).set,
      b = r(150)(),
      x = r(151),
      m = r(190),
      S = r(133),
      w = r(191),
      _ = "Promise",
      O = f.TypeError,
      E = f.process,
      M = E && E.versions,
      P = M && M.v8 || "",
      j = f[_],
      F = "process" == s(E),
      A = function () {},
      I = i = x.f,
      L = !! function () {
        try {
          var t = j.resolve(1),
            n = (t.constructor = {})[r(7)("species")] = function (t) {
              t(A, A)
            };
          return (F || "function" == typeof PromiseRejectionEvent) && t.then(A) instanceof n && 0 !== P.indexOf(
            "6.6") && -1 === S.indexOf("Chrome/66")
        } catch (t) {}
      }(),
      N = function (t) {
        var n;
        return !(!h(t) || "function" != typeof (n = t.then)) && n
      },
      T = function (s, r) {
        if (!s._n) {
          s._n = !0;
          var e = s._c;
          b(function () {
            for (var f = s._v, a = 1 == s._s, t = 0, n = function (t) {
                var n, r, e, i = a ? t.ok : t.fail,
                  o = t.resolve,
                  u = t.reject,
                  c = t.domain;
                try {
                  i ? (a || (2 == s._h && C(s), s._h = 1), !0 === i ? n = f : (c && c.enter(), n = i(f), c &&
                      (c.exit(), e = !0)), n === t.promise ? u(O("Promise-chain cycle")) : (r = N(n)) ? r
                    .call(n, o, u) : o(n)) : u(f)
                } catch (t) {
                  c && !e && c.exit(), u(t)
                }
              }; e.length > t;) n(e[t++]);
            s._c = [], s._n = !1, r && !s._h && k(s)
          })
        }
      },
      k = function (o) {
        g.call(f, function () {
          var t, n, r, e = o._v,
            i = R(o);
          if (i && (t = m(function () {
              F ? E.emit("unhandledRejection", e, o) : (n = f.onunhandledrejection) ? n({
                promise: o,
                reason: e
              }) : (r = f.console) && r.error && r.error("Unhandled promise rejection", e)
            }), o._h = F || R(o) ? 2 : 1), o._a = void 0, i && t.e) throw t.v
        })
      },
      R = function (t) {
        return 1 !== t._h && 0 === (t._a || t._c).length
      },
      C = function (n) {
        g.call(f, function () {
          var t;
          F ? E.emit("rejectionHandled", n) : (t = f.onrejectionhandled) && t({
            promise: n,
            reason: n._v
          })
        })
      },
      D = function (t) {
        var n = this;
        n._d || (n._d = !0, (n = n._w || n)._v = t, n._s = 2, n._a || (n._a = n._c.slice()), T(n, !0))
      },
      G = function (t) {
        var r, e = this;
        if (!e._d) {
          e._d = !0, e = e._w || e;
          try {
            if (e === t) throw O("Promise can't be resolved itself");
            (r = N(t)) ? b(function () {
              var n = {
                _w: e,
                _d: !1
              };
              try {
                r.call(t, a(G, n, 1), a(D, n, 1))
              } catch (t) {
                D.call(n, t)
              }
            }): (e._v = t, e._s = 1, T(e, !1))
          } catch (t) {
            D.call({
              _w: e,
              _d: !1
            }, t)
          }
        }
      };
    L || (j = function (t) {
      p(this, j, _, "_h"), v(t), e.call(this);
      try {
        t(a(G, this, 1), a(D, this, 1))
      } catch (t) {
        D.call(this, t)
      }
    }, (e = function (t) {
      this._c = [], this._a = void 0, this._s = 0, this._d = !1, this._v = void 0, this._h = 0, this._n = !1
    }).prototype = r(76)(j.prototype, {
      then: function (t, n) {
        var r = I(y(this, j));
        return r.ok = "function" != typeof t || t, r.fail = "function" == typeof n && n, r.domain = F ? E
          .domain : void 0, this._c.push(r), this._a && this._a.push(r), this._s && T(this, !1), r.promise
      },
      catch: function (t) {
        return this.then(void 0, t)
      }
    }), o = function () {
      var t = new e;
      this.promise = t, this.resolve = a(G, t, 1), this.reject = a(D, t, 1)
    }, x.f = I = function (t) {
      return t === j || t === u ? new o(t) : i(t)
    }), l(l.G + l.W + l.F * !L, {
      Promise: j
    }), r(83)(j, _), r(77)(_), u = r(46)[_], l(l.S + l.F * !L, _, {
      reject: function (t) {
        var n = I(this);
        return (0, n.reject)(t), n.promise
      }
    }), l(l.S + l.F * (c || !L), _, {
      resolve: function (t) {
        return w(c && this === u ? j : this, t)
      }
    }), l(l.S + l.F * !(L && r(125)(function (t) {
      j.all(t).catch(A)
    })), _, {
      all: function (t) {
        var u = this,
          n = I(u),
          c = n.resolve,
          f = n.reject,
          r = m(function () {
            var e = [],
              i = 0,
              o = 1;
            d(t, !1, function (t) {
              var n = i++,
                r = !1;
              e.push(void 0), o++, u.resolve(t).then(function (t) {
                r || (r = !0, e[n] = t, --o || c(e))
              }, f)
            }), --o || c(e)
          });
        return r.e && f(r.v), n.promise
      },
      race: function (t) {
        var n = this,
          r = I(n),
          e = r.reject,
          i = m(function () {
            d(t, !1, function (t) {
              n.resolve(t).then(r.resolve, e)
            })
          });
        return i.e && e(i.v), r.promise
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      o = r(21),
      u = r(2),
      c = (r(3).Reflect || {}).apply,
      f = Function.apply;
    e(e.S + e.F * !r(4)(function () {
      c(function () {})
    }), "Reflect", {
      apply: function (t, n, r) {
        var e = o(t),
          i = u(r);
        return c ? c(e, n, i) : f.call(e, n, i)
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      c = r(72),
      f = r(21),
      a = r(2),
      s = r(5),
      i = r(4),
      l = r(169),
      h = (r(3).Reflect || {}).construct,
      v = i(function () {
        function t() {}
        return !(h(function () {}, [], t) instanceof t)
      }),
      p = !i(function () {
        h(function () {})
      });
    e(e.S + e.F * (v || p), "Reflect", {
      construct: function (t, n) {
        f(t), a(n);
        var r = arguments.length < 3 ? t : f(arguments[2]);
        if (p && !v) return h(t, n, r);
        if (t == r) {
          switch (n.length) {
            case 0:
              return new t;
            case 1:
              return new t(n[0]);
            case 2:
              return new t(n[0], n[1]);
            case 3:
              return new t(n[0], n[1], n[2]);
            case 4:
              return new t(n[0], n[1], n[2], n[3])
          }
          var e = [null];
          return e.push.apply(e, n), new(l.apply(t, e))
        }
        var i = r.prototype,
          o = c(s(i) ? i : Object.prototype),
          u = Function.apply.call(t, o, n);
        return s(u) ? u : o
      }
    })
  }, function (t, n, r) {
    var e = r(11),
      i = r(1),
      o = r(2),
      u = r(53);
    i(i.S + i.F * r(4)(function () {
      Reflect.defineProperty(e.f({}, 1, {
        value: 1
      }), 1, {
        value: 2
      })
    }), "Reflect", {
      defineProperty: function (t, n, r) {
        o(t), n = u(n, !0), o(r);
        try {
          return e.f(t, n, r), !0
        } catch (t) {
          return !1
        }
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(31).f,
      o = r(2);
    e(e.S, "Reflect", {
      deleteProperty: function (t, n) {
        var r = i(o(t), n);
        return !(r && !r.configurable) && delete t[n]
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(2),
      o = function (t) {
        this._t = i(t), this._i = 0;
        var n, r = this._k = [];
        for (n in t) r.push(n)
      };
    r(146)(o, "Object", function () {
      var t, n = this._k;
      do {
        if (this._i >= n.length) return {
          value: void 0,
          done: !0
        }
      } while (!((t = n[this._i++]) in this._t));
      return {
        value: t,
        done: !1
      }
    }), e(e.S, "Reflect", {
      enumerate: function (t) {
        return new o(t)
      }
    })
  }, function (t, n, r) {
    var e = r(31),
      i = r(1),
      o = r(2);
    i(i.S, "Reflect", {
      getOwnPropertyDescriptor: function (t, n) {
        return e.f(o(t), n)
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(32),
      o = r(2);
    e(e.S, "Reflect", {
      getPrototypeOf: function (t) {
        return i(o(t))
      }
    })
  }, function (t, n, r) {
    var u = r(31),
      c = r(32),
      f = r(30),
      e = r(1),
      a = r(5),
      s = r(2);
    e(e.S, "Reflect", {
      get: function t(n, r) {
        var e, i, o = arguments.length < 3 ? n : arguments[2];
        return s(n) === o ? n[r] : (e = u.f(n, r)) ? f(e, "value") ? e.value : void 0 !== e.get ? e.get.call(
          o) : void 0 : a(i = c(n)) ? t(i, r, o) : void 0
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Reflect", {
      has: function (t, n) {
        return n in t
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(2),
      o = Object.isExtensible;
    e(e.S, "Reflect", {
      isExtensible: function (t) {
        return i(t), !o || o(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Reflect", {
      ownKeys: r(187)
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(2),
      o = Object.preventExtensions;
    e(e.S, "Reflect", {
      preventExtensions: function (t) {
        i(t);
        try {
          return o && o(t), !0
        } catch (t) {
          return !1
        }
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(153);
    i && e(e.S, "Reflect", {
      setPrototypeOf: function (t, n) {
        i.check(t, n);
        try {
          return i.set(t, n), !0
        } catch (t) {
          return !1
        }
      }
    })
  }, function (t, n, r) {
    var f = r(11),
      a = r(31),
      s = r(32),
      l = r(30),
      e = r(1),
      h = r(75),
      v = r(2),
      p = r(5);
    e(e.S, "Reflect", {
      set: function t(n, r, e) {
        var i, o, u = arguments.length < 4 ? n : arguments[3],
          c = a.f(v(n), r);
        if (!c) {
          if (p(o = s(n))) return t(o, r, e, u);
          c = h(0)
        }
        if (l(c, "value")) {
          if (!1 === c.writable || !p(u)) return !1;
          if (i = a.f(u, r)) {
            if (i.get || i.set || !1 === i.writable) return !1;
            i.value = e, f.f(u, r, i)
          } else f.f(u, r, h(0, e));
          return !0
        }
        return void 0 !== c.set && (c.set.call(u, e), !0)
      }
    })
  }, function (t, n, r) {
    var e = r(3),
      o = r(144),
      i = r(11).f,
      u = r(73).f,
      c = r(124),
      f = r(115),
      a = e.RegExp,
      s = a,
      l = a.prototype,
      h = /a/g,
      v = /a/g,
      p = new a(h) !== h;
    if (r(10) && (!p || r(4)(function () {
        return v[r(7)("match")] = !1, a(h) != h || a(v) == v || "/a/i" != a(h, "i")
      }))) {
      a = function (t, n) {
        var r = this instanceof a,
          e = c(t),
          i = void 0 === n;
        return !r && e && t.constructor === a && i ? t : o(p ? new s(e && !i ? t.source : t, n) : s((e =
          t instanceof a) ? t.source : t, e && i ? f.call(t) : n), r ? this : l, a)
      };
      for (var d = function (n) {
          n in a || i(a, n, {
            configurable: !0,
            get: function () {
              return s[n]
            },
            set: function (t) {
              s[n] = t
            }
          })
        }, y = u(s), g = 0; y.length > g;) d(y[g++]);
      (l.constructor = a).prototype = l, r(27)(e, "RegExp", a)
    }
    r(77)("RegExp")
  }, function (t, n, r) {
    "use strict";
    var l = r(2),
      h = r(8),
      v = r(136),
      p = r(128);
    r(122)("match", 1, function (e, i, a, s) {
      return [function (t) {
        var n = e(this),
          r = null == t ? void 0 : t[i];
        return void 0 !== r ? r.call(t, n) : new RegExp(t)[i](String(n))
      }, function (t) {
        var n = s(a, t, this);
        if (n.done) return n.value;
        var r = l(t),
          e = String(this);
        if (!r.global) return p(r, e);
        for (var i, o = r.unicode, u = [], c = r.lastIndex = 0; null !== (i = p(r, e));) {
          var f = String(i[0]);
          "" === (u[c] = f) && (r.lastIndex = v(e, h(r.lastIndex), o)), c++
        }
        return 0 === c ? null : u
      }]
    })
  }, function (t, n, r) {
    "use strict";
    var O = r(2),
      e = r(17),
      E = r(8),
      M = r(49),
      P = r(136),
      j = r(128),
      F = Math.max,
      A = Math.min,
      h = Math.floor,
      v = /\$([$&`']|\d\d?|<[^>]*>)/g,
      p = /\$([$&`']|\d\d?)/g;
    r(122)("replace", 2, function (i, o, S, w) {
      function _(o, u, c, f, a, t) {
        var s = c + o.length,
          l = f.length,
          n = p;
        return void 0 !== a && (a = e(a), n = v), S.call(t, n, function (t, n) {
          var r;
          switch (n.charAt(0)) {
            case "$":
              return "$";
            case "&":
              return o;
            case "`":
              return u.slice(0, c);
            case "'":
              return u.slice(s);
            case "<":
              r = a[n.slice(1, -1)];
              break;
            default:
              var e = +n;
              if (0 === e) return t;
              if (l < e) {
                var i = h(e / 10);
                return 0 === i ? t : i <= l ? void 0 === f[i - 1] ? n.charAt(1) : f[i - 1] + n.charAt(1) : t
              }
              r = f[e - 1]
          }
          return void 0 === r ? "" : r
        })
      }
      return [function (t, n) {
        var r = i(this),
          e = null == t ? void 0 : t[o];
        return void 0 !== e ? e.call(t, r, n) : S.call(String(r), t, n)
      }, function (t, n) {
        var r = w(S, t, this, n);
        if (r.done) return r.value;
        var e = O(t),
          i = String(this),
          o = "function" == typeof n;
        o || (n = String(n));
        var u, c = e.global;
        if (c) {
          var f = e.unicode;
          e.lastIndex = 0
        }
        for (var a = [];;) {
          var s = j(e, i);
          if (null === s) break;
          if (a.push(s), !c) break;
          "" === String(s[0]) && (e.lastIndex = P(i, E(e.lastIndex), f))
        }
        for (var l = "", h = 0, v = 0; v < a.length; v++) {
          s = a[v];
          for (var p = String(s[0]), d = F(A(M(s.index), i.length), 0), y = [], g = 1; g < s.length; g++) y
            .push(void 0 === (u = s[g]) ? u : String(u));
          var b = s.groups;
          if (o) {
            var x = [p].concat(y, d, i);
            void 0 !== b && x.push(b);
            var m = String(n.apply(void 0, x))
          } else m = _(p, i, d, y, b, n);
          h <= d && (l += i.slice(h, d) + m, h = d + p.length)
        }
        return l + i.slice(h)
      }]
    })
  }, function (t, n, r) {
    "use strict";
    var f = r(2),
      a = r(192),
      s = r(128);
    r(122)("search", 1, function (e, i, u, c) {
      return [function (t) {
        var n = e(this),
          r = null == t ? void 0 : t[i];
        return void 0 !== r ? r.call(t, n) : new RegExp(t)[i](String(n))
      }, function (t) {
        var n = c(u, t, this);
        if (n.done) return n.value;
        var r = f(t),
          e = String(this),
          i = r.lastIndex;
        a(i, 0) || (r.lastIndex = 0);
        var o = s(r, e);
        return a(r.lastIndex, i) || (r.lastIndex = i), null === o ? -1 : o.index
      }]
    })
  }, function (t, n, r) {
    "use strict";
    var l = r(124),
      x = r(2),
      m = r(119),
      S = r(136),
      w = r(8),
      _ = r(128),
      h = r(152),
      e = r(4),
      O = Math.min,
      v = [].push,
      u = "split",
      p = "length",
      d = "lastIndex",
      E = 4294967295,
      M = !e(function () {
        RegExp(E, "y")
      });
    r(122)("split", 2, function (i, o, y, g) {
      var b;
      return b = "c" == "abbc" [u](/(b)*/)[1] || 4 != "test" [u](/(?:)/, -1)[p] || 2 != "ab" [u](/(?:ab)*/)[
        p] || 4 != "." [u](/(.?)(.?)/)[p] || 1 < "." [u](/()()/)[p] || "" [u](/.?/)[p] ? function (t, n) {
          var r = String(this);
          if (void 0 === t && 0 === n) return [];
          if (!l(t)) return y.call(r, t, n);
          for (var e, i, o, u = [], c = (t.ignoreCase ? "i" : "") + (t.multiline ? "m" : "") + (t.unicode ?
              "u" : "") + (t.sticky ? "y" : ""), f = 0, a = void 0 === n ? E : n >>> 0, s = new RegExp(t
              .source, c + "g");
            (e = h.call(s, r)) && !(f < (i = s[d]) && (u.push(r.slice(f, e.index)), 1 < e[p] && e.index < r[
              p] && v.apply(u, e.slice(1)), o = e[0][p], f = i, u[p] >= a));) s[d] === e.index && s[d]++;
          return f === r[p] ? !o && s.test("") || u.push("") : u.push(r.slice(f)), u[p] > a ? u.slice(0, a) : u
        } : "0" [u](void 0, 0)[p] ? function (t, n) {
          return void 0 === t && 0 === n ? [] : y.call(this, t, n)
        } : y, [function (t, n) {
          var r = i(this),
            e = null == t ? void 0 : t[o];
          return void 0 !== e ? e.call(t, r, n) : b.call(String(r), t, n)
        }, function (t, n) {
          var r = g(b, t, this, n, b !== y);
          if (r.done) return r.value;
          var e = x(t),
            i = String(this),
            o = m(e, RegExp),
            u = e.unicode,
            c = (e.ignoreCase ? "i" : "") + (e.multiline ? "m" : "") + (e.unicode ? "u" : "") + (M ? "y" :
              "g"),
            f = new o(M ? e : "^(?:" + e.source + ")", c),
            a = void 0 === n ? E : n >>> 0;
          if (0 === a) return [];
          if (0 === i.length) return null === _(f, i) ? [i] : [];
          for (var s = 0, l = 0, h = []; l < i.length;) {
            f.lastIndex = M ? l : 0;
            var v, p = _(f, M ? i : i.slice(l));
            if (null === p || (v = O(w(f.lastIndex + (M ? 0 : l)), i.length)) === s) l = S(i, l, u);
            else {
              if (h.push(i.slice(s, l)), h.length === a) return h;
              for (var d = 1; d <= p.length - 1; d++)
                if (h.push(p[d]), h.length === a) return h;
              l = s = v
            }
          }
          return h.push(i.slice(s)), h
        }]
    })
  }, function (t, n, r) {
    "use strict";
    r(198);
    var e = r(2),
      i = r(115),
      o = r(10),
      u = "toString",
      c = /./ [u],
      f = function (t) {
        r(27)(RegExp.prototype, u, t, !0)
      };
    r(4)(function () {
      return "/a/b" != c.call({
        source: "a",
        flags: "b"
      })
    }) ? f(function () {
      var t = e(this);
      return "/".concat(t.source, "/", "flags" in t ? t.flags : !o && t instanceof RegExp ? i.call(t) : void 0)
    }) : c.name != u && f(function () {
      return c.call(this)
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("anchor", function (n) {
      return function (t) {
        return n(this, "a", "name", t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("big", function (t) {
      return function () {
        return t(this, "big", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("blink", function (t) {
      return function () {
        return t(this, "blink", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("bold", function (t) {
      return function () {
        return t(this, "b", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(131)(!1);
    e(e.P, "String", {
      codePointAt: function (t) {
        return i(this, t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      u = r(8),
      c = r(155),
      f = "endsWith",
      a = "" [f];
    e(e.P + e.F * r(142)(f), "String", {
      endsWith: function (t) {
        var n = c(this, t, f),
          r = 1 < arguments.length ? arguments[1] : void 0,
          e = u(n.length),
          i = void 0 === r ? e : Math.min(u(r), e),
          o = String(t);
        return a ? a.call(n, o, i) : n.slice(i - o.length, i) === o
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("fixed", function (t) {
      return function () {
        return t(this, "tt", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("fontcolor", function (n) {
      return function (t) {
        return n(this, "font", "color", t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("fontsize", function (n) {
      return function (t) {
        return n(this, "font", "size", t)
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      o = r(78),
      u = String.fromCharCode,
      i = String.fromCodePoint;
    e(e.S + e.F * (!!i && 1 != i.length), "String", {
      fromCodePoint: function (t) {
        for (var n, r = [], e = arguments.length, i = 0; i < e;) {
          if (n = +arguments[i++], o(n, 1114111) !== n) throw RangeError(n + " is not a valid code point");
          r.push(n < 65536 ? u(n) : u(55296 + ((n -= 65536) >> 10), n % 1024 + 56320))
        }
        return r.join("")
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(155);
    e(e.P + e.F * r(142)("includes"), "String", {
      includes: function (t) {
        return !!~i(this, t, "includes").indexOf(t, 1 < arguments.length ? arguments[1] : void 0)
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("italics", function (t) {
      return function () {
        return t(this, "i", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(131)(!0);
    r(147)(String, "String", function (t) {
      this._t = String(t), this._i = 0
    }, function () {
      var t, n = this._t,
        r = this._i;
      return r >= n.length ? {
        value: void 0,
        done: !0
      } : (t = e(n, r), this._i += t.length, {
        value: t,
        done: !1
      })
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("link", function (n) {
      return function (t) {
        return n(this, "a", "href", t)
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      u = r(33),
      c = r(8);
    e(e.S, "String", {
      raw: function (t) {
        for (var n = u(t.raw), r = c(n.length), e = arguments.length, i = [], o = 0; o < r;) i.push(String(n[
          o++])), o < e && i.push(String(arguments[o]));
        return i.join("")
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P, "String", {
      repeat: r(156)
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("small", function (t) {
      return function () {
        return t(this, "small", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(8),
      o = r(155),
      u = "startsWith",
      c = "" [u];
    e(e.P + e.F * r(142)(u), "String", {
      startsWith: function (t) {
        var n = o(this, t, u),
          r = i(Math.min(1 < arguments.length ? arguments[1] : void 0, n.length)),
          e = String(t);
        return c ? c.call(n, e, r) : n.slice(r, r + e.length) === e
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("strike", function (t) {
      return function () {
        return t(this, "strike", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("sub", function (t) {
      return function () {
        return t(this, "sub", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(28)("sup", function (t) {
      return function () {
        return t(this, "sup", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(84)("trim", function (t) {
      return function () {
        return t(this, 3)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(3),
      u = r(30),
      i = r(10),
      o = r(1),
      c = r(27),
      f = r(69).KEY,
      a = r(4),
      s = r(118),
      l = r(83),
      h = r(79),
      v = r(7),
      p = r(195),
      d = r(160),
      y = r(218),
      g = r(123),
      b = r(2),
      x = r(5),
      m = r(17),
      S = r(33),
      w = r(53),
      _ = r(75),
      O = r(72),
      E = r(184),
      M = r(31),
      P = r(127),
      j = r(11),
      F = r(74),
      A = M.f,
      I = j.f,
      L = E.f,
      N = e.Symbol,
      T = e.JSON,
      k = T && T.stringify,
      R = "prototype",
      C = v("_hidden"),
      D = v("toPrimitive"),
      G = {}.propertyIsEnumerable,
      W = s("symbol-registry"),
      U = s("symbols"),
      V = s("op-symbols"),
      B = Object[R],
      q = "function" == typeof N && !!P.f,
      z = e.QObject,
      K = !z || !z[R] || !z[R].findChild,
      H = i && a(function () {
        return 7 != O(I({}, "a", {
          get: function () {
            return I(this, "a", {
              value: 7
            }).a
          }
        })).a
      }) ? function (t, n, r) {
        var e = A(B, n);
        e && delete B[n], I(t, n, r), e && t !== B && I(B, n, e)
      } : I,
      J = function (t) {
        var n = U[t] = O(N[R]);
        return n._k = t, n
      },
      $ = q && "symbol" == typeof N.iterator ? function (t) {
        return "symbol" == typeof t
      } : function (t) {
        return t instanceof N
      },
      Y = function (t, n, r) {
        return t === B && Y(V, n, r), b(t), n = w(n, !0), b(r), u(U, n) ? (r.enumerable ? (u(t, C) && t[C][n] && (t[
          C][n] = !1), r = O(r, {
          enumerable: _(0, !1)
        })) : (u(t, C) || I(t, C, _(1, {})), t[C][n] = !0), H(t, n, r)) : I(t, n, r)
      },
      X = function (t, n) {
        b(t);
        for (var r, e = y(n = S(n)), i = 0, o = e.length; i < o;) Y(t, r = e[i++], n[r]);
        return t
      },
      Q = function (t) {
        var n = G.call(this, t = w(t, !0));
        return !(this === B && u(U, t) && !u(V, t)) && (!(n || !u(this, t) || !u(U, t) || u(this, C) && this[C][
          t]) || n)
      },
      Z = function (t, n) {
        if (t = S(t), n = w(n, !0), t !== B || !u(U, n) || u(V, n)) {
          var r = A(t, n);
          return !r || !u(U, n) || u(t, C) && t[C][n] || (r.enumerable = !0), r
        }
      },
      tt = function (t) {
        for (var n, r = L(S(t)), e = [], i = 0; r.length > i;) u(U, n = r[i++]) || n == C || n == f || e.push(n);
        return e
      },
      nt = function (t) {
        for (var n, r = t === B, e = L(r ? V : S(t)), i = [], o = 0; e.length > o;) !u(U, n = e[o++]) || r && !u(B,
          n) || i.push(U[n]);
        return i
      };
    q || (c((N = function () {
      if (this instanceof N) throw TypeError("Symbol is not a constructor!");
      var n = h(0 < arguments.length ? arguments[0] : void 0),
        r = function (t) {
          this === B && r.call(V, t), u(this, C) && u(this[C], n) && (this[C][n] = !1), H(this, n, _(1, t))
        };
      return i && K && H(B, n, {
        configurable: !0,
        set: r
      }), J(n)
    })[R], "toString", function () {
      return this._k
    }), M.f = Z, j.f = Y, r(73).f = E.f = tt, r(117).f = Q, P.f = nt, i && !r(68) && c(B,
      "propertyIsEnumerable", Q, !0), p.f = function (t) {
      return J(v(t))
    }), o(o.G + o.W + o.F * !q, {
      Symbol: N
    });
    for (var rt =
        "hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables"
        .split(","), et = 0; rt.length > et;) v(rt[et++]);
    for (var it = F(v.store), ot = 0; it.length > ot;) d(it[ot++]);
    o(o.S + o.F * !q, "Symbol", {
      for: function (t) {
        return u(W, t += "") ? W[t] : W[t] = N(t)
      },
      keyFor: function (t) {
        if (!$(t)) throw TypeError(t + " is not a symbol!");
        for (var n in W)
          if (W[n] === t) return n
      },
      useSetter: function () {
        K = !0
      },
      useSimple: function () {
        K = !1
      }
    }), o(o.S + o.F * !q, "Object", {
      create: function (t, n) {
        return void 0 === n ? O(t) : X(O(t), n)
      },
      defineProperty: Y,
      defineProperties: X,
      getOwnPropertyDescriptor: Z,
      getOwnPropertyNames: tt,
      getOwnPropertySymbols: nt
    });
    var ut = a(function () {
      P.f(1)
    });
    o(o.S + o.F * ut, "Object", {
      getOwnPropertySymbols: function (t) {
        return P.f(m(t))
      }
    }), T && o(o.S + o.F * (!q || a(function () {
      var t = N();
      return "[null]" != k([t]) || "{}" != k({
        a: t
      }) || "{}" != k(Object(t))
    })), "JSON", {
      stringify: function (t) {
        for (var n, r, e = [t], i = 1; arguments.length > i;) e.push(arguments[i++]);
        if (r = n = e[1], (x(n) || void 0 !== t) && !$(t)) return g(n) || (n = function (t, n) {
          if ("function" == typeof r && (n = r.call(this, t, n)), !$(n)) return n
        }), e[1] = n, k.apply(T, e)
      }
    }), N[R][D] || r(26)(N[R], D, N[R].valueOf), l(N, "Symbol"), l(Math, "Math", !0), l(e.JSON, "JSON", !0)
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(132),
      o = r(159),
      a = r(2),
      s = r(78),
      l = r(8),
      u = r(5),
      c = r(3).ArrayBuffer,
      h = r(119),
      v = o.ArrayBuffer,
      p = o.DataView,
      f = i.ABV && c.isView,
      d = v.prototype.slice,
      y = i.VIEW,
      g = "ArrayBuffer";
    e(e.G + e.W + e.F * (c !== v), {
      ArrayBuffer: v
    }), e(e.S + e.F * !i.CONSTR, g, {
      isView: function (t) {
        return f && f(t) || u(t) && y in t
      }
    }), e(e.P + e.U + e.F * r(4)(function () {
      return !new v(2).slice(1, void 0).byteLength
    }), g, {
      slice: function (t, n) {
        if (void 0 !== d && void 0 === n) return d.call(a(this), t);
        for (var r = a(this).byteLength, e = s(t, r), i = s(void 0 === n ? r : n, r), o = new(h(this, v))(l(
            i - e)), u = new p(this), c = new p(o), f = 0; e < i;) c.setUint8(f++, u.getUint8(e++));
        return o
      }
    }), r(77)(g)
  }, function (t, n, r) {
    var e = r(1);
    e(e.G + e.W + e.F * !r(132).ABV, {
      DataView: r(159).DataView
    })
  }, function (t, n, r) {
    r(57)("Float32", 4, function (e) {
      return function (t, n, r) {
        return e(this, t, n, r)
      }
    })
  }, function (t, n, r) {
    r(57)("Float64", 8, function (e) {
      return function (t, n, r) {
        return e(this, t, n, r)
      }
    })
  }, function (t, n, r) {
    r(57)("Int16", 2, function (e) {
      return function (t, n, r) {
        return e(this, t, n, r)
      }
    })
  }, function (t, n, r) {
    r(57)("Int32", 4, function (e) {
      return function (t, n, r) {
        return e(this, t, n, r)
      }
    })
  }, function (t, n, r) {
    r(57)("Int8", 1, function (e) {
      return function (t, n, r) {
        return e(this, t, n, r)
      }
    })
  }, function (t, n, r) {
    r(57)("Uint16", 2, function (e) {
      return function (t, n, r) {
        return e(this, t, n, r)
      }
    })
  }, function (t, n, r) {
    r(57)("Uint32", 4, function (e) {
      return function (t, n, r) {
        return e(this, t, n, r)
      }
    })
  }, function (t, n, r) {
    r(57)("Uint8", 1, function (e) {
      return function (t, n, r) {
        return e(this, t, n, r)
      }
    })
  }, function (t, n, r) {
    r(57)("Uint8", 1, function (e) {
      return function (t, n, r) {
        return e(this, t, n, r)
      }
    }, !0)
  }, function (t, n, r) {
    "use strict";
    var e = r(172),
      i = r(80);
    r(121)("WeakSet", function (t) {
      return function () {
        return t(this, 0 < arguments.length ? arguments[0] : void 0)
      }
    }, {
      add: function (t) {
        return e.def(i(this, "WeakSet"), t, !0)
      }
    }, e, !1, !0)
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(173),
      o = r(17),
      u = r(8),
      c = r(21),
      f = r(138);
    e(e.P, "Array", {
      flatMap: function (t) {
        var n, r, e = o(this);
        return c(t), n = u(e.length), r = f(e, 0), i(r, e, e, n, 0, 1, t, arguments[1]), r
      }
    }), r(67)("flatMap")
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(173),
      o = r(17),
      u = r(8),
      c = r(49),
      f = r(138);
    e(e.P, "Array", {
      flatten: function () {
        var t = arguments[0],
          n = o(this),
          r = u(n.length),
          e = f(n, 0);
        return i(e, n, n, r, 0, void 0 === t ? 1 : c(t)), e
      }
    }), r(67)("flatten")
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(120)(!0);
    e(e.P, "Array", {
      includes: function (t) {
        return i(this, t, 1 < arguments.length ? arguments[1] : void 0)
      }
    }), r(67)("includes")
  }, function (t, n, r) {
    var e = r(1),
      i = r(150)(),
      o = r(3).process,
      u = "process" == r(45)(o);
    e(e.G, {
      asap: function (t) {
        var n = u && o.domain;
        i(n ? n.bind(t) : t)
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(45);
    e(e.S, "Error", {
      isError: function (t) {
        return "Error" === i(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.G, {
      global: r(3)
    })
  }, function (t, n, r) {
    r(129)("Map")
  }, function (t, n, r) {
    r(130)("Map")
  }, function (t, n, r) {
    var e = r(1);
    e(e.P + e.R, "Map", {
      toJSON: r(171)("Map")
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      clamp: function (t, n, r) {
        return Math.min(r, Math.max(n, t))
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      DEG_PER_RAD: Math.PI / 180
    })
  }, function (t, n, r) {
    var e = r(1),
      i = 180 / Math.PI;
    e(e.S, "Math", {
      degrees: function (t) {
        return t * i
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      o = r(181),
      u = r(179);
    e(e.S, "Math", {
      fscale: function (t, n, r, e, i) {
        return u(o(t, n, r, e, i))
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      iaddh: function (t, n, r, e) {
        var i = t >>> 0,
          o = r >>> 0;
        return (n >>> 0) + (e >>> 0) + ((i & o | (i | o) & ~(i + o >>> 0)) >>> 31) | 0
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      imulh: function (t, n) {
        var r = +t,
          e = +n,
          i = 65535 & r,
          o = 65535 & e,
          u = r >> 16,
          c = e >> 16,
          f = (u * o >>> 0) + (i * o >>> 16);
        return u * c + (f >> 16) + ((i * c >>> 0) + (65535 & f) >> 16)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      isubh: function (t, n, r, e) {
        var i = t >>> 0,
          o = r >>> 0;
        return (n >>> 0) - (e >>> 0) - ((~i & o | ~(i ^ o) & i - o >>> 0) >>> 31) | 0
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      RAD_PER_DEG: 180 / Math.PI
    })
  }, function (t, n, r) {
    var e = r(1),
      i = Math.PI / 180;
    e(e.S, "Math", {
      radians: function (t) {
        return t * i
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      scale: r(181)
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      signbit: function (t) {
        return (t = +t) != t ? t : 0 == t ? 1 / t == 1 / 0 : 0 < t
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      umulh: function (t, n) {
        var r = +t,
          e = +n,
          i = 65535 & r,
          o = 65535 & e,
          u = r >>> 16,
          c = e >>> 16,
          f = (u * o >>> 0) + (i * o >>> 16);
        return u * c + (f >>> 16) + ((i * c >>> 0) + (65535 & f) >>> 16)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(17),
      o = r(21),
      u = r(11);
    r(10) && e(e.P + r(126), "Object", {
      __defineGetter__: function (t, n) {
        u.f(i(this), t, {
          get: o(n),
          enumerable: !0,
          configurable: !0
        })
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(17),
      o = r(21),
      u = r(11);
    r(10) && e(e.P + r(126), "Object", {
      __defineSetter__: function (t, n) {
        u.f(i(this), t, {
          set: o(n),
          enumerable: !0,
          configurable: !0
        })
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(186)(!0);
    e(e.S, "Object", {
      entries: function (t) {
        return i(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      f = r(187),
      a = r(33),
      s = r(31),
      l = r(139);
    e(e.S, "Object", {
      getOwnPropertyDescriptors: function (t) {
        for (var n, r, e = a(t), i = s.f, o = f(e), u = {}, c = 0; o.length > c;) void 0 !== (r = i(e, n = o[
          c++])) && l(u, n, r);
        return u
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(17),
      o = r(53),
      u = r(32),
      c = r(31).f;
    r(10) && e(e.P + r(126), "Object", {
      __lookupGetter__: function (t) {
        var n, r = i(this),
          e = o(t, !0);
        do {
          if (n = c(r, e)) return n.get
        } while (r = u(r))
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(17),
      o = r(53),
      u = r(32),
      c = r(31).f;
    r(10) && e(e.P + r(126), "Object", {
      __lookupSetter__: function (t) {
        var n, r = i(this),
          e = o(t, !0);
        do {
          if (n = c(r, e)) return n.set
        } while (r = u(r))
      }
    })
  }, function (t, n, r) {
    var e = r(1),
      i = r(186)(!1);
    e(e.S, "Object", {
      values: function (t) {
        return i(t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      o = r(3),
      u = r(46),
      i = r(150)(),
      c = r(7)("observable"),
      f = r(21),
      a = r(2),
      s = r(70),
      l = r(76),
      h = r(26),
      v = r(71),
      p = v.RETURN,
      d = function (t) {
        return null == t ? void 0 : f(t)
      },
      y = function (t) {
        var n = t._c;
        n && (t._c = void 0, n())
      },
      g = function (t) {
        return void 0 === t._o
      },
      b = function (t) {
        g(t) || (t._o = void 0, y(t))
      },
      x = function (t, n) {
        a(t), this._c = void 0, this._o = t, t = new m(this);
        try {
          var r = n(t),
            e = r;
          null != r && ("function" == typeof r.unsubscribe ? r = function () {
            e.unsubscribe()
          } : f(r), this._c = r)
        } catch (n) {
          return void t.error(n)
        }
        g(this) && y(this)
      };
    x.prototype = l({}, {
      unsubscribe: function () {
        b(this)
      }
    });
    var m = function (t) {
      this._s = t
    };
    m.prototype = l({}, {
      next: function (t) {
        var n = this._s;
        if (!g(n)) {
          var r = n._o;
          try {
            var e = d(r.next);
            if (e) return e.call(r, t)
          } catch (t) {
            try {
              b(n)
            } finally {
              throw t
            }
          }
        }
      },
      error: function (t) {
        var n = this._s;
        if (g(n)) throw t;
        var r = n._o;
        n._o = void 0;
        try {
          var e = d(r.error);
          if (!e) throw t;
          t = e.call(r, t)
        } catch (t) {
          try {
            y(n)
          } finally {
            throw t
          }
        }
        return y(n), t
      },
      complete: function (t) {
        var n = this._s;
        if (!g(n)) {
          var r = n._o;
          n._o = void 0;
          try {
            var e = d(r.complete);
            t = e ? e.call(r, t) : void 0
          } catch (t) {
            try {
              y(n)
            } finally {
              throw t
            }
          }
          return y(n), t
        }
      }
    });
    var S = function (t) {
      s(this, S, "Observable", "_f")._f = f(t)
    };
    l(S.prototype, {
      subscribe: function (t) {
        return new x(t, this._f)
      },
      forEach: function (e) {
        var i = this;
        return new(u.Promise || o.Promise)(function (t, n) {
          f(e);
          var r = i.subscribe({
            next: function (t) {
              try {
                return e(t)
              } catch (t) {
                n(t), r.unsubscribe()
              }
            },
            error: n,
            complete: t
          })
        })
      }
    }), l(S, {
      from: function (t) {
        var n = "function" == typeof this ? this : S,
          r = d(a(t)[c]);
        if (r) {
          var e = a(r.call(t));
          return e.constructor === n ? e : new n(function (t) {
            return e.subscribe(t)
          })
        }
        return new n(function (n) {
          var r = !1;
          return i(function () {
              if (!r) {
                try {
                  if (v(t, !1, function (t) {
                      if (n.next(t), r) return p
                    }) === p) return
                } catch (t) {
                  if (r) throw t;
                  return void n.error(t)
                }
                n.complete()
              }
            }),
            function () {
              r = !0
            }
        })
      },
      of: function () {
        for (var t = 0, n = arguments.length, e = new Array(n); t < n;) e[t] = arguments[t++];
        return new("function" == typeof this ? this : S)(function (n) {
          var r = !1;
          return i(function () {
              if (!r) {
                for (var t = 0; t < e.length; ++t)
                  if (n.next(e[t]), r) return;
                n.complete()
              }
            }),
            function () {
              r = !0
            }
        })
      }
    }), h(S.prototype, c, function () {
      return this
    }), e(e.G, {
      Observable: S
    }), r(77)("Observable")
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(46),
      o = r(3),
      u = r(119),
      c = r(191);
    e(e.P + e.R, "Promise", {
      finally: function (n) {
        var r = u(this, i.Promise || o.Promise),
          t = "function" == typeof n;
        return this.then(t ? function (t) {
          return c(r, n()).then(function () {
            return t
          })
        } : n, t ? function (t) {
          return c(r, n()).then(function () {
            throw t
          })
        } : n)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(151),
      o = r(190);
    e(e.S, "Promise", {
      try: function (t) {
        var n = i.f(this),
          r = o(t);
        return (r.e ? n.reject : n.resolve)(r.v), n.promise
      }
    })
  }, function (t, n, r) {
    var e = r(56),
      i = r(2),
      o = e.key,
      u = e.set;
    e.exp({
      defineMetadata: function (t, n, r, e) {
        u(t, n, i(r), o(e))
      }
    })
  }, function (t, n, r) {
    var e = r(56),
      o = r(2),
      u = e.key,
      c = e.map,
      f = e.store;
    e.exp({
      deleteMetadata: function (t, n) {
        var r = arguments.length < 3 ? void 0 : u(arguments[2]),
          e = c(o(n), r, !1);
        if (void 0 === e || !e.delete(t)) return !1;
        if (e.size) return !0;
        var i = f.get(n);
        return i.delete(r), !!i.size || f.delete(n)
      }
    })
  }, function (t, n, r) {
    var o = r(199),
      u = r(167),
      e = r(56),
      i = r(2),
      c = r(32),
      f = e.keys,
      a = e.key,
      s = function (t, n) {
        var r = f(t, n),
          e = c(t);
        if (null === e) return r;
        var i = s(e, n);
        return i.length ? r.length ? u(new o(r.concat(i))) : i : r
      };
    e.exp({
      getMetadataKeys: function (t) {
        return s(i(t), arguments.length < 2 ? void 0 : a(arguments[1]))
      }
    })
  }, function (t, n, r) {
    var e = r(56),
      i = r(2),
      o = r(32),
      u = e.has,
      c = e.get,
      f = e.key,
      a = function (t, n, r) {
        if (u(t, n, r)) return c(t, n, r);
        var e = o(n);
        return null !== e ? a(t, e, r) : void 0
      };
    e.exp({
      getMetadata: function (t, n) {
        return a(t, i(n), arguments.length < 3 ? void 0 : f(arguments[2]))
      }
    })
  }, function (t, n, r) {
    var e = r(56),
      i = r(2),
      o = e.keys,
      u = e.key;
    e.exp({
      getOwnMetadataKeys: function (t) {
        return o(i(t), arguments.length < 2 ? void 0 : u(arguments[1]))
      }
    })
  }, function (t, n, r) {
    var e = r(56),
      i = r(2),
      o = e.get,
      u = e.key;
    e.exp({
      getOwnMetadata: function (t, n) {
        return o(t, i(n), arguments.length < 3 ? void 0 : u(arguments[2]))
      }
    })
  }, function (t, n, r) {
    var e = r(56),
      i = r(2),
      o = r(32),
      u = e.has,
      c = e.key,
      f = function (t, n, r) {
        if (u(t, n, r)) return !0;
        var e = o(n);
        return null !== e && f(t, e, r)
      };
    e.exp({
      hasMetadata: function (t, n) {
        return f(t, i(n), arguments.length < 3 ? void 0 : c(arguments[2]))
      }
    })
  }, function (t, n, r) {
    var e = r(56),
      i = r(2),
      o = e.has,
      u = e.key;
    e.exp({
      hasOwnMetadata: function (t, n) {
        return o(t, i(n), arguments.length < 3 ? void 0 : u(arguments[2]))
      }
    })
  }, function (t, n, r) {
    var e = r(56),
      i = r(2),
      o = r(21),
      u = e.key,
      c = e.set;
    e.exp({
      metadata: function (r, e) {
        return function (t, n) {
          c(r, e, (void 0 !== n ? i : o)(t), u(n))
        }
      }
    })
  }, function (t, n, r) {
    r(129)("Set")
  }, function (t, n, r) {
    r(130)("Set")
  }, function (t, n, r) {
    var e = r(1);
    e(e.P + e.R, "Set", {
      toJSON: r(171)("Set")
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(131)(!0);
    e(e.P, "String", {
      at: function (t) {
        return i(this, t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(51),
      o = r(8),
      u = r(124),
      c = r(115),
      f = RegExp.prototype,
      a = function (t, n) {
        this._r = t, this._s = n
      };
    r(146)(a, "RegExp String", function () {
      var t = this._r.exec(this._s);
      return {
        value: t,
        done: null === t
      }
    }), e(e.P, "String", {
      matchAll: function (t) {
        if (i(this), !u(t)) throw TypeError(t + " is not a regexp!");
        var n = String(this),
          r = "flags" in f ? String(t.flags) : c.call(t),
          e = new RegExp(t.source, ~r.indexOf("g") ? r : "g" + r);
        return e.lastIndex = o(t.lastIndex), new a(e, n)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(193),
      o = r(133),
      u = /Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);
    e(e.P + e.F * u, "String", {
      padEnd: function (t) {
        return i(this, t, 1 < arguments.length ? arguments[1] : void 0, !1)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1),
      i = r(193),
      o = r(133),
      u = /Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);
    e(e.P + e.F * u, "String", {
      padStart: function (t) {
        return i(this, t, 1 < arguments.length ? arguments[1] : void 0, !0)
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(84)("trimLeft", function (t) {
      return function () {
        return t(this, 1)
      }
    }, "trimStart")
  }, function (t, n, r) {
    "use strict";
    r(84)("trimRight", function (t) {
      return function () {
        return t(this, 2)
      }
    }, "trimEnd")
  }, function (t, n, r) {
    r(160)("asyncIterator")
  }, function (t, n, r) {
    r(160)("observable")
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "System", {
      global: r(3)
    })
  }, function (t, n, r) {
    r(129)("WeakMap")
  }, function (t, n, r) {
    r(130)("WeakMap")
  }, function (t, n, r) {
    r(129)("WeakSet")
  }, function (t, n, r) {
    r(130)("WeakSet")
  }, function (t, n, r) {
    for (var e = r(162), i = r(74), o = r(27), u = r(3), c = r(26), f = r(82), a = r(7), s = a("iterator"), l = a(
        "toStringTag"), h = f.Array, v = {
        CSSRuleList: !0,
        CSSStyleDeclaration: !1,
        CSSValueList: !1,
        ClientRectList: !1,
        DOMRectList: !1,
        DOMStringList: !1,
        DOMTokenList: !0,
        DataTransferItemList: !1,
        FileList: !1,
        HTMLAllCollection: !1,
        HTMLCollection: !1,
        HTMLFormElement: !1,
        HTMLSelectElement: !1,
        MediaList: !0,
        MimeTypeArray: !1,
        NamedNodeMap: !1,
        NodeList: !0,
        PaintRequestList: !1,
        Plugin: !1,
        PluginArray: !1,
        SVGLengthList: !1,
        SVGNumberList: !1,
        SVGPathSegList: !1,
        SVGPointList: !1,
        SVGStringList: !1,
        SVGTransformList: !1,
        SourceBufferList: !1,
        StyleSheetList: !0,
        TextTrackCueList: !1,
        TextTrackList: !1,
        TouchList: !1
      }, p = i(v), d = 0; d < p.length; d++) {
      var y, g = p[d],
        b = v[g],
        x = u[g],
        m = x && x.prototype;
      if (m && (m[s] || c(m, s, h), m[l] || c(m, l, g), f[g] = h, b))
        for (y in e) m[y] || o(m, y, e[y], !0)
    }
  }, function (t, n, r) {
    var e = r(1),
      i = r(158);
    e(e.G + e.B, {
      setImmediate: i.set,
      clearImmediate: i.clear
    })
  }, function (t, n, r) {
    var e = r(3),
      i = r(1),
      o = r(133),
      u = [].slice,
      c = /MSIE .\./.test(o),
      f = function (i) {
        return function (t, n) {
          var r = 2 < arguments.length,
            e = !!r && u.call(arguments, 2);
          return i(r ? function () {
            ("function" == typeof t ? t : Function(t)).apply(this, e)
          } : t, n)
        }
      };
    i(i.G + i.B + i.F * c, {
      setTimeout: f(e.setTimeout),
      setInterval: f(e.setInterval)
    })
  }, function (t, n, r) {
    r(341), r(280), r(282), r(281), r(284), r(286), r(291), r(285), r(283), r(293), r(292), r(288), r(289), r(287),
      r(279), r(290), r(294), r(295), r(247), r(249), r(248), r(297), r(296), r(267), r(277), r(278), r(268), r(
      269), r(270), r(271), r(272), r(273), r(274), r(275), r(276), r(250), r(251), r(252), r(253), r(254), r(255),
      r(256), r(257), r(258), r(259), r(260), r(261), r(262), r(263), r(264), r(265), r(266), r(328), r(333), r(
      340), r(331), r(323), r(324), r(329), r(334), r(336), r(319), r(320), r(321), r(322), r(325), r(326), r(327),
      r(330), r(332), r(335), r(337), r(338), r(339), r(242), r(244), r(243), r(246), r(245), r(231), r(229), r(
      235), r(232), r(238), r(240), r(228), r(234), r(225), r(239), r(223), r(237), r(236), r(230), r(233), r(222),
      r(224), r(227), r(226), r(241), r(162), r(313), r(197), r(318), r(198), r(314), r(315), r(316), r(317), r(
      298), r(196), r(199), r(200), r(353), r(342), r(343), r(348), r(351), r(352), r(346), r(349), r(347), r(350),
      r(344), r(345), r(299), r(300), r(301), r(302), r(303), r(306), r(304), r(305), r(307), r(308), r(309), r(
      310), r(312), r(311), r(356), r(354), r(355), r(397), r(400), r(399), r(401), r(402), r(398), r(403), r(404),
      r(378), r(381), r(377), r(375), r(376), r(379), r(380), r(362), r(396), r(361), r(395), r(407), r(409), r(
      360), r(394), r(406), r(408), r(359), r(405), r(358), r(363), r(364), r(365), r(366), r(367), r(369), r(368),
      r(370), r(371), r(372), r(374), r(373), r(383), r(384), r(385), r(386), r(388), r(387), r(390), r(389), r(
      391), r(392), r(393), r(357), r(382), r(412), r(411), r(410), t.exports = r(46)
  }, function (t, n) {
    t.exports = function (t, n) {
      if ("string" == typeof n) return t.insertAdjacentHTML("afterend", n);
      var r = t.nextSibling;
      return r ? t.parentNode.insertBefore(n, r) : t.parentNode.appendChild(n)
    }
  }])

</script>
<script src="/./main.a5fda8.js"></script>
<script>
  ! function () {
    var e, t;
    e = "/slider.27463f.js", t = document.createElement("script"), document.getElementsByTagName("body")[
      0].appendChild(t), t.setAttribute("src", e)
  }()

</script>



<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



<!--  -->


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">Toc</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">Friends</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">About me</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">CTF</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">writeup</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">crypto</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">solidity</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">PQC</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">MPKC</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Backdoor</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Dual EC</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">FHE</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">BFV</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">USTC</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Machine Learning</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">TFHE</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">fibonacci</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">教程</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">0S2021</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Zcash</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Cryptocurrency</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Code</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Lattice</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ISD</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Matrix Group</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Discrete Logarithm</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia-plus根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="https://nese.team/" target="_blank" 
                class="search-title" >
                
                  <i class="icon-link icon"></i>
                
                NeSE
              </a>
            </li>
          
            <li class="search-li">
              <a href="https://ustc.life" target="_blank" 
                class="search-title" >
                
                  <i class="icon-link icon"></i>
                
                USTC-Life
              </a>
            </li>
          
            <li class="search-li">
              <a href="https://xuzzz1999.github.io/" target="_blank" 
                class="search-title" >
                
                  <i class="icon-link icon"></i>
                
                Xuzzz
              </a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
        
          
  	  		<div class="aboutme-wrap" id="aboutme"><center><br>Hi, this is tl2cents <br> Currently Ph.D at IIE of UCAS <br> Graduated from USTC (2018-2022) <br><br> CTFer <br>  Focus on blockchain, crypto and reversing<br>Team member of <a target="_blank" rel="noopener" href="https://nese.team/">NeSE</a> and Nebula<br><br>Research<br> Blockchain | ETH | FHE <br> PQC | Cryptography | Android <br><br>Contact Me <br>echo Y2F4dWxhc2FlbGFAb3V0bG9vay5jb20K | base64 -d <br><br>Thanks for JoeyBling and Litten<br/><center></div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>

  
  
<script type="text/javascript" src="/plugins/activate-power-mode/activate-power-mode.js"></script>
<script>
  POWERMODE.colorful = true; // make power mode colorful
  POWERMODE.shake = false; // turn off shake
  document.body.addEventListener('input', POWERMODE);
</script>

  
  <!-- 
  <script async type="text/javascript" size="90" alpha="0.2" zIndex="0" src="/plugins/ribbon.js/ribbon.min.js"></script> -->
  
  
  
</body>

</html>
